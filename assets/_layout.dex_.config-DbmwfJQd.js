import{r as c,j as t}from"./index-gtzDq4NN.js";import{y as p}from"./globalDisconnect-BwfQ2Vw-.js";import{u as B}from"./useAuth-CdmGF86g.js";import{c as F,p as R}from"./apiClient-DEwubw2O.js";import{u as V,D as M,a as l,b as O,c as A,d as Y,e as U,v as W}from"./useThemeHandlers-ATqQ7dHb.js";import{W as _}from"./WalletConnect-R3qWhd59.js";import{C as E}from"./Card-CTDM2G3r.js";import{F as $}from"./ImagePaste-DdHR4gq_.js";import{d as q}from"./ModalContext-mlJE0UaS.js";import{u as G}from"./DistributorContext-B2aeeeXX.js";import{u as z}from"./DexContext-BStH6aHx.js";import{B as H}from"./BackDexDashboard-DrPHIyI3.js";import{a as K}from"./index-DG3TDxXu.js";import{L as J}from"./components-Cb_t2az9.js";import"./clsx-B-dksMZM.js";import"./index-Dvs6MNyz.js";import"./NavigationMenuEditor-CH7me4j8.js";import"./css-BzFf4VQ5.js";import"./iconify-AJT-F7UA.js";import"./FuzzySearchInput-CMoxZWNE.js";import"./usePrivateQuery-C4ovqd4J.js";import"./OrderlyKeyContext-4mPVxEwy.js";import"./dijkstra-C00ieaqj.js";import"./Combination-CTmdEaXQ.js";import"./tslib.es6-MJ473bz6.js";import"./dayjs.min-DsMxAas2.js";import"./browser-BqbI9gSd.js";import"./index-_0cUeJFu.js";const Ee=()=>[{title:"Configure Your DEX - Orderly One"},{name:"description",content:"Customize your DEX configuration. Set up branding, wallets, networks, themes, and advanced features."}];function Ne(){var C,w;const{isAuthenticated:x,token:m,isLoading:N}=B(),u=K(),e=V(),[S,g]=c.useState(!1),[T,h]=c.useState(!1),{isGraduated:D}=z(),{distributorInfo:r}=G(),b=c.useMemo(()=>M.filter(a=>{var s,o;return!(a.key===l.DistributorCode&&D&&!(r!=null&&r.exist)||a.key===l.AnalyticsConfiguration&&!((s=e.dexData)!=null&&s.customDomain||(o=e.dexData)!=null&&o.customDomainOverride))}).map((a,s)=>({...a,id:s+1})),[D,r==null?void 0:r.exist,e.dexData]);c.useEffect(()=>{if(!x||!m)return;async function a(){h(!0);try{if(!await e.updateDexData(m)){u("/dex");return}}catch(s){console.error("Failed to load DEX data",s),u("/dex")}finally{h(!1)}}a()},[x,m,u]),c.useEffect(()=>{var a;!e.currentTheme&&!((a=e.dexData)!=null&&a.themeCSS)&&e.setCurrentTheme(q)},[e]);const{handleGenerateTheme:X,handleResetTheme:y,handleResetToDefault:v}=O({token:m,form:e,originalThemeCSS:(C=e.dexData)==null?void 0:C.themeCSS,tradingViewColorConfig:(w=e.dexData)==null?void 0:w.tradingViewColorConfig}),k=async()=>{const a=e.getSectionProps({handleResetTheme:()=>y(!0),handleResetToDefault:v,ThemeTabButton:j}),s=[];for(const i of b)if(i.key===l.DistributorCode){const d=e.distributorCode.trim();if(d&&!(r!=null&&r.exist)){const n=e.distributorCodeValidator(d)||await W(d);n&&s.push(n)}}else if(i.getValidationTest&&!i.getValidationTest(a)){const n=`${i.title}: validation failed`;if(i.key===l.BrokerDetails){const f=e.brokerNameValidator(e.brokerName.trim());s.push(f||n)}else i.key===l.PrivyConfiguration?s.push(`${i.title}: Please enter a valid Terms of Use URL`):s.push(n)}return e.enabledMenus.split(",").includes("Swap")&&e.swapFeeBps===null&&s.push("Navigation Menus: Swap fee configuration is required when Swap page is enabled"),s},{bindDistributorCode:L}=A(),P=async a=>{a.preventDefault();const s=await k();if(s.length>0){p.error(s[0]);return}if(!(!(r!=null&&r.exist)&&e.distributorCode.trim()&&!await L(e.distributorCode.trim()))){g(!0);try{const{formData:o}=await e.getFormDataWithBase64Images(),i={primaryLogo:e.primaryLogo,secondaryLogo:e.secondaryLogo,favicon:e.favicon,pnlPosters:e.pnlPosters},d=U(o),n=F(d,i);if(e.dexData&&e.dexData.id){const f=await R(`api/dex/${e.dexData.id}`,n,m,{showToastOnError:!1});e.setDexData(f),p.success("DEX configuration updated successfully!"),u("/dex#dex-creation-status")}}catch(o){console.error("Error updating DEX:",o);const i=o instanceof Error?o.message:"Failed to update DEX configuration";p.error(i)}finally{g(!1)}}},j=({label:a})=>t.jsx("button",{className:"px-4 py-2 text-sm font-medium rounded-t-lg bg-transparent text-gray-400",type:"button",disabled:!0,children:a});return N||T?t.jsx("div",{className:"w-full h-[calc(100vh-64px)] flex items-center justify-center px-4 mt-26 pb-52",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"i-svg-spinners:pulse-rings-multiple h-12 w-12 mx-auto text-primary-light mb-4"}),t.jsx("div",{className:"text-base md:text-lg mb-2",children:"Loading DEX Configuration"}),t.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Please wait while we fetch your settings"})]})}):x?e.dexData?t.jsxs("div",{className:"container mx-auto p-4 max-w-7xl mt-26 pb-52",children:[t.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:t.jsxs("div",{children:[t.jsx(H,{}),t.jsx("h1",{className:"text-2xl md:text-3xl font-bold gradient-text",children:"DEX Configuration"})]})}),t.jsx($,{onSubmit:P,className:"space-y-6",submitText:"Update DEX Configuration",isLoading:S,loadingText:"Saving",disabled:!1,enableRateLimit:!0,children:t.jsx(Y,{mode:"direct",sections:b,showProgressTracker:!0,sectionProps:e.getSectionProps({handleResetTheme:y,handleResetToDefault:v,ThemeTabButton:j}),handleGenerateTheme:X,idPrefix:"config-",customDescription:a=>a.key===l.DistributorCode&&r!=null&&r.exist?"You have been invited by the following distributor.":a.description})})]}):t.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Configuration"}),t.jsxs(E,{children:[t.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"No DEX Found"}),t.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"You need to create a DEX first before you can configure it."}),t.jsx("div",{className:"flex justify-center",children:t.jsx(J,{to:"/dex",className:"btn-connect",children:"Create Your DEX"})})]})]})}):t.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Configuration"}),t.jsxs(E,{children:[t.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"Authentication Required"}),t.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"Please connect your wallet and login to access DEX configuration."}),t.jsx("div",{className:"flex justify-center",children:t.jsx(_,{})})]})]})})}export{Ne as default,Ee as meta};
