var Li=Object.defineProperty;var Sr=t=>{throw TypeError(t)};var Di=(t,e,r)=>e in t?Li(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var be=(t,e,r)=>Di(t,typeof e!="symbol"?e+"":e,r),Ct=(t,e,r)=>e.has(t)||Sr("Cannot "+r);var P=(t,e,r)=>(Ct(t,e,"read from private field"),r?r.call(t):e.get(t)),J=(t,e,r)=>e.has(t)?Sr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),G=(t,e,r,n)=>(Ct(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),ie=(t,e,r)=>(Ct(t,e,"access private method"),r);import{r as N,a as Nn,j as xn}from"./index-gtzDq4NN.js";import{b0 as Kt,aU as Mn,b1 as Ni,b2 as xi,b3 as Mi,b4 as Ui,b5 as Fi,b6 as ji,f as Ot,y as wr,b7 as qi}from"./globalDisconnect-DEHmIGkh.js";import{_ as F,i as I,a as U,b as D,g as S,e as T,j as dt,c as Me}from"./tslib.es6-DjQuqsdl.js";import{g as _r}from"./index-BftLqECp.js";import{A as Vi,i as sr,O as Ye,c as $t,o as Hi,t as Bi,a as Gi,p as Wi,f as Z,d as Ki,b as ne,m as ur,e as $i,g as zi,s as Xi,h as Un,j as Ji,E as Yi,k as ft,l as Le,n as Qi}from"./switchMap-CAkRPEGC.js";function Zi(t,e){const{onChange:r}=e;return t.subscribe(()=>Kt(t),r,{equalityFn:Mn})}function eo(t,e){const{initialState:r,reconnectOnMount:n}=e;return r&&!t._internal.store.persist.hasHydrated()&&t.setState({...r,chainId:t.chains.some(i=>i.id===r.chainId)?r.chainId:t.chains[0].id,connections:n?r.connections:new Map,status:n?"reconnecting":"disconnected"}),{async onMount(){t._internal.ssr&&(await t._internal.store.persist.rehydrate(),t._internal.mipd&&t._internal.connectors.setState(i=>{var c;const o=new Set;for(const u of i??[])if(u.rdns){const l=Array.isArray(u.rdns)?u.rdns:[u.rdns];for(const d of l)o.add(d)}const a=[],s=((c=t._internal.mipd)==null?void 0:c.getProviders())??[];for(const u of s){if(o.has(u.info.rdns))continue;const l=t._internal.connectors.providerDetailToConnector(u),d=t._internal.connectors.setup(l);a.push(d)}return[...i,...a]})),n?Ni(t):t.storage&&t.setState(i=>({...i,connections:new Map}))}}}function to(t){const{children:e,config:r,initialState:n,reconnectOnMount:i=!0}=t,{onMount:o}=eo(r,{initialState:n,reconnectOnMount:i});r._internal.ssr||o();const a=N.useRef(!0);return N.useEffect(()=>{if(a.current&&r._internal.ssr)return o(),()=>{a.current=!1}},[]),e}const Fn=N.createContext(void 0);function Hc(t){const{children:e,config:r}=t,n={value:r};return N.createElement(to,t,N.createElement(Fn.Provider,n,e))}const ro="2.14.16",no=()=>`wagmi@${ro}`;class io extends xi{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiError"})}get docsBaseUrl(){return"https://wagmi.sh/react"}get version(){return no()}}class oo extends io{constructor(){super("`useConfig` must be used within `WagmiProvider`.",{docsPath:"/api/WagmiProvider"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiProviderNotFoundError"})}}function gt(t={}){const e=t.config??N.useContext(Fn);if(!e)throw new oo;return e}var Lt={exports:{}},Dt={},Nt={exports:{}},xt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ir;function ao(){if(Ir)return xt;Ir=1;var t=Nn();function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,o=t.useLayoutEffect,a=t.useDebugValue;function s(d,f){var v=f(),h=n({inst:{value:v,getSnapshot:f}}),p=h[0].inst,g=h[1];return o(function(){p.value=v,p.getSnapshot=f,c(p)&&g({inst:p})},[d,v,f]),i(function(){return c(p)&&g({inst:p}),d(function(){c(p)&&g({inst:p})})},[d]),a(v),v}function c(d){var f=d.getSnapshot;d=d.value;try{var v=f();return!r(d,v)}catch{return!0}}function u(d,f){return f()}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:s;return xt.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:l,xt}var Ar;function so(){return Ar||(Ar=1,Nt.exports=ao()),Nt.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kr;function uo(){if(kr)return Dt;kr=1;var t=Nn(),e=so();function r(u,l){return u===l&&(u!==0||1/u===1/l)||u!==u&&l!==l}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,o=t.useRef,a=t.useEffect,s=t.useMemo,c=t.useDebugValue;return Dt.useSyncExternalStoreWithSelector=function(u,l,d,f,v){var h=o(null);if(h.current===null){var p={hasValue:!1,value:null};h.current=p}else p=h.current;h=s(function(){function m(_){if(!y){if(y=!0,b=_,_=f(_),v!==void 0&&p.hasValue){var C=p.value;if(v(C,_))return w=C}return w=_}if(C=w,n(b,_))return C;var k=f(_);return v!==void 0&&v(C,k)?(b=_,C):(b=_,w=k)}var y=!1,b,w,E=d===void 0?null:d;return[function(){return m(l())},E===null?void 0:function(){return m(E())}]},[l,d,f,v]);var g=i(u,h[0],h[1]);return a(function(){p.hasValue=!0,p.value=g},[g]),c(g),g},Dt}var Pr;function co(){return Pr||(Pr=1,Lt.exports=uo()),Lt.exports}var lo=co();const Mt=t=>typeof t=="object"&&!Array.isArray(t);function fo(t,e,r=e,n=Mn){const i=N.useRef([]),o=lo.useSyncExternalStoreWithSelector(t,e,r,a=>a,(a,s)=>{if(Mt(a)&&Mt(s)&&i.current.length){for(const c of i.current)if(!n(a[c],s[c]))return!1;return!0}return n(a,s)});return N.useMemo(()=>{if(Mt(o)){const a={...o};let s={};for(const[c,u]of Object.entries(a))s={...s,[c]:{configurable:!1,enumerable:!0,get:()=>(i.current.includes(c)||i.current.push(c),u)}};return Object.defineProperties(a,s),a}return o},[o])}function vo(t={}){const e=gt(t);return fo(r=>Ui(e,{onChange:r}),()=>Mi(e))}var cr=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mt=typeof window>"u"||"Deno"in globalThis;function Bc(){}function Gc(t,e){return typeof t=="function"?t(e):t}function ho(t){return typeof t=="number"&&t>=0&&t!==1/0}function Wc(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Kc(t,e){return typeof t=="function"?t(e):t}function $c(t,e){return typeof t=="function"?t(e):t}function zc(t,e){const{type:r="all",exact:n,fetchStatus:i,predicate:o,queryKey:a,stale:s}=t;if(a){if(n){if(e.queryHash!==po(a,e.options))return!1}else if(!lr(e.queryKey,a))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof s=="boolean"&&e.isStale()!==s||i&&i!==e.state.fetchStatus||o&&!o(e))}function Xc(t,e){const{exact:r,status:n,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(r){if(ze(e.options.mutationKey)!==ze(o))return!1}else if(!lr(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function po(t,e){return((e==null?void 0:e.queryKeyHashFn)||ze)(t)}function ze(t){return JSON.stringify(t,(e,r)=>zt(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function lr(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!lr(t[r],e[r])):!1}function jn(t,e){if(t===e)return t;const r=Rr(t)&&Rr(e);if(r||zt(t)&&zt(e)){const n=r?t:Object.keys(t),i=n.length,o=r?e:Object.keys(e),a=o.length,s=r?[]:{};let c=0;for(let u=0;u<a;u++){const l=r?u:o[u];(!r&&n.includes(l)||r)&&t[l]===void 0&&e[l]===void 0?(s[l]=void 0,c++):(s[l]=jn(t[l],e[l]),s[l]===t[l]&&t[l]!==void 0&&c++)}return i===a&&c===i?t:s}return e}function go(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function Rr(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function zt(t){if(!Cr(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!Cr(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Cr(t){return Object.prototype.toString.call(t)==="[object Object]"}function mo(t){return new Promise(e=>{setTimeout(e,t)})}function Jc(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?jn(t,e):e}function Yc(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function Qc(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var yo=Symbol();function Zc(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===yo?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var De,we,qe,Rn,bo=(Rn=class extends cr{constructor(){super();J(this,De);J(this,we);J(this,qe);G(this,qe,e=>{if(!mt&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){P(this,we)||this.setEventListener(P(this,qe))}onUnsubscribe(){var e;this.hasListeners()||((e=P(this,we))==null||e.call(this),G(this,we,void 0))}setEventListener(e){var r;G(this,qe,e),(r=P(this,we))==null||r.call(this),G(this,we,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){P(this,De)!==e&&(G(this,De,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof P(this,De)=="boolean"?P(this,De):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},De=new WeakMap,we=new WeakMap,qe=new WeakMap,Rn),Eo=new bo,Ve,_e,He,Cn,To=(Cn=class extends cr{constructor(){super();J(this,Ve,!0);J(this,_e);J(this,He);G(this,He,e=>{if(!mt&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){P(this,_e)||this.setEventListener(P(this,He))}onUnsubscribe(){var e;this.hasListeners()||((e=P(this,_e))==null||e.call(this),G(this,_e,void 0))}setEventListener(e){var r;G(this,He,e),(r=P(this,_e))==null||r.call(this),G(this,_e,e(this.setOnline.bind(this)))}setOnline(e){P(this,Ve)!==e&&(G(this,Ve,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return P(this,Ve)}},Ve=new WeakMap,_e=new WeakMap,He=new WeakMap,Cn),qn=new To;function So(){let t,e;const r=new Promise((i,o)=>{t=i,e=o});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),t(i)},r.reject=i=>{n({status:"rejected",reason:i}),e(i)},r}function wo(t){return Math.min(1e3*2**t,3e4)}function _o(t){return(t??"online")==="online"?qn.isOnline():!0}var Vn=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function el(t){return t instanceof Vn}function Io(t){let e=!1,r=0,n=!1,i;const o=So(),a=p=>{var g;n||(f(new Vn(p)),(g=t.abort)==null||g.call(t))},s=()=>{e=!0},c=()=>{e=!1},u=()=>Eo.isFocused()&&(t.networkMode==="always"||qn.isOnline())&&t.canRun(),l=()=>_o(t.networkMode)&&t.canRun(),d=p=>{var g;n||(n=!0,(g=t.onSuccess)==null||g.call(t,p),i==null||i(),o.resolve(p))},f=p=>{var g;n||(n=!0,(g=t.onError)==null||g.call(t,p),i==null||i(),o.reject(p))},v=()=>new Promise(p=>{var g;i=m=>{(n||u())&&p(m)},(g=t.onPause)==null||g.call(t)}).then(()=>{var p;i=void 0,n||(p=t.onContinue)==null||p.call(t)}),h=()=>{if(n)return;let p;const g=r===0?t.initialPromise:void 0;try{p=g??t.fn()}catch(m){p=Promise.reject(m)}Promise.resolve(p).then(d).catch(m=>{var _;if(n)return;const y=t.retry??(mt?0:3),b=t.retryDelay??wo,w=typeof b=="function"?b(r,m):b,E=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,m);if(e||!E){f(m);return}r++,(_=t.onFail)==null||_.call(t,r,m),mo(w).then(()=>u()?void 0:v()).then(()=>{e?f(m):h()})})};return{promise:o,cancel:a,continue:()=>(i==null||i(),o),cancelRetry:s,continueRetry:c,canStart:l,start:()=>(l()?h():v().then(h),o)}}var Ao=t=>setTimeout(t,0);function ko(){let t=[],e=0,r=s=>{s()},n=s=>{s()},i=Ao;const o=s=>{e?t.push(s):i(()=>{r(s)})},a=()=>{const s=t;t=[],s.length&&i(()=>{n(()=>{s.forEach(c=>{r(c)})})})};return{batch:s=>{let c;e++;try{c=s()}finally{e--,e||a()}return c},batchCalls:s=>(...c)=>{o(()=>{s(...c)})},schedule:o,setNotifyFunction:s=>{r=s},setBatchNotifyFunction:s=>{n=s},setScheduler:s=>{i=s}}}var dr=ko(),Ne,On,Po=(On=class{constructor(){J(this,Ne)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ho(this.gcTime)&&G(this,Ne,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(mt?1/0:5*60*1e3))}clearGcTimeout(){P(this,Ne)&&(clearTimeout(P(this,Ne)),G(this,Ne,void 0))}},Ne=new WeakMap,On),ve,ee,xe,he,Se,Ln,tl=(Ln=class extends Po{constructor(e){super();J(this,he);J(this,ve);J(this,ee);J(this,xe);this.mutationId=e.mutationId,G(this,ee,e.mutationCache),G(this,ve,[]),this.state=e.state||Hn(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){P(this,ve).includes(e)||(P(this,ve).push(e),this.clearGcTimeout(),P(this,ee).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){G(this,ve,P(this,ve).filter(r=>r!==e)),this.scheduleGc(),P(this,ee).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){P(this,ve).length||(this.state.status==="pending"?this.scheduleGc():P(this,ee).remove(this))}continue(){var e;return((e=P(this,xe))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,a,s,c,u,l,d,f,v,h,p,g,m,y,b,w,E,_,C;G(this,xe,Io({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(k,L)=>{ie(this,he,Se).call(this,{type:"failed",failureCount:k,error:L})},onPause:()=>{ie(this,he,Se).call(this,{type:"pause"})},onContinue:()=>{ie(this,he,Se).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>P(this,ee).canRun(this)}));const r=this.state.status==="pending",n=!P(this,xe).canStart();try{if(!r){ie(this,he,Se).call(this,{type:"pending",variables:e,isPaused:n}),await((o=(i=P(this,ee).config).onMutate)==null?void 0:o.call(i,e,this));const L=await((s=(a=this.options).onMutate)==null?void 0:s.call(a,e));L!==this.state.context&&ie(this,he,Se).call(this,{type:"pending",context:L,variables:e,isPaused:n})}const k=await P(this,xe).start();return await((u=(c=P(this,ee).config).onSuccess)==null?void 0:u.call(c,k,e,this.state.context,this)),await((d=(l=this.options).onSuccess)==null?void 0:d.call(l,k,e,this.state.context)),await((v=(f=P(this,ee).config).onSettled)==null?void 0:v.call(f,k,null,this.state.variables,this.state.context,this)),await((p=(h=this.options).onSettled)==null?void 0:p.call(h,k,null,e,this.state.context)),ie(this,he,Se).call(this,{type:"success",data:k}),k}catch(k){try{throw await((m=(g=P(this,ee).config).onError)==null?void 0:m.call(g,k,e,this.state.context,this)),await((b=(y=this.options).onError)==null?void 0:b.call(y,k,e,this.state.context)),await((E=(w=P(this,ee).config).onSettled)==null?void 0:E.call(w,void 0,k,this.state.variables,this.state.context,this)),await((C=(_=this.options).onSettled)==null?void 0:C.call(_,void 0,k,e,this.state.context)),k}finally{ie(this,he,Se).call(this,{type:"error",error:k})}}finally{P(this,ee).runNext(this)}}},ve=new WeakMap,ee=new WeakMap,xe=new WeakMap,he=new WeakSet,Se=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),dr.batch(()=>{P(this,ve).forEach(n=>{n.onMutationUpdate(e)}),P(this,ee).notify({mutation:this,type:"updated",action:e})})},Ln);function Hn(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ie,Ae,te,Ee,Te,st,Xt,Dn,Ro=(Dn=class extends cr{constructor(r,n){super();J(this,Te);J(this,Ie);J(this,Ae);J(this,te);J(this,Ee);G(this,Ie,r),this.setOptions(n),this.bindMethods(),ie(this,Te,st).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=P(this,Ie).defaultMutationOptions(r),go(this.options,n)||P(this,Ie).getMutationCache().notify({type:"observerOptionsUpdated",mutation:P(this,te),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ze(n.mutationKey)!==ze(this.options.mutationKey)?this.reset():((i=P(this,te))==null?void 0:i.state.status)==="pending"&&P(this,te).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=P(this,te))==null||r.removeObserver(this)}onMutationUpdate(r){ie(this,Te,st).call(this),ie(this,Te,Xt).call(this,r)}getCurrentResult(){return P(this,Ae)}reset(){var r;(r=P(this,te))==null||r.removeObserver(this),G(this,te,void 0),ie(this,Te,st).call(this),ie(this,Te,Xt).call(this)}mutate(r,n){var i;return G(this,Ee,n),(i=P(this,te))==null||i.removeObserver(this),G(this,te,P(this,Ie).getMutationCache().build(P(this,Ie),this.options)),P(this,te).addObserver(this),P(this,te).execute(r)}},Ie=new WeakMap,Ae=new WeakMap,te=new WeakMap,Ee=new WeakMap,Te=new WeakSet,st=function(){var n;const r=((n=P(this,te))==null?void 0:n.state)??Hn();G(this,Ae,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Xt=function(r){dr.batch(()=>{var n,i,o,a,s,c,u,l;if(P(this,Ee)&&this.hasListeners()){const d=P(this,Ae).variables,f=P(this,Ae).context;(r==null?void 0:r.type)==="success"?((i=(n=P(this,Ee)).onSuccess)==null||i.call(n,r.data,d,f),(a=(o=P(this,Ee)).onSettled)==null||a.call(o,r.data,null,d,f)):(r==null?void 0:r.type)==="error"&&((c=(s=P(this,Ee)).onError)==null||c.call(s,r.error,d,f),(l=(u=P(this,Ee)).onSettled)==null||l.call(u,void 0,r.error,d,f))}this.listeners.forEach(d=>{d(P(this,Ae))})})},Dn);function Co(t){return{mutationFn(e){return Fi(t,e)},mutationKey:["disconnect"]}}function Oo(t){return{mutationFn(e){return ji(t,e)},mutationKey:["signMessage"]}}var Bn=N.createContext(void 0),Lo=t=>{const e=N.useContext(Bn);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},nl=({client:t,children:e})=>(N.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),xn.jsx(Bn.Provider,{value:t,children:e}));function Do(t,e){return typeof t=="function"?t(...e):!!t}function No(){}function Gn(t,e){const r=Lo(),[n]=N.useState(()=>new Ro(r,t));N.useEffect(()=>{n.setOptions(t)},[n,t]);const i=N.useSyncExternalStore(N.useCallback(a=>n.subscribe(dr.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),o=N.useCallback((a,s)=>{n.mutate(a,s).catch(No)},[n]);if(i.error&&Do(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}function xo(t={}){const e=gt(t);return N.useSyncExternalStore(r=>Zi(e,{onChange:r}),()=>Kt(e),()=>Kt(e))}function Mo(t={}){const{mutation:e}=t,r=gt(t),n=Co(r),{mutate:i,mutateAsync:o,...a}=Gn({...e,...n});return{...a,connectors:xo({config:r}).map(s=>s.connector),disconnect:i,disconnectAsync:o}}function Uo(t={}){const{mutation:e}=t,r=gt(t),n=Oo(r),{mutate:i,mutateAsync:o,...a}=Gn({...e,...n});return{...a,signMessage:i,signMessageAsync:o}}var ke;(function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.ADD="$add",t.APPEND="$append",t.PREPEND="$prepend",t.REMOVE="$remove",t.PREINSERT="$preInsert",t.POSTINSERT="$postInsert",t.UNSET="$unset",t.CLEAR_ALL="$clearAll"})(ke||(ke={}));var Re;(function(t){t.IDENTIFY="$identify",t.GROUP_IDENTIFY="$groupidentify",t.REVENUE="revenue_amount"})(Re||(Re={}));var Or="-",yt="AMP",Fo="".concat(yt,"_unsent"),Wn="$default_instance",Kn="https://api2.amplitude.com/2/httpapi",jo="https://api.eu.amplitude.com/2/httpapi",qo="https://api2.amplitude.com/batch",Vo="https://api.eu.amplitude.com/batch",Ho="utm_campaign",Bo="utm_content",Go="utm_id",Wo="utm_medium",Ko="utm_source",$o="utm_term",Lr="dclid",Dr="fbclid",Nr="gbraid",xr="gclid",Mr="ko_click_id",Ur="li_fat_id",Fr="msclkid",jr="rdt_cid",qr="ttclid",Vr="twclid",Hr="wbraid",bt={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rdt_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},vt=["access-control-allow-origin","access-control-allow-credentials","access-control-expose-headers","access-control-max-age","access-control-allow-methods","access-control-allow-headers","accept-patch","accept-ranges","age","allow","alt-svc","cache-control","connection","content-disposition","content-encoding","content-language","content-length","content-location","content-md5","content-range","content-type","date","delta-base","etag","expires","im","last-modified","link","location","permanent","p3p","pragma","proxy-authenticate","public-key-pins","retry-after","server","status","strict-transport-security","trailer","transfer-encoding","tk","upgrade","vary","via","warning","www-authenticate","x-b3-traceid","x-frame-options"],zo=["authorization","cookie","set-cookie"],Xo=1e3,Jt=function(t){if(Object.keys(t).length>Xo)return!1;for(var e in t){var r=t[e];if(!$n(e,r))return!1}return!0},$n=function(t,e){var r,n;if(typeof t!="string")return!1;if(Array.isArray(e)){var i=!0;try{for(var o=F(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(Array.isArray(s))return!1;if(typeof s=="object")i=i&&Jt(s);else if(!["number","string"].includes(typeof s))return!1;if(!i)return!1}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}else{if(e==null)return!1;if(typeof e=="object")return Jt(e);if(!["number","string","boolean"].includes(typeof e))return!1}return!0},Xe=function(){function t(){this._propertySet=new Set,this._properties={}}return t.prototype.getUserProperties=function(){return I({},this._properties)},t.prototype.set=function(e,r){return this._safeSet(q.SET,e,r),this},t.prototype.setOnce=function(e,r){return this._safeSet(q.SET_ONCE,e,r),this},t.prototype.append=function(e,r){return this._safeSet(q.APPEND,e,r),this},t.prototype.prepend=function(e,r){return this._safeSet(q.PREPEND,e,r),this},t.prototype.postInsert=function(e,r){return this._safeSet(q.POSTINSERT,e,r),this},t.prototype.preInsert=function(e,r){return this._safeSet(q.PREINSERT,e,r),this},t.prototype.remove=function(e,r){return this._safeSet(q.REMOVE,e,r),this},t.prototype.add=function(e,r){return this._safeSet(q.ADD,e,r),this},t.prototype.unset=function(e){return this._safeSet(q.UNSET,e,Or),this},t.prototype.clearAll=function(){return this._properties={},this._properties[q.CLEAR_ALL]=Or,this},t.prototype._safeSet=function(e,r,n){if(this._validate(e,r,n)){var i=this._properties[e];return i===void 0&&(i={},this._properties[e]=i),i[r]=n,this._propertySet.add(r),!0}return!1},t.prototype._validate=function(e,r,n){return this._properties[q.CLEAR_ALL]!==void 0||this._propertySet.has(r)?!1:e===q.ADD?typeof n=="number":e!==q.UNSET&&e!==q.REMOVE?$n(r,n):!0},t}(),q;(function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.ADD="$add",t.APPEND="$append",t.PREPEND="$prepend",t.REMOVE="$remove",t.PREINSERT="$preInsert",t.POSTINSERT="$postInsert",t.UNSET="$unset",t.CLEAR_ALL="$clearAll"})(q||(q={}));var Jo=[q.CLEAR_ALL,q.UNSET,q.SET,q.SET_ONCE,q.ADD,q.APPEND,q.PREPEND,q.PREINSERT,q.POSTINSERT,q.REMOVE],Yo="Event tracked successfully",Qo="Unexpected error occurred",Zo="Event rejected due to exceeded retry count",ea="Event skipped due to optOut config",ta="Event rejected due to missing API key",ra="Invalid API key",na="Client not initialized",K;(function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.PayloadTooLarge="payload_too_large",t.Invalid="invalid",t.Failed="failed",t.Timeout="Timeout",t.SystemError="SystemError"})(K||(K={}));var je=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=K.Unknown),{event:t,code:e,message:r}},$=function(){var t="ampIntegrationContext";if(typeof globalThis<"u"&&typeof globalThis[t]<"u")return globalThis[t];if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof _r<"u")return _r},ia=function(t){return t?(t^Math.random()*16>>t/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,Ce)},Br=U([],D(Array(256).keys()),!1).map(function(t){return t.toString(16).padStart(2,"0")}),Ce=function(t){var e,r=$();if(!(!((e=r==null?void 0:r.crypto)===null||e===void 0)&&e.getRandomValues))return ia(t);var n=r.crypto.getRandomValues(new Uint8Array(16));return n[6]=n[6]&15|64,n[8]=n[8]&63|128,U([],D(n.entries()),!1).map(function(i){var o=D(i,2),a=o[0],s=o[1];return[4,6,8,10].includes(a)?"-".concat(Br[s]):Br[s]}).join("")},oa=function(){function t(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return t.prototype.register=function(e,r){var n,i;return S(this,void 0,void 0,function(){return T(this,function(o){switch(o.label){case 0:return this.plugins.some(function(a){return a.name===e.name})?(this.loggerProvider.warn("Plugin with name ".concat(e.name," already exists, skipping registration")),[2]):(e.name===void 0&&(e.name=Ce(),this.loggerProvider.warn(`Plugin name is undefined. 
      Generating a random UUID for plugin name: `.concat(e.name,`. 
      Set a name for the plugin to prevent it from being added multiple times.`))),e.type=(n=e.type)!==null&&n!==void 0?n:"enrichment",[4,(i=e.setup)===null||i===void 0?void 0:i.call(e,r,this.client)]);case 1:return o.sent(),this.plugins.push(e),[2]}})})},t.prototype.deregister=function(e,r){var n;return S(this,void 0,void 0,function(){var i,o;return T(this,function(a){switch(a.label){case 0:return i=this.plugins.findIndex(function(s){return s.name===e}),i===-1?(r.loggerProvider.warn("Plugin with name ".concat(e," does not exist, skipping deregistration")),[2]):(o=this.plugins[i],this.plugins.splice(i,1),[4,(n=o.teardown)===null||n===void 0?void 0:n.call(o)]);case 1:return a.sent(),[2]}})})},t.prototype.reset=function(e){this.applying=!1;var r=this.plugins;r.map(function(n){var i;return(i=n.teardown)===null||i===void 0?void 0:i.call(n)}),this.plugins=[],this.client=e},t.prototype.push=function(e){var r=this;return new Promise(function(n){r.queue.push([e,n]),r.scheduleApply(0)})},t.prototype.scheduleApply=function(e){var r=this;this.applying||(this.applying=!0,setTimeout(function(){r.apply(r.queue.shift()).then(function(){r.applying=!1,r.queue.length>0&&r.scheduleApply(0)})},e))},t.prototype.apply=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a,s,c,v,h,u,l,d,f,v,h,p,g,m,y,b,w,E;return T(this,function(_){switch(_.label){case 0:if(!e)return[2];r=D(e,1),n=r[0],i=D(e,2),o=i[1],this.loggerProvider.log("Timeline.apply: Initial event",n),a=this.plugins.filter(function(C){return C.type==="before"}),_.label=1;case 1:_.trys.push([1,6,7,8]),s=F(a),c=s.next(),_.label=2;case 2:return c.done?[3,5]:(v=c.value,v.execute?[4,v.execute(I({},n))]:[3,4]);case 3:if(h=_.sent(),h===null)return this.loggerProvider.log("Timeline.apply: Event filtered out by before plugin '".concat(String(v.name),"', event: ").concat(JSON.stringify(n))),o({event:n,code:0,message:""}),[2];n=h,this.loggerProvider.log("Timeline.apply: Event after before plugin '".concat(String(v.name),"', event: ").concat(JSON.stringify(n))),_.label=4;case 4:return c=s.next(),[3,2];case 5:return[3,8];case 6:return u=_.sent(),y={error:u},[3,8];case 7:try{c&&!c.done&&(b=s.return)&&b.call(s)}finally{if(y)throw y.error}return[7];case 8:l=this.plugins.filter(function(C){return C.type==="enrichment"||C.type===void 0}),_.label=9;case 9:_.trys.push([9,14,15,16]),d=F(l),f=d.next(),_.label=10;case 10:return f.done?[3,13]:(v=f.value,v.execute?[4,v.execute(I({},n))]:[3,12]);case 11:if(h=_.sent(),h===null)return this.loggerProvider.log("Timeline.apply: Event filtered out by enrichment plugin '".concat(String(v.name),"', event: ").concat(JSON.stringify(n))),o({event:n,code:0,message:""}),[2];n=h,this.loggerProvider.log("Timeline.apply: Event after enrichment plugin '".concat(String(v.name),"', event: ").concat(JSON.stringify(n))),_.label=12;case 12:return f=d.next(),[3,10];case 13:return[3,16];case 14:return p=_.sent(),w={error:p},[3,16];case 15:try{f&&!f.done&&(E=d.return)&&E.call(d)}finally{if(w)throw w.error}return[7];case 16:return g=this.plugins.filter(function(C){return C.type==="destination"}),this.loggerProvider.log("Timeline.apply: Final event before destinations, event: ".concat(JSON.stringify(n))),m=g.map(function(C){var k=I({},n);return C.execute(k).catch(function(L){return je(k,0,String(L))})}),Promise.all(m).then(function(C){var k=D(C,1),L=k[0],A=L||je(n,100,"Event not tracked, no destination plugins on the instance");o(A)}),[2]}})})},t.prototype.flush=function(){return S(this,void 0,void 0,function(){var e,r,n,i=this;return T(this,function(o){switch(o.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(a){return i.apply(a)}))];case 1:return o.sent(),r=this.plugins.filter(function(a){return a.type==="destination"}),n=r.map(function(a){return a.flush&&a.flush()}),[4,Promise.all(n)];case 2:return o.sent(),[2]}})})},t.prototype.onIdentityChanged=function(e){this.plugins.forEach(function(r){var n;(n=r.onIdentityChanged)===null||n===void 0||n.call(r,e)})},t.prototype.onSessionIdChanged=function(e){this.plugins.forEach(function(r){var n;(n=r.onSessionIdChanged)===null||n===void 0||n.call(r,e)})},t.prototype.onOptOutChanged=function(e){this.plugins.forEach(function(r){var n;(n=r.onOptOutChanged)===null||n===void 0||n.call(r,e)})},t}(),aa=function(t,e,r){var n=typeof t=="string"?{event_type:t}:t;return I(I(I({},n),r),e&&{event_properties:e})},zn=function(t,e){var r=I(I({},e),{event_type:Re.IDENTIFY,user_properties:t.getUserProperties()});return r},sa=function(t,e,r,n){var i,o=I(I({},n),{event_type:Re.GROUP_IDENTIFY,group_properties:r.getUserProperties(),groups:(i={},i[t]=e,i)});return o},ua=function(t,e,r){var n,i=new Xe;i.set(t,e);var o=I(I({},r),{event_type:Re.IDENTIFY,user_properties:i.getUserProperties(),groups:(n={},n[t]=e,n)});return o},ca=function(t,e){return I(I({},e),{event_type:Re.REVENUE,event_properties:t.getEventProperties()})},re=function(t){return{promise:t||Promise.resolve()}},la=function(){function t(e){e===void 0&&(e="$default"),this.initializing=!1,this.isReady=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new oa(this),this.name=e}return t.prototype._init=function(e){return S(this,void 0,void 0,function(){return T(this,function(r){switch(r.label){case 0:return this.config=e,this.timeline.reset(this),this.timeline.loggerProvider=this.config.loggerProvider,[4,this.runQueuedFunctions("q")];case 1:return r.sent(),this.isReady=!0,[2]}})})},t.prototype.runQueuedFunctions=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a,s,c,u;return T(this,function(l){switch(l.label){case 0:r=this[e],this[e]=[],l.label=1;case 1:l.trys.push([1,8,9,10]),n=F(r),i=n.next(),l.label=2;case 2:return i.done?[3,7]:(o=i.value,a=o(),a&&"promise"in a?[4,a.promise]:[3,4]);case 3:return l.sent(),[3,6];case 4:return[4,a];case 5:l.sent(),l.label=6;case 6:return i=n.next(),[3,2];case 7:return[3,10];case 8:return s=l.sent(),c={error:s},[3,10];case 9:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 10:return this[e].length?[4,this.runQueuedFunctions(e)]:[3,12];case 11:l.sent(),l.label=12;case 12:return[2]}})})},t.prototype.track=function(e,r,n){var i=aa(e,r,n);return re(this.dispatch(i))},t.prototype.identify=function(e,r){var n=zn(e,r);return re(this.dispatch(n))},t.prototype.groupIdentify=function(e,r,n,i){var o=sa(e,r,n,i);return re(this.dispatch(o))},t.prototype.setGroup=function(e,r,n){var i=ua(e,r,n);return re(this.dispatch(i))},t.prototype.revenue=function(e,r){var n=ca(e,r);return re(this.dispatch(n))},t.prototype.add=function(e){return this.isReady?this._addPlugin(e):(this.q.push(this._addPlugin.bind(this,e)),re())},t.prototype._addPlugin=function(e){return re(this.timeline.register(e,this.config))},t.prototype.remove=function(e){return this.isReady?this._removePlugin(e):(this.q.push(this._removePlugin.bind(this,e)),re())},t.prototype._removePlugin=function(e){return re(this.timeline.deregister(e,this.config))},t.prototype.dispatchWithCallback=function(e,r){if(!this.isReady)return r(je(e,0,na));this.process(e).then(r)},t.prototype.dispatch=function(e){return S(this,void 0,void 0,function(){var r=this;return T(this,function(n){return this.isReady?[2,this.process(e)]:[2,new Promise(function(i){r.dispatchQ.push(r.dispatchWithCallback.bind(r,e,i))})]})})},t.prototype.getOperationAppliedUserProperties=function(e){var r={};if(e===void 0)return r;var n={};return Object.keys(e).forEach(function(i){Object.values(ke).includes(i)||(n[i]=e[i])}),Jo.forEach(function(i){if(Object.keys(e).includes(i)){var o=e[i];switch(i){case ke.CLEAR_ALL:Object.keys(r).forEach(function(a){delete r[a]});break;case ke.UNSET:Object.keys(o).forEach(function(a){delete r[a]});break;case ke.SET:Object.assign(r,o);break}}}),Object.assign(r,n),r},t.prototype.process=function(e){return S(this,void 0,void 0,function(){var r,o,n,i,o;return T(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.config.optOut?[2,je(e,0,ea)]:(e.event_type===Re.IDENTIFY&&(r=this.getOperationAppliedUserProperties(e.user_properties),this.timeline.onIdentityChanged({userProperties:r})),[4,this.timeline.push(e)]);case 1:return o=a.sent(),o.code===200?this.config.loggerProvider.log(o.message):o.code===100?this.config.loggerProvider.warn(o.message):this.config.loggerProvider.error(o.message),[2,o];case 2:return n=a.sent(),i=String(n),this.config.loggerProvider.error(i),o=je(e,0,i),[2,o];case 3:return[2]}})})},t.prototype.setOptOut=function(e){if(!this.isReady){this.q.push(this._setOptOut.bind(this,!!e));return}this._setOptOut(e)},t.prototype._setOptOut=function(e){this.config.optOut!==e&&(this.timeline.onOptOutChanged(e),this.config.optOut=!!e)},t.prototype.flush=function(){return re(this.timeline.flush())},t.prototype.plugin=function(e){var r=this.timeline.plugins.find(function(n){return n.name===e});if(r===void 0){this.config.loggerProvider.debug("Cannot find plugin with name ".concat(e));return}return r},t.prototype.plugins=function(e){return this.timeline.plugins.filter(function(r){return r instanceof e})},t}(),da=function(){function t(){this.productId="",this.quantity=1,this.price=0}return t.prototype.setProductId=function(e){return this.productId=e,this},t.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},t.prototype.setPrice=function(e){return this.price=e,this},t.prototype.setRevenueType=function(e){return this.revenueType=e,this},t.prototype.setCurrency=function(e){return this.currency=e,this},t.prototype.setRevenue=function(e){return this.revenue=e,this},t.prototype.setReceipt=function(e){return this.receipt=e,this},t.prototype.setReceiptSig=function(e){return this.receiptSig=e,this},t.prototype.setEventProperties=function(e){return Jt(e)&&(this.properties=e),this},t.prototype.getEventProperties=function(){var e=this.properties?I({},this.properties):{};return e[fe.REVENUE_PRODUCT_ID]=this.productId,e[fe.REVENUE_QUANTITY]=this.quantity,e[fe.REVENUE_PRICE]=this.price,e[fe.REVENUE_TYPE]=this.revenueType,e[fe.REVENUE_CURRENCY]=this.currency,e[fe.REVENUE]=this.revenue,e[fe.RECEIPT]=this.receipt,e[fe.RECEIPT_SIG]=this.receiptSig,e},t}(),fe;(function(t){t.REVENUE_PRODUCT_ID="$productId",t.REVENUE_QUANTITY="$quantity",t.REVENUE_PRICE="$price",t.REVENUE_TYPE="$revenueType",t.REVENUE_CURRENCY="$currency",t.REVENUE="$revenue",t.RECEIPT="$receipt",t.RECEIPT_SIG="$receiptSig"})(fe||(fe={}));var fa=function(t,e){var r=Math.max(e,1);return t.reduce(function(n,i,o){var a=Math.floor(o/r);return n[a]||(n[a]=[]),n[a].push(i),n},[])},oe;(function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Verbose=3]="Verbose",t[t.Debug=4]="Debug"})(oe||(oe={}));var rt="Amplitude Logger ",Xn=function(){function t(){this.logLevel=oe.None}return t.prototype.disable=function(){this.logLevel=oe.None},t.prototype.enable=function(e){e===void 0&&(e=oe.Warn),this.logLevel=e},t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<oe.Verbose||console.log("".concat(rt,"[Log]: ").concat(e.join(" ")))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<oe.Warn||console.warn("".concat(rt,"[Warn]: ").concat(e.join(" ")))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<oe.Error||console.error("".concat(rt,"[Error]: ").concat(e.join(" ")))},t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<oe.Debug||console.log("".concat(rt,"[Debug]: ").concat(e.join(" ")))},t}(),ut=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:Wn,logLevel:oe.Warn,loggerProvider:new Xn,offline:!1,optOut:!1,serverUrl:Kn,serverZone:"US",useBatch:!1}},va=function(){function t(e){var r,n,i,o;this._optOut=!1;var a=ut();this.apiKey=e.apiKey,this.flushIntervalMillis=(r=e.flushIntervalMillis)!==null&&r!==void 0?r:a.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||a.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||a.flushQueueSize,this.instanceName=e.instanceName||a.instanceName,this.loggerProvider=e.loggerProvider||a.loggerProvider,this.logLevel=(n=e.logLevel)!==null&&n!==void 0?n:a.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=e.offline!==void 0?e.offline:a.offline,this.optOut=(i=e.optOut)!==null&&i!==void 0?i:a.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||a.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=(o=e.useBatch)!==null&&o!==void 0?o:a.useBatch,this.loggerProvider.enable(this.logLevel);var s=Jn(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=s.serverZone,this.serverUrl=s.serverUrl}return Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),t}(),ha=function(t,e){return t==="EU"?e?Vo:jo:e?qo:Kn},Jn=function(t,e,r){if(t===void 0&&(t=""),e===void 0&&(e=ut().serverZone),r===void 0&&(r=ut().useBatch),t)return{serverUrl:t,serverZone:void 0};var n=["US","EU"].includes(e)?e:ut().serverZone;return{serverZone:n,serverUrl:ha(n,r)}},pa=function(){function t(){this.sdk={metrics:{histogram:{}}}}return t.prototype.recordHistogram=function(e,r){this.sdk.metrics.histogram[e]=r},t}();function ga(t){return t instanceof Error?t.message:String(t)}function nt(t){var e="";try{"body"in t&&(e=JSON.stringify(t.body,null,2))}catch{}return e}var ma=function(){function t(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduleId=null,this.scheduledTimeout=0,this.flushId=null,this.queue=[]}return t.prototype.setup=function(e){var r;return S(this,void 0,void 0,function(){var n,i=this;return T(this,function(o){switch(o.label){case 0:return this.config=e,this.storageKey="".concat(Fo,"_").concat(this.config.apiKey.substring(0,10)),[4,(r=this.config.storageProvider)===null||r===void 0?void 0:r.get(this.storageKey)];case 1:return n=o.sent(),n&&n.length>0&&Promise.all(n.map(function(a){return i.execute(a)})).catch(),[2,Promise.resolve(void 0)]}})})},t.prototype.execute=function(e){var r=this;return e.insert_id||(e.insert_id=Ce()),new Promise(function(n){var i={event:e,attempts:0,callback:function(o){return n(o)},timeout:0};r.queue.push(i),r.schedule(r.config.flushIntervalMillis),r.saveEvents()})},t.prototype.removeEventsExceedFlushMaxRetries=function(e){var r=this;return e.filter(function(n){return n.attempts+=1,n.attempts<r.config.flushMaxRetries?!0:(r.fulfillRequest([n],500,Zo),!1)})},t.prototype.scheduleEvents=function(e){var r=this;e.forEach(function(n){r.schedule(n.timeout===0?r.config.flushIntervalMillis:n.timeout)})},t.prototype.schedule=function(e){var r=this;if(!this.config.offline&&(this.scheduleId===null||this.scheduleId&&e>this.scheduledTimeout)){this.scheduleId&&clearTimeout(this.scheduleId),this.scheduledTimeout=e,this.scheduleId=setTimeout(function(){r.queue=r.queue.map(function(n){return n.timeout=0,n}),r.flush(!0)},e);return}},t.prototype.resetSchedule=function(){this.scheduleId=null,this.scheduledTimeout=0},t.prototype.flush=function(e){return e===void 0&&(e=!1),S(this,void 0,void 0,function(){var r,n,i,o=this;return T(this,function(a){switch(a.label){case 0:return this.config.offline?(this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush while offline."),[2]):this.flushId?(this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush because previous flush has not resolved."),[2]):(this.flushId=this.scheduleId,this.resetSchedule(),r=[],n=[],this.queue.forEach(function(s){return s.timeout===0?r.push(s):n.push(s)}),i=fa(r,this.config.flushQueueSize),[4,i.reduce(function(s,c){return S(o,void 0,void 0,function(){return T(this,function(u){switch(u.label){case 0:return[4,s];case 1:return u.sent(),[4,this.send(c,e)];case 2:return[2,u.sent()]}})})},Promise.resolve())]);case 1:return a.sent(),this.flushId=null,this.scheduleEvents(this.queue),[2]}})})},t.prototype.send=function(e,r){return r===void 0&&(r=!0),S(this,void 0,void 0,function(){var n,i,o,a,s;return T(this,function(c){switch(c.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,ta)];n={api_key:this.config.apiKey,events:e.map(function(u){var l=u.event;l.extra;var d=dt(l,["extra"]);return d}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString(),request_metadata:this.config.requestMetadata},this.config.requestMetadata=new pa,c.label=1;case 1:return c.trys.push([1,3,,4]),i=Jn(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(i,n)];case 2:return o=c.sent(),o===null?(this.fulfillRequest(e,0,Qo),[2]):r?(this.handleResponse(o,e),[3,4]):("body"in o?this.fulfillRequest(e,o.statusCode,"".concat(o.status,": ").concat(nt(o))):this.fulfillRequest(e,o.statusCode,o.status),[2]);case 3:return a=c.sent(),s=ga(a),this.config.loggerProvider.error(s),this.handleResponse({status:K.Failed,statusCode:0},e),[3,4];case 4:return[2]}})})},t.prototype.handleResponse=function(e,r){var n=e.status;switch(n){case K.Success:{this.handleSuccessResponse(e,r);break}case K.Invalid:{this.handleInvalidResponse(e,r);break}case K.PayloadTooLarge:{this.handlePayloadTooLargeResponse(e,r);break}case K.RateLimit:{this.handleRateLimitResponse(e,r);break}default:{this.config.loggerProvider.warn(`{code: 0, error: "Status '`.concat(n,"' provided for ").concat(r.length,' events"}')),this.handleOtherResponse(r);break}}},t.prototype.handleSuccessResponse=function(e,r){this.fulfillRequest(r,e.statusCode,Yo)},t.prototype.handleInvalidResponse=function(e,r){var n=this;if(e.body.missingField||e.body.error.startsWith(ra)){this.fulfillRequest(r,e.statusCode,e.body.error);return}var i=U(U(U(U([],D(Object.values(e.body.eventsWithInvalidFields)),!1),D(Object.values(e.body.eventsWithMissingFields)),!1),D(Object.values(e.body.eventsWithInvalidIdLengths)),!1),D(e.body.silencedEvents),!1).flat(),o=new Set(i),a=r.filter(function(c,u){if(o.has(u)){n.fulfillRequest([c],e.statusCode,e.body.error);return}return!0});a.length>0&&this.config.loggerProvider.warn(nt(e));var s=this.removeEventsExceedFlushMaxRetries(a);this.scheduleEvents(s)},t.prototype.handlePayloadTooLargeResponse=function(e,r){if(r.length===1){this.fulfillRequest(r,e.statusCode,e.body.error);return}this.config.loggerProvider.warn(nt(e)),this.config.flushQueueSize/=2;var n=this.removeEventsExceedFlushMaxRetries(r);this.scheduleEvents(n)},t.prototype.handleRateLimitResponse=function(e,r){var n=this,i=Object.keys(e.body.exceededDailyQuotaUsers),o=Object.keys(e.body.exceededDailyQuotaDevices),a=e.body.throttledEvents,s=new Set(i),c=new Set(o),u=new Set(a),l=r.filter(function(f,v){if(f.event.user_id&&s.has(f.event.user_id)||f.event.device_id&&c.has(f.event.device_id)){n.fulfillRequest([f],e.statusCode,e.body.error);return}return u.has(v)&&(f.timeout=n.throttleTimeout),!0});l.length>0&&this.config.loggerProvider.warn(nt(e));var d=this.removeEventsExceedFlushMaxRetries(l);this.scheduleEvents(d)},t.prototype.handleOtherResponse=function(e){var r=this,n=e.map(function(o){return o.timeout=o.attempts*r.retryTimeout,o}),i=this.removeEventsExceedFlushMaxRetries(n);this.scheduleEvents(i)},t.prototype.fulfillRequest=function(e,r,n){this.removeEvents(e),e.forEach(function(i){return i.callback(je(i.event,r,n))})},t.prototype.saveEvents=function(){if(this.config.storageProvider){var e=this.queue.map(function(r){return r.event});this.config.storageProvider.set(this.storageKey,e)}},t.prototype.removeEvents=function(e){this.queue=this.queue.filter(function(r){return!e.some(function(n){return n.event.insert_id===r.event.insert_id})}),this.saveEvents()},t}(),Je=function(t){return t===void 0&&(t=Wn),Vi.getInstance(t)},ya=function(t,e){Je(e).identityStore.editIdentity().setUserId(t).commit()},ba=function(t,e){Je(e).identityStore.editIdentity().setDeviceId(t).commit()},Ea=function(){function t(){this.name="identity",this.type="before",this.identityStore=Je().identityStore}return t.prototype.execute=function(e){return S(this,void 0,void 0,function(){var r;return T(this,function(n){return r=e.user_properties,r&&this.identityStore.editIdentity().updateUserProperties(r).commit(),[2,e]})})},t.prototype.setup=function(e){return S(this,void 0,void 0,function(){return T(this,function(r){return e.instanceName&&(this.identityStore=Je(e.instanceName).identityStore),[2]})})},t}(),Yn=function(t,e){e===void 0&&(e=Date.now());var r=Date.now(),n=r-e;return n>t},Qn=function(t,e,r){return e===void 0&&(e=""),r===void 0&&(r=10),[yt,e,t.substring(0,r)].filter(Boolean).join("_")},Ta=function(t){return"".concat(yt.toLowerCase(),"_").concat(t.substring(0,6))},Sa=function(){var t,e,r,n;if(typeof navigator>"u")return"";var i=navigator.userLanguage;return(n=(r=(e=(t=navigator.languages)===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:navigator.language)!==null&&r!==void 0?r:i)!==null&&n!==void 0?n:""},ht=function(){var t,e=$();if(!(!((t=e==null?void 0:e.location)===null||t===void 0)&&t.search))return{};var r=e.location.search.substring(1).split("&").filter(Boolean),n=r.reduce(function(i,o){var a=o.split("=",2),s=Gr(a[0]),c=Gr(a[1]);return c&&(i[s]=c),i},{});return n},Gr=function(t){t===void 0&&(t="");try{return decodeURIComponent(t)}catch{return""}},wa=function(t){var e=new Error().stack||"";return e.split(`
`).slice(2+t).map(function(r){return r.trim()})},V=function(t){return function(){var e=I({},t.config),r=e.loggerProvider,n=e.logLevel;return{logger:r,logLevel:n}}},_a=function(t,e){var r,n;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");try{for(var i=F(e.split(".")),o=i.next();!o.done;o=i.next()){var a=o.value;if(a in t)t=t[a];else return}}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},H=function(t,e){return function(){var r,n,i={};try{for(var o=F(e),a=o.next();!a.done;a=o.next()){var s=a.value;i[s]=_a(t,s)}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}},B=function(t,e,r,n,i){return i===void 0&&(i=null),function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=r(),c=s.logger,u=s.logLevel;if(u&&u<oe.Debug||!u||!c)return t.apply(i,o);var l={type:"invoke public method",name:e,args:o,stacktrace:wa(1),time:{start:new Date().toISOString()},states:{}};n&&l.states&&(l.states.before=n());var d=t.apply(i,o);return d&&d.promise?d.promise.then(function(){n&&l.states&&(l.states.after=n()),l.time&&(l.time.end=new Date().toISOString()),c.debug(JSON.stringify(l,null,2))}):(n&&l.states&&(l.states.after=n()),l.time&&(l.time.end=new Date().toISOString()),c.debug(JSON.stringify(l,null,2))),d}},Yt=function(t,e){return!e||!e.length?!0:e.some(function(r){return typeof r=="string"?t===r:t.match(r)})},Ia=function(t,e){var r=t;try{r=decodeURI(t)}catch{}return r},Aa=function(t){var e=0;if(t.length===0)return e;for(var r=0;r<t.length;r++){var n=t.charCodeAt(r);e=(e<<5)-e+n,e|=0}return e},Wr=function(t,e){var r=Aa(t.toString()),n=Math.abs(r),i=n*31,o=i%1e5;return o/1e5<e},fr=function(){function t(){this.memoryStorage=new Map}return t.prototype.isEnabled=function(){return S(this,void 0,void 0,function(){return T(this,function(e){return[2,!0]})})},t.prototype.get=function(e){return S(this,void 0,void 0,function(){return T(this,function(r){return[2,this.memoryStorage.get(e)]})})},t.prototype.getRaw=function(e){return S(this,void 0,void 0,function(){var r;return T(this,function(n){switch(n.label){case 0:return[4,this.get(e)];case 1:return r=n.sent(),[2,r?JSON.stringify(r):void 0]}})})},t.prototype.set=function(e,r){return S(this,void 0,void 0,function(){return T(this,function(n){return this.memoryStorage.set(e,r),[2]})})},t.prototype.remove=function(e){return S(this,void 0,void 0,function(){return T(this,function(r){return this.memoryStorage.delete(e),[2]})})},t.prototype.reset=function(){return S(this,void 0,void 0,function(){return T(this,function(e){return this.memoryStorage.clear(),[2]})})},t}(),Qt=function(){function t(e){this.options=I({},e)}return t.prototype.isEnabled=function(){return S(this,void 0,void 0,function(){var e,r,n;return T(this,function(i){switch(i.label){case 0:if(!$())return[2,!1];t.testValue=String(Date.now()),e=new t(this.options),r="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,e.set(r,t.testValue)];case 2:return i.sent(),[4,e.get(r)];case 3:return n=i.sent(),[2,n===t.testValue];case 4:return i.sent(),[2,!1];case 5:return[4,e.remove(r)];case 6:return i.sent(),[7];case 7:return[2]}})})},t.prototype.get=function(e){var r;return S(this,void 0,void 0,function(){var n,i;return T(this,function(o){switch(o.label){case 0:return[4,this.getRaw(e)];case 1:if(n=o.sent(),!n)return[2,void 0];try{return i=(r=ka(n))!==null&&r!==void 0?r:Pa(n),i===void 0?(console.error("Amplitude Logger [Error]: Failed to decode cookie value for key: ".concat(e,", value: ").concat(n)),[2,void 0]):[2,JSON.parse(i)]}catch{return console.error("Amplitude Logger [Error]: Failed to parse cookie value for key: ".concat(e,", value: ").concat(n)),[2,void 0]}return[2]}})})},t.prototype.getRaw=function(e){var r,n;return S(this,void 0,void 0,function(){var i,o,a;return T(this,function(s){return i=$(),o=(n=(r=i==null?void 0:i.document)===null||r===void 0?void 0:r.cookie.split("; "))!==null&&n!==void 0?n:[],a=o.find(function(c){return c.indexOf(e+"=")===0}),a?[2,a.substring(e.length+1)]:[2,void 0]})})},t.prototype.set=function(e,r){var n;return S(this,void 0,void 0,function(){var i,o,a,s,c,u,l;return T(this,function(d){try{i=(n=this.options.expirationDays)!==null&&n!==void 0?n:0,o=r!==null?i:-1,a=void 0,o&&(s=new Date,s.setTime(s.getTime()+o*24*60*60*1e3),a=s),c="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(r)))),a&&(c+="; expires=".concat(a.toUTCString())),c+="; path=/",this.options.domain&&(c+="; domain=".concat(this.options.domain)),this.options.secure&&(c+="; Secure"),this.options.sameSite&&(c+="; SameSite=".concat(this.options.sameSite)),u=$(),u&&(u.document.cookie=c)}catch(f){l=f instanceof Error?f.message:String(f),console.error("Amplitude Logger [Error]: Failed to set cookie for key: ".concat(e,". Error: ").concat(l))}return[2]})})},t.prototype.remove=function(e){return S(this,void 0,void 0,function(){return T(this,function(r){switch(r.label){case 0:return[4,this.set(e,null)];case 1:return r.sent(),[2]}})})},t.prototype.reset=function(){return S(this,void 0,void 0,function(){return T(this,function(e){return[2]})})},t}(),ka=function(t){try{return decodeURIComponent(atob(t))}catch{return}},Pa=function(t){try{return decodeURIComponent(atob(decodeURIComponent(t)))}catch{return}},Kr=function(t,e,r){return e===void 0&&(e=""),r===void 0&&(r=10),[yt,e,t.substring(0,r)].filter(Boolean).join("_")},Zn=function(){function t(e){this.storage=e}return t.prototype.isEnabled=function(){return S(this,void 0,void 0,function(){var e,r,n,i;return T(this,function(o){switch(o.label){case 0:if(!this.storage)return[2,!1];e=String(Date.now()),r=new t(this.storage),n="AMP_TEST",o.label=1;case 1:return o.trys.push([1,4,5,7]),[4,r.set(n,e)];case 2:return o.sent(),[4,r.get(n)];case 3:return i=o.sent(),[2,i===e];case 4:return o.sent(),[2,!1];case 5:return[4,r.remove(n)];case 6:return o.sent(),[7];case 7:return[2]}})})},t.prototype.get=function(e){return S(this,void 0,void 0,function(){var r;return T(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:return r=n.sent(),r?[2,JSON.parse(r)]:[2,void 0];case 2:return n.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},t.prototype.getRaw=function(e){var r;return S(this,void 0,void 0,function(){return T(this,function(n){return[2,((r=this.storage)===null||r===void 0?void 0:r.getItem(e))||void 0]})})},t.prototype.set=function(e,r){var n;return S(this,void 0,void 0,function(){return T(this,function(i){try{(n=this.storage)===null||n===void 0||n.setItem(e,JSON.stringify(r))}catch{}return[2]})})},t.prototype.remove=function(e){var r;return S(this,void 0,void 0,function(){return T(this,function(n){try{(r=this.storage)===null||r===void 0||r.removeItem(e)}catch{}return[2]})})},t.prototype.reset=function(){var e;return S(this,void 0,void 0,function(){return T(this,function(r){try{(e=this.storage)===null||e===void 0||e.clear()}catch{}return[2]})})},t}(),Ra=10,Ca=1,M={TAGS:"tags",COUNTERS:"counters",HISTOGRAMS:"histograms",EVENTS:"events",INTERNAL:"internal"},$r={LAST_FLUSH_TIMESTAMP:"last_flush_timestamp"},zr=function(){function t(e,r){this.dbPromise=null,this.logger=r,this.dbName="AMP_diagnostics_".concat(e.substring(0,10))}return t.isSupported=function(){var e;return((e=$())===null||e===void 0?void 0:e.indexedDB)!==void 0},t.prototype.getDB=function(){return S(this,void 0,void 0,function(){return T(this,function(e){return this.dbPromise||(this.dbPromise=this.openDB()),[2,this.dbPromise]})})},t.prototype.openDB=function(){var e=this;return new Promise(function(r,n){var i=indexedDB.open(e.dbName,Ca);i.onerror=function(){e.dbPromise=null,n(new Error("Failed to open IndexedDB"))},i.onsuccess=function(){var o=i.result;o.onclose=function(){e.dbPromise=null,e.logger.debug("DiagnosticsStorage: DB connection closed.")},o.onerror=function(a){e.logger.debug("DiagnosticsStorage: A global database error occurred.",a),o.close()},r(o)},i.onupgradeneeded=function(o){var a=o.target.result;e.createTables(a)}})},t.prototype.createTables=function(e){if(e.objectStoreNames.contains(M.TAGS)||e.createObjectStore(M.TAGS,{keyPath:"key"}),e.objectStoreNames.contains(M.COUNTERS)||e.createObjectStore(M.COUNTERS,{keyPath:"key"}),e.objectStoreNames.contains(M.HISTOGRAMS)||e.createObjectStore(M.HISTOGRAMS,{keyPath:"key"}),!e.objectStoreNames.contains(M.EVENTS)){var r=e.createObjectStore(M.EVENTS,{keyPath:"id",autoIncrement:!0});r.createIndex("time_idx","time",{unique:!1})}e.objectStoreNames.contains(M.INTERNAL)||e.createObjectStore(M.INTERNAL,{keyPath:"key"})},t.prototype.setTags=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a=this;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),Object.entries(e).length===0?[2]:[4,this.getDB()];case 1:return r=s.sent(),n=r.transaction([M.TAGS],"readwrite"),i=n.objectStore(M.TAGS),[2,new Promise(function(c){var u=Object.entries(e);n.oncomplete=function(){c()},n.onabort=function(l){a.logger.debug("DiagnosticsStorage: Failed to set tags",l),c()},u.forEach(function(l){var d=D(l,2),f=d[0],v=d[1],h=i.put({key:f,value:v});h.onerror=function(p){a.logger.debug("DiagnosticsStorage: Failed to set tag",f,v,p)}})})];case 2:return o=s.sent(),this.logger.debug("DiagnosticsStorage: Failed to set tags",o),[3,3];case 3:return[2]}})})},t.prototype.incrementCounters=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a=this;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),Object.entries(e).length===0?[2]:[4,this.getDB()];case 1:return r=s.sent(),n=r.transaction([M.COUNTERS],"readwrite"),i=n.objectStore(M.COUNTERS),[2,new Promise(function(c){var u=Object.entries(e);n.oncomplete=function(){c()},n.onabort=function(l){a.logger.debug("DiagnosticsStorage: Failed to increment counters",l),c()},u.forEach(function(l){var d=D(l,2),f=d[0],v=d[1],h=i.get(f);h.onsuccess=function(){var p=h.result,g=p?p.value:0,m=i.put({key:f,value:g+v});m.onerror=function(y){a.logger.debug("DiagnosticsStorage: Failed to update counter",f,y)}},h.onerror=function(p){a.logger.debug("DiagnosticsStorage: Failed to read existing counter",f,p)}})})];case 2:return o=s.sent(),this.logger.debug("DiagnosticsStorage: Failed to increment counters",o),[3,3];case 3:return[2]}})})},t.prototype.setHistogramStats=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a=this;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),Object.entries(e).length===0?[2]:[4,this.getDB()];case 1:return r=s.sent(),n=r.transaction([M.HISTOGRAMS],"readwrite"),i=n.objectStore(M.HISTOGRAMS),[2,new Promise(function(c){var u=Object.entries(e);n.oncomplete=function(){c()},n.onabort=function(l){a.logger.debug("DiagnosticsStorage: Failed to set histogram stats",l),c()},u.forEach(function(l){var d=D(l,2),f=d[0],v=d[1],h=i.get(f);h.onsuccess=function(){var p=h.result,g;p?g={key:f,count:p.count+v.count,min:Math.min(p.min,v.min),max:Math.max(p.max,v.max),sum:p.sum+v.sum}:g={key:f,count:v.count,min:v.min,max:v.max,sum:v.sum};var m=i.put(g);m.onerror=function(y){a.logger.debug("DiagnosticsStorage: Failed to set histogram stats",f,y)}},h.onerror=function(p){a.logger.debug("DiagnosticsStorage: Failed to read existing histogram stats",f,p)}})})];case 2:return o=s.sent(),this.logger.debug("DiagnosticsStorage: Failed to set histogram stats",o),[3,3];case 3:return[2]}})})},t.prototype.addEventRecords=function(e){return S(this,void 0,void 0,function(){var r,n,i,o,a=this;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e.length===0?[2]:[4,this.getDB()];case 1:return r=s.sent(),n=r.transaction([M.EVENTS],"readwrite"),i=n.objectStore(M.EVENTS),[2,new Promise(function(c){n.oncomplete=function(){c()},n.onabort=function(l){a.logger.debug("DiagnosticsStorage: Failed to add event records",l),c()};var u=i.count();u.onsuccess=function(){var l=u.result,d=Math.max(0,Ra-l);d<e.length&&a.logger.debug("DiagnosticsStorage: Only added ".concat(d," of ").concat(e.length," events due to storage limit")),e.slice(0,d).forEach(function(f){var v=i.add(f);v.onerror=function(h){a.logger.debug("DiagnosticsStorage: Failed to add event record",h)}})},u.onerror=function(l){a.logger.debug("DiagnosticsStorage: Failed to count existing events",l)}})];case 2:return o=s.sent(),this.logger.debug("DiagnosticsStorage: Failed to add event records",o),[3,3];case 3:return[2]}})})},t.prototype.setInternal=function(e,r){return S(this,void 0,void 0,function(){var n,i,o,a;return T(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.getDB()];case 1:return n=s.sent(),i=n.transaction([M.INTERNAL],"readwrite"),o=i.objectStore(M.INTERNAL),[2,new Promise(function(c,u){i.onabort=function(){return u(new Error("Failed to set internal value"))};var l=o.put({key:e,value:r});l.onsuccess=function(){return c()},l.onerror=function(){return u(new Error("Failed to set internal value"))}})];case 2:return a=s.sent(),this.logger.debug("DiagnosticsStorage: Failed to set internal value",a),[3,3];case 3:return[2]}})})},t.prototype.getInternal=function(e){return S(this,void 0,void 0,function(){var r,n,i,o;return T(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.getDB()];case 1:return r=a.sent(),n=r.transaction([M.INTERNAL],"readonly"),i=n.objectStore(M.INTERNAL),[2,new Promise(function(s,c){n.onabort=function(){return c(new Error("Failed to get internal value"))};var u=i.get(e);u.onsuccess=function(){return s(u.result)},u.onerror=function(){return c(new Error("Failed to get internal value"))}})];case 2:return o=a.sent(),this.logger.debug("DiagnosticsStorage: Failed to get internal value",o),[2,void 0];case 3:return[2]}})})},t.prototype.getLastFlushTimestamp=function(){return S(this,void 0,void 0,function(){var e,r;return T(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getInternal($r.LAST_FLUSH_TIMESTAMP)];case 1:return e=n.sent(),[2,e?parseInt(e.value,10):void 0];case 2:return r=n.sent(),this.logger.debug("DiagnosticsStorage: Failed to get last flush timestamp",r),[2,void 0];case 3:return[2]}})})},t.prototype.setLastFlushTimestamp=function(e){return S(this,void 0,void 0,function(){var r;return T(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.setInternal($r.LAST_FLUSH_TIMESTAMP,e.toString())];case 1:return n.sent(),[3,3];case 2:return r=n.sent(),this.logger.debug("DiagnosticsStorage: Failed to set last flush timestamp",r),[3,3];case 3:return[2]}})})},t.prototype.clearTable=function(e,r){return new Promise(function(n,i){var o=e.objectStore(r),a=o.clear();a.onsuccess=function(){return n()},a.onerror=function(){return i(new Error("Failed to clear table ".concat(r)))}})},t.prototype.getAllAndClear=function(){return S(this,void 0,void 0,function(){var e,r,n,i,o,a,s,c;return T(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),[4,this.getDB()];case 1:return e=u.sent(),r=e.transaction([M.TAGS,M.COUNTERS,M.HISTOGRAMS,M.EVENTS],"readwrite"),[4,Promise.all([this.getAllFromStore(r,M.TAGS),this.getAllFromStore(r,M.COUNTERS),this.getAllFromStore(r,M.HISTOGRAMS),this.getAllFromStore(r,M.EVENTS)])];case 2:return n=D.apply(void 0,[u.sent(),4]),i=n[0],o=n[1],a=n[2],s=n[3],[4,Promise.all([this.clearTable(r,M.COUNTERS),this.clearTable(r,M.HISTOGRAMS),this.clearTable(r,M.EVENTS)])];case 3:return u.sent(),[2,{tags:i,counters:o,histogramStats:a,events:s}];case 4:return c=u.sent(),this.logger.debug("DiagnosticsStorage: Failed to get all and clear data",c),[2,{tags:[],counters:[],histogramStats:[],events:[]}];case 5:return[2]}})})},t.prototype.getAllFromStore=function(e,r){return new Promise(function(n,i){var o=e.objectStore(r),a=o.getAll();a.onsuccess=function(){return n(a.result)},a.onerror=function(){return i(new Error("Failed to get all from ".concat(r)))}})},t}(),Oa=1e3,it=5*60*1e3,La="https://diagnostics.prod.us-west-2.amplitude.com/v1/capture",Da="https://diagnostics.prod.eu-central-1.amplitude.com/v1/capture",Ut=1e4,Na=10,xa=function(){function t(e,r,n,i){n===void 0&&(n="US"),this.inMemoryTags={},this.inMemoryCounters={},this.inMemoryHistograms={},this.inMemoryEvents=[],this.saveTimer=null,this.flushTimer=null,this.apiKey=e,this.logger=r,this.serverUrl=n==="US"?La:Da,this.logger.debug("DiagnosticsClient: Initializing with options",JSON.stringify(i,null,2)),this.config=I({enabled:!0,sampleRate:0},i),this.startTimestamp=Date.now(),this.shouldTrack=Wr(this.startTimestamp,this.config.sampleRate)&&this.config.enabled,zr.isSupported()?this.storage=new zr(e,r):this.logger.debug("DiagnosticsClient: IndexedDB is not supported"),this.initializeFlushInterval()}return t.prototype.isStorageAndTrackEnabled=function(){return!!this.storage&&!!this.shouldTrack},t.prototype.setTag=function(e,r){if(this.isStorageAndTrackEnabled()){if(Object.keys(this.inMemoryTags).length>=Ut){this.logger.debug("DiagnosticsClient: Early return setTags as reaching memory limit");return}this.inMemoryTags[e]=r,this.startTimersIfNeeded()}},t.prototype.increment=function(e,r){if(r===void 0&&(r=1),!!this.isStorageAndTrackEnabled()){if(Object.keys(this.inMemoryCounters).length>=Ut){this.logger.debug("DiagnosticsClient: Early return increment as reaching memory limit");return}this.inMemoryCounters[e]=(this.inMemoryCounters[e]||0)+r,this.startTimersIfNeeded()}},t.prototype.recordHistogram=function(e,r){if(this.isStorageAndTrackEnabled()){if(Object.keys(this.inMemoryHistograms).length>=Ut){this.logger.debug("DiagnosticsClient: Early return recordHistogram as reaching memory limit");return}var n=this.inMemoryHistograms[e];n?(n.count+=1,n.min=Math.min(n.min,r),n.max=Math.max(n.max,r),n.sum+=r):this.inMemoryHistograms[e]={count:1,min:r,max:r,sum:r},this.startTimersIfNeeded()}},t.prototype.recordEvent=function(e,r){if(this.isStorageAndTrackEnabled()){if(this.inMemoryEvents.length>=Na){this.logger.debug("DiagnosticsClient: Early return recordEvent as reaching memory limit");return}this.inMemoryEvents.push({event_name:e,time:Date.now(),event_properties:r}),this.startTimersIfNeeded()}},t.prototype.startTimersIfNeeded=function(){var e=this;this.saveTimer||(this.saveTimer=setTimeout(function(){e.saveAllDataToStorage().catch(function(r){e.logger.debug("DiagnosticsClient: Failed to save all data to storage",r)}).finally(function(){e.saveTimer=null})},Oa)),this.flushTimer||(this.flushTimer=setTimeout(function(){e._flush().catch(function(r){e.logger.debug("DiagnosticsClient: Failed to flush",r)}).finally(function(){e.flushTimer=null})},it))},t.prototype.saveAllDataToStorage=function(){return S(this,void 0,void 0,function(){var e,r,n,i;return T(this,function(o){switch(o.label){case 0:return this.storage?(e=I({},this.inMemoryTags),r=I({},this.inMemoryCounters),n=I({},this.inMemoryHistograms),i=U([],D(this.inMemoryEvents),!1),this.inMemoryEvents=[],this.inMemoryTags={},this.inMemoryCounters={},this.inMemoryHistograms={},[4,Promise.all([this.storage.setTags(e),this.storage.incrementCounters(r),this.storage.setHistogramStats(n),this.storage.addEventRecords(i)])]):[2];case 1:return o.sent(),[2]}})})},t.prototype._flush=function(){return S(this,void 0,void 0,function(){var e,r,n,i,o,a,s,c,u,l;return T(this,function(d){switch(d.label){case 0:return this.storage?[4,this.saveAllDataToStorage()]:[2];case 1:return d.sent(),this.saveTimer=null,this.flushTimer=null,[4,this.storage.getAllAndClear()];case 2:return e=d.sent(),r=e.tags,n=e.counters,i=e.histogramStats,o=e.events,this.storage.setLastFlushTimestamp(Date.now()),a={},r.forEach(function(f){a[f.key]=f.value}),s={},n.forEach(function(f){s[f.key]=f.value}),c={},i.forEach(function(f){c[f.key]={count:f.count,min:f.min,max:f.max,avg:Math.round(f.sum/f.count*100)/100}}),u=o.map(function(f){return{event_name:f.event_name,time:f.time,event_properties:f.event_properties}}),Object.keys(s).length===0&&Object.keys(c).length===0&&u.length===0?[2]:(l={tags:a,histogram:c,counters:s,events:u},this.fetch(l),[2])}})})},t.prototype.fetch=function(e){return S(this,void 0,void 0,function(){var r,n;return T(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),!$())throw new Error("DiagnosticsClient: Fetch is not supported");return[4,fetch(this.serverUrl,{method:"POST",headers:{"X-ApiKey":this.apiKey,"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return r=i.sent(),r.ok?(this.logger.debug("DiagnosticsClient: Successfully sent diagnostics data"),[3,3]):(this.logger.debug("DiagnosticsClient: Failed to send diagnostics data."),[2]);case 2:return n=i.sent(),this.logger.debug("DiagnosticsClient: Failed to send diagnostics data. ",n),[3,3];case 3:return[2]}})})},t.prototype.initializeFlushInterval=function(){return S(this,void 0,void 0,function(){var e,r,n;return T(this,function(i){switch(i.label){case 0:return this.storage?(e=Date.now(),[4,this.storage.getLastFlushTimestamp()]):[2];case 1:return r=i.sent()||-1,r===-1?(this.storage.setLastFlushTimestamp(e),this._setFlushTimer(it),[2]):(n=e-r,n>=it?(this._flush(),[2]):(this._setFlushTimer(it-n),[2]))}})})},t.prototype._setFlushTimer=function(e){var r=this;this.flushTimer=setTimeout(function(){r._flush().catch(function(n){r.logger.debug("DiagnosticsClient: Failed to flush",n)}).finally(function(){r.flushTimer=null})},e)},t.prototype._setSampleRate=function(e){this.logger.debug("DiagnosticsClient: Setting sample rate to",e),this.config.sampleRate=e,this.shouldTrack=Wr(this.startTimestamp,this.config.sampleRate)&&this.config.enabled,this.logger.debug("DiagnosticsClient: Should track is",this.shouldTrack)},t}(),vr=function(){function t(){}return t.prototype.send=function(e,r){return Promise.resolve(null)},t.prototype.buildResponse=function(e){var r,n,i,o,a,s,c,u,l,d,f,v,h,p,g,m,y,b,w,E,_,C;if(typeof e!="object")return null;var k=e.code||0,L=this.buildStatus(k);switch(L){case K.Success:return{status:L,statusCode:k,body:{eventsIngested:(r=e.events_ingested)!==null&&r!==void 0?r:0,payloadSizeBytes:(n=e.payload_size_bytes)!==null&&n!==void 0?n:0,serverUploadTime:(i=e.server_upload_time)!==null&&i!==void 0?i:0}};case K.Invalid:return{status:L,statusCode:k,body:{error:(o=e.error)!==null&&o!==void 0?o:"",missingField:(a=e.missing_field)!==null&&a!==void 0?a:"",eventsWithInvalidFields:(s=e.events_with_invalid_fields)!==null&&s!==void 0?s:{},eventsWithMissingFields:(c=e.events_with_missing_fields)!==null&&c!==void 0?c:{},eventsWithInvalidIdLengths:(u=e.events_with_invalid_id_lengths)!==null&&u!==void 0?u:{},epsThreshold:(l=e.eps_threshold)!==null&&l!==void 0?l:0,exceededDailyQuotaDevices:(d=e.exceeded_daily_quota_devices)!==null&&d!==void 0?d:{},silencedDevices:(f=e.silenced_devices)!==null&&f!==void 0?f:[],silencedEvents:(v=e.silenced_events)!==null&&v!==void 0?v:[],throttledDevices:(h=e.throttled_devices)!==null&&h!==void 0?h:{},throttledEvents:(p=e.throttled_events)!==null&&p!==void 0?p:[]}};case K.PayloadTooLarge:return{status:L,statusCode:k,body:{error:(g=e.error)!==null&&g!==void 0?g:""}};case K.RateLimit:return{status:L,statusCode:k,body:{error:(m=e.error)!==null&&m!==void 0?m:"",epsThreshold:(y=e.eps_threshold)!==null&&y!==void 0?y:0,throttledDevices:(b=e.throttled_devices)!==null&&b!==void 0?b:{},throttledUsers:(w=e.throttled_users)!==null&&w!==void 0?w:{},exceededDailyQuotaDevices:(E=e.exceeded_daily_quota_devices)!==null&&E!==void 0?E:{},exceededDailyQuotaUsers:(_=e.exceeded_daily_quota_users)!==null&&_!==void 0?_:{},throttledEvents:(C=e.throttled_events)!==null&&C!==void 0?C:[]}};case K.Timeout:default:return{status:L,statusCode:k}}},t.prototype.buildStatus=function(e){return e>=200&&e<300?K.Success:e===429?K.RateLimit:e===413?K.PayloadTooLarge:e===408?K.Timeout:e>=400&&e<500?K.Invalid:e>=500?K.Failed:K.Unknown},t}(),Ma=function(t){Me(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.send=function(r,n){return S(this,void 0,void 0,function(){var i,o,a;return T(this,function(s){switch(s.label){case 0:if(typeof fetch>"u")throw new Error("FetchTransport is not supported");return i={headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(n),method:"POST"},[4,fetch(r,i)];case 1:return o=s.sent(),[4,o.text()];case 2:a=s.sent();try{return[2,this.buildResponse(JSON.parse(a))]}catch{return[2,this.buildResponse({code:o.status})]}return[2]}})})},e}(vr),Ua=function(){function t(e,r){this.key="AMP_remote_config_".concat(e.substring(0,10)),this.logger=r}return t.prototype.fetchConfig=function(){var e=null,r={remoteConfig:null,lastFetch:new Date};try{e=localStorage.getItem(this.key)}catch(i){return this.logger.debug("Remote config localstorage failed to access: ",i),Promise.resolve(r)}if(e===null)return this.logger.debug("Remote config localstorage gets null because the key does not exist"),Promise.resolve(r);try{var n=JSON.parse(e);return this.logger.debug("Remote config localstorage parsed successfully: ".concat(JSON.stringify(n))),Promise.resolve({remoteConfig:n.remoteConfig,lastFetch:new Date(n.lastFetch)})}catch(i){return this.logger.debug("Remote config localstorage failed to parse: ",i),localStorage.removeItem(this.key),Promise.resolve(r)}},t.prototype.setConfig=function(e){try{return localStorage.setItem(this.key,JSON.stringify(e)),this.logger.debug("Remote config localstorage set successfully."),Promise.resolve(!0)}catch(r){this.logger.debug("Remote config localstorage failed to set: ",r)}return Promise.resolve(!1)},t}(),Fa="https://sr-client-cfg.amplitude.com/config",ja="https://sr-client-cfg.eu.amplitude.com/config",qa=3,Va=1e3,Ha=function(){function t(e,r,n){n===void 0&&(n="US"),this.callbackInfos=[],this.apiKey=e,this.serverUrl=n==="US"?Fa:ja,this.logger=r,this.storage=new Ua(e,r)}return t.prototype.subscribe=function(e,r,n){var i=Ce(),o={id:i,key:e,deliveryMode:r,callback:n};return this.callbackInfos.push(o),r==="all"?this.subscribeAll(o):this.subscribeWaitForRemote(o,r.timeout),i},t.prototype.unsubscribe=function(e){var r=this.callbackInfos.findIndex(function(n){return n.id===e});return r===-1?(this.logger.debug("Remote config client unsubscribe failed because callback with id ".concat(e," doesn't exist.")),!1):(this.callbackInfos.splice(r,1),this.logger.debug("Remote config client unsubscribe succeeded removing callback with id ".concat(e,".")),!0)},t.prototype.updateConfigs=function(){return S(this,void 0,void 0,function(){var e,r=this;return T(this,function(n){switch(n.label){case 0:return[4,this.fetch()];case 1:return e=n.sent(),this.storage.setConfig(e),this.callbackInfos.forEach(function(i){r.sendCallback(i,e,"remote")}),[2]}})})},t.prototype.subscribeAll=function(e){return S(this,void 0,void 0,function(){var r,n,i,o=this;return T(this,function(a){switch(a.label){case 0:return r=this.fetch().then(function(s){o.logger.debug("Remote config client subscription all mode fetched from remote: ".concat(JSON.stringify(s))),o.sendCallback(e,s,"remote"),o.storage.setConfig(s)}),n=this.storage.fetchConfig().then(function(s){return s}),[4,Promise.race([r,n])];case 1:return i=a.sent(),i!==void 0&&(this.logger.debug("Remote config client subscription all mode fetched from cache: ".concat(JSON.stringify(i))),this.sendCallback(e,i,"cache")),[4,r];case 2:return a.sent(),[2]}})})},t.prototype.subscribeWaitForRemote=function(e,r){return S(this,void 0,void 0,function(){var n,i,i;return T(this,function(o){switch(o.label){case 0:n=new Promise(function(a,s){setTimeout(function(){s("Timeout exceeded")},r)}),o.label=1;case 1:return o.trys.push([1,3,,5]),[4,Promise.race([this.fetch(),n])];case 2:return i=o.sent(),this.logger.debug("Remote config client subscription wait for remote mode returns from remote."),this.sendCallback(e,i,"remote"),this.storage.setConfig(i),[3,5];case 3:return o.sent(),this.logger.debug("Remote config client subscription wait for remote mode exceeded timeout. Try to fetch from cache."),[4,this.storage.fetchConfig()];case 4:return i=o.sent(),i.remoteConfig!==null?(this.logger.debug("Remote config client subscription wait for remote mode returns a cached copy."),this.sendCallback(e,i,"cache")):(this.logger.debug("Remote config client subscription wait for remote mode failed to fetch cache."),this.sendCallback(e,i,"remote")),[3,5];case 5:return[2]}})})},t.prototype.sendCallback=function(e,r,n){e.lastCallback=new Date;var i;e.key?i=e.key.split(".").reduce(function(o,a){return o===null?o:a in o?o[a]:null},r.remoteConfig):i=r.remoteConfig,e.callback(i,n,r.lastFetch)},t.prototype.fetch=function(e,r){return e===void 0&&(e=qa),r===void 0&&(r=Va),S(this,void 0,void 0,function(){var n,i,o,a,s,c,u=this;return T(this,function(l){switch(l.label){case 0:n=r/e,i={remoteConfig:null,lastFetch:new Date},o=function(d){var f,v,h,p,g,m;return T(this,function(y){switch(y.label){case 0:f=new AbortController,v=setTimeout(function(){return f.abort()},r),y.label=1;case 1:return y.trys.push([1,7,8,9]),[4,fetch(a.getUrlParams(),{method:"GET",headers:{Accept:"*/*"},signal:f.signal})];case 2:return h=y.sent(),h.ok?[3,4]:[4,h.text()];case 3:return p=y.sent(),a.logger.debug("Remote config client fetch with retry time ".concat(e," failed with ").concat(h.status,": ").concat(p)),[3,6];case 4:return[4,h.json()];case 5:return g=y.sent(),[2,{value:{remoteConfig:g,lastFetch:new Date}}];case 6:return[3,9];case 7:return m=y.sent(),m instanceof Error&&m.name==="AbortError"?a.logger.debug("Remote config client fetch with retry time ".concat(e," timed out after ").concat(r,"ms")):a.logger.debug("Remote config client fetch with retry time ".concat(e," is rejected because: "),m),[3,9];case 8:return clearTimeout(v),[7];case 9:return d<e-1?[4,new Promise(function(b){return setTimeout(b,u.getJitterDelay(n))})]:[3,11];case 10:y.sent(),y.label=11;case 11:return[2]}})},a=this,s=0,l.label=1;case 1:return s<e?[5,o(s)]:[3,4];case 2:if(c=l.sent(),typeof c=="object")return[2,c.value];l.label=3;case 3:return s++,[3,1];case 4:return[2,i]}})})},t.prototype.getJitterDelay=function(e){return Math.floor(Math.random()*e)},t.prototype.getUrlParams=function(){var e=encodeURIComponent(this.apiKey),r=new URLSearchParams;return r.append("config_group",t.CONFIG_GROUP),"".concat(this.serverUrl,"/").concat(e,"?").concat(r.toString())},t.CONFIG_GROUP="browser",t}(),Ba=null,Ga=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],ei="data-amp-track-",Wa=["div","span","h1","h2","h3","h4","h5","h6"],Ka=["a","button",'[role="button"]','[role="link"]','[role="menuitem"]','[role="menuitemcheckbox"]','[role="menuitemradio"]','[role="option"]','[role="tab"]','[role="treeitem"]','[contenteditable="true" i]'],$a=U(['input[type="button"]','input[type="submit"]','input[type="reset"]','input[type="image"]','input[type="file"]'],D(Ka),!1),za=["*"],Xa=1e3,Ja=4,Ya=50;function Qa(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||t===null||t===void 0}function ti(t,e,r){if(t){var n=e.map(Xr),i=r.map(Xr);ri({json:t,allowlist:n,excludelist:i,ancestors:[]})}}function ri(t){var e,r,n=t.json,i=t.targetObject,o=t.allowlist,a=t.excludelist,s=t.ancestors,c=t.parentObject,u=t.targetKey;i||(i=n);var l=Object.keys(i);try{for(var d=F(l),f=d.next();!f.done;f=d.next()){var v=f.value,h=U(U([],D(s),!1),[v],!1);Qa(i[v])?(!Jr(h,o)||Jr(h,a))&&delete i[v]:ri({json:n,targetObject:i[v],allowlist:o,excludelist:a,ancestors:h,parentObject:i,targetKey:v})}}catch(p){e={error:p}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}Object.keys(i).length===0&&c&&u&&delete c[u]}function Xr(t){return t.startsWith("/")&&(t=t.slice(1)),t.split("/").map(function(e){return e.replace(/~0/g,"~").replace(/~1/g,"/")})}function Zt(t,e,r,n){if(r===void 0&&(r=0),n===void 0&&(n=0),n===e.length)return r===t.length;if(r===t.length){for(;n<e.length&&e[n]==="**";)n++;return n===e.length}var i=e[n];if(i==="**"){if(n+1===e.length)return!0;for(var o=r;o<=t.length;o++)if(Zt(t,e,o,n+1))return!0;return!1}else return i==="*"||i===t[r]?Zt(t,e,r+1,n+1):!1}function Jr(t,e){return e.some(function(r){return Zt(t,r)})}var Za=500,ni=100,es=function(){function t(e){this.request=e}return t.prototype.headers=function(e){var r,n;e===void 0&&(e=[]);var i=this.request.headers,o={};if(Array.isArray(i))i.forEach(function(d){var f=D(d,2),v=f[0],h=f[1];o[v]=h});else if(i instanceof Headers)i.forEach(function(d,f){o[f]=d});else if(typeof i=="object"&&i!==null)try{for(var a=F(Object.entries(i)),s=a.next();!s.done;s=a.next()){var c=D(s.value,2),u=c[0],l=c[1];o[u]=l}}catch(d){r={error:d}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return Et(o,{allow:e})},Object.defineProperty(t.prototype,"bodySize",{get:function(){if(typeof this._bodySize=="number")return this._bodySize;var e=$();if(e!=null&&e.TextEncoder){var r=this.request.body;return this._bodySize=ii(r,ni),this._bodySize}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"method",{get:function(){return this.request.method},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return typeof this.request.body=="string"?this.request.body:null},enumerable:!1,configurable:!0}),t.prototype.json=function(e,r){return e===void 0&&(e=[]),r===void 0&&(r=[]),S(this,void 0,void 0,function(){var n;return T(this,function(i){return e.length===0?[2,null]:(n=this.body,[2,hr(n,e,r)])})})},t}(),ts=function(){function t(e,r){this.bodyRaw=e,this.requestHeaders=r}return t.prototype.headers=function(e){return e===void 0&&(e=[]),Et(this.requestHeaders,{allow:e})},Object.defineProperty(t.prototype,"bodySize",{get:function(){return ii(this.bodyRaw,ni)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return typeof this.bodyRaw=="string"?this.bodyRaw:null},enumerable:!1,configurable:!0}),t.prototype.json=function(e,r){return e===void 0&&(e=[]),r===void 0&&(r=[]),S(this,void 0,void 0,function(){var n;return T(this,function(i){return e.length===0?[2,null]:(n=this.body,[2,hr(n,e,r)])})})},t}();function ii(t,e){var r,n,i,o=$(),a=o==null?void 0:o.TextEncoder;if(a){var s;if(typeof t=="string")s=t,i=new a().encode(s).length;else if(t instanceof Blob)s=t,i=s.size;else if(t instanceof URLSearchParams)s=t,i=new a().encode(s.toString()).length;else if(ArrayBuffer.isView(t))s=t,i=s.byteLength;else if(t instanceof ArrayBuffer)s=t,i=s.byteLength;else if(t instanceof FormData){var c=t,u=0,l=0;try{for(var d=F(c.entries()),f=d.next();!f.done;f=d.next()){var v=D(f.value,2),h=v[0],p=v[1];if(u+=h.length,typeof p=="string")u+=new a().encode(p).length;else if(p instanceof Blob)u+=p.size;else return;if(++l>=e)return}}catch(g){r={error:g}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}i=u}else if(t instanceof ReadableStream){s=t;return}return i}}var rs=function(){function t(e){this.response=e}return t.prototype.headers=function(e){var r;if(e===void 0&&(e=[]),this.response.headers instanceof Headers){var n=this.response.headers,i={};return(r=n==null?void 0:n.forEach)===null||r===void 0||r.call(n,function(o,a){i[a]=o}),Et(i,{allow:e})}},Object.defineProperty(t.prototype,"bodySize",{get:function(){var e,r;if(this._bodySize!==void 0)return this._bodySize;var n=(r=(e=this.response.headers)===null||e===void 0?void 0:e.get)===null||r===void 0?void 0:r.call(e,"content-length"),i=n?parseInt(n,10):void 0;return this._bodySize=i,i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.response.status},enumerable:!1,configurable:!0}),t.prototype.text=function(){return S(this,void 0,void 0,function(){var e,r,n;return T(this,function(i){switch(i.label){case 0:this.clonedResponse||(this.clonedResponse=this.response.clone()),i.label=1;case 1:return i.trys.push([1,3,,4]),e=this.clonedResponse.text(),r=new Promise(function(o){return setTimeout(function(){return o(null)},Za)}),[4,Promise.race([e,r])];case 2:return n=i.sent(),[2,n];case 3:return i.sent(),[2,null];case 4:return[2]}})})},t.prototype.json=function(e,r){return e===void 0&&(e=[]),r===void 0&&(r=[]),S(this,void 0,void 0,function(){var n;return T(this,function(i){switch(i.label){case 0:return e.length===0?[2,null]:[4,this.text()];case 1:return n=i.sent(),[2,hr(n,e,r)]}})})},t}(),ns=function(){function t(e,r,n,i){this.statusCode=e,this.headersString=r,this.size=n,this.getJson=i}return Object.defineProperty(t.prototype,"bodySize",{get:function(){return this.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.statusCode},enumerable:!1,configurable:!0}),t.prototype.headers=function(e){var r,n;if(e===void 0&&(e=[]),!this.headersString)return{};var i={},o=this.headersString.split(`\r
`);try{for(var a=F(o),s=a.next();!s.done;s=a.next()){var c=s.value,u=D(c.split(": "),2),l=u[0],d=u[1];l&&d&&(i[l]=d)}}catch(f){r={error:f}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return Et(i,{allow:e})},t.prototype.json=function(e,r){return e===void 0&&(e=[]),r===void 0&&(r=[]),S(this,void 0,void 0,function(){var n;return T(this,function(i){return e.length===0?[2,null]:(n=this.getJson(),n?(ti(n,e,r),[2,n]):[2,null])})})},t}();function hr(t,e,r){if(!t)return null;try{var n=JSON.parse(t);return ti(n,e,r),n}catch{return null}}var We;(function(t){t.REDACT="redact",t.REMOVE="remove"})(We||(We={}));var Yr="[REDACTED]",Et=function(t,e){var r,n,i=e.allow,o=i===void 0?[]:i,a=e.strategy,s=a===void 0?We.REMOVE:a,c=U([],D(zo),!1),u={},l=function(h){var p=h.toLowerCase();c.find(function(g){return g.toLowerCase()===p})?s===We.REDACT&&(u[h]=Yr):o.find(function(g){return g.toLowerCase()===p})?u[h]=t[h]:s===We.REDACT&&(u[h]=Yr)};try{for(var d=F(Object.keys(t)),f=d.next();!f.done;f=d.next()){var v=f.value;l(v)}}catch(h){r={error:h}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return u},is=function(){function t(e,r,n,i,o,a,s,c,u,l,d){s===void 0&&(s=0),this.type=e,this.method=r,this.timestamp=n,this.startTime=i,this.url=o,this.requestWrapper=a,this.status=s,this.duration=c,this.responseWrapper=u,this.error=l,this.endTime=d}return t.prototype.toSerializable=function(){var e,r,n,i,o={type:this.type,method:this.method,url:this.url,timestamp:this.timestamp,status:this.status,duration:this.duration,error:this.error,startTime:this.startTime,endTime:this.endTime,requestHeaders:(e=this.requestWrapper)===null||e===void 0?void 0:e.headers(U([],D(vt),!1)),requestBodySize:(r=this.requestWrapper)===null||r===void 0?void 0:r.bodySize,responseHeaders:(n=this.responseWrapper)===null||n===void 0?void 0:n.headers(U([],D(vt),!1)),responseBodySize:(i=this.responseWrapper)===null||i===void 0?void 0:i.bodySize};return Object.fromEntries(Object.entries(o).filter(function(a){var s=D(a,2);s[0];var c=s[1];return c!==void 0}))},t}();function os(t){return typeof t=="object"&&t!==null&&"url"in t&&"method"in t}var as=function(){function t(e,r){r===void 0&&(r=Ce()),this.callback=e,this.id=r}return t}(),ss=function(){function t(e){this.eventCallbacks=new Map,this.isObserving=!1,this.logger=e;var r=$();t.isSupported()&&(this.globalScope=r)}return t.isSupported=function(){var e=$();return!!e&&!!e.fetch},t.prototype.subscribe=function(e,r){var n,i,o,a,s,c,u,l,d,f;if(this.logger||(this.logger=r),this.eventCallbacks.set(e.id,e),!this.isObserving){var v=(o=(i=(n=this.globalScope)===null||n===void 0?void 0:n.XMLHttpRequest)===null||i===void 0?void 0:i.prototype)===null||o===void 0?void 0:o.open,h=(c=(s=(a=this.globalScope)===null||a===void 0?void 0:a.XMLHttpRequest)===null||s===void 0?void 0:s.prototype)===null||c===void 0?void 0:c.send,p=(d=(l=(u=this.globalScope)===null||u===void 0?void 0:u.XMLHttpRequest)===null||l===void 0?void 0:l.prototype)===null||d===void 0?void 0:d.setRequestHeader;v&&h&&p&&this.observeXhr(v,h,p);var g=(f=this.globalScope)===null||f===void 0?void 0:f.fetch;g&&this.observeFetch(g),this.isObserving=!0}},t.prototype.unsubscribe=function(e){this.eventCallbacks.delete(e.id)},t.prototype.triggerEventCallbacks=function(e){var r=this;this.eventCallbacks.forEach(function(n){var i;try{n.callback(e)}catch(o){(i=r.logger)===null||i===void 0||i.debug("an unexpected error occurred while triggering event callbacks",o)}})},t.prototype.handleNetworkRequestEvent=function(e,r,n,i,o,a,s){var c;if(!(a===void 0||s===void 0)){var u,l="GET";if(os(r)?(u=r.url,l=r.method):u=(c=r==null?void 0:r.toString)===null||c===void 0?void 0:c.call(r),u)try{var d=new URL(u);u="".concat(d.protocol,"//").concat(d.host).concat(d.pathname).concat(d.search).concat(d.hash)}catch{}l=(n==null?void 0:n.method)||l;var f,v;i&&(f=i.status),o&&(v={name:o.name||"UnknownError",message:o.message||"An unknown error occurred"},f=0);var h=Math.floor(performance.now()-s),p=Math.floor(a+h),g=new is(e,l,a,a,u,n,f,h,i,v,p);this.triggerEventCallbacks(g)}},t.prototype.getTimestamps=function(){var e,r;return{startTime:(e=Date.now)===null||e===void 0?void 0:e.call(Date),durationStart:(r=performance==null?void 0:performance.now)===null||r===void 0?void 0:r.call(performance)}},t.prototype.observeFetch=function(e){var r=this;!this.globalScope||!e||(this.globalScope.fetch=function(n,i){return S(r,void 0,void 0,function(){var o,a,s,c,u,l;return T(this,function(d){switch(d.label){case 0:try{o=this.getTimestamps()}catch(f){(u=this.logger)===null||u===void 0||u.debug("an unexpected error occurred while retrieving timestamps",f)}d.label=1;case 1:return d.trys.push([1,3,,4]),[4,e(n,i)];case 2:return a=d.sent(),[3,4];case 3:return c=d.sent(),s=c,[3,4];case 4:try{this.handleNetworkRequestEvent("fetch",n,i?new es(i):void 0,a?new rs(a):void 0,s,o==null?void 0:o.startTime,o==null?void 0:o.durationStart)}catch(f){(l=this.logger)===null||l===void 0||l.debug("an unexpected error occurred while handling fetch",f)}if(a)return[2,a];throw s}})})})},t.createXhrJsonParser=function(e,r){return function(){var n,i;try{if(e.responseType==="json"){if(!((n=r.globalScope)===null||n===void 0)&&n.structuredClone)return r.globalScope.structuredClone(e.response)}else if(["text",""].includes(e.responseType))return JSON.parse(e.responseText)}catch(o){return o instanceof Error&&o.name==="InvalidStateError"&&((i=r.logger)===null||i===void 0||i.error("unexpected error when retrieving responseText. responseType='".concat(e.responseType,"'"))),null}return null}},t.prototype.observeXhr=function(e,r,n){if(!(!this.globalScope||!e||!r)){var i=this.globalScope.XMLHttpRequest.prototype,o=this;i.open=function(){for(var a,s,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var l=this,d=D(c,2),f=d[0],v=d[1];try{l.$$AmplitudeAnalyticsEvent=I({method:f,url:(a=v==null?void 0:v.toString)===null||a===void 0?void 0:a.call(v),headers:{}},o.getTimestamps())}catch(h){(s=o.logger)===null||s===void 0||s.error("an unexpected error occurred while calling xhr open",h)}return e.apply(l,c)},i.send=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c=this,u=c,l=t.createXhrJsonParser(c,o),d=a[0],f=u.$$AmplitudeAnalyticsEvent;return u.addEventListener("loadend",function(){var v;try{var h=u.getAllResponseHeaders(),p=u.getResponseHeader("content-length"),g=new ns(u.status,h,p?parseInt(p,10):void 0,l),m=u.$$AmplitudeAnalyticsEvent.headers,y=new ts(d,m);f.status=u.status,o.handleNetworkRequestEvent("xhr",{url:f.url,method:f.method},y,g,void 0,f.startTime,f.durationStart)}catch(b){(v=o.logger)===null||v===void 0||v.error("an unexpected error occurred while handling xhr send",b)}}),r.apply(u,a)},i.setRequestHeader=function(a,s){var c,u=this;try{u.$$AmplitudeAnalyticsEvent.headers[a]=s}catch(l){(c=o.logger)===null||c===void 0||c.error("an unexpected error occurred while calling xhr setRequestHeader",l)}n.apply(u,[a,s])}}},t}(),Qr=new ss,oi=function(){function t(){}return t.prototype.parse=function(){return S(this,void 0,void 0,function(){return T(this,function(e){return[2,I(I(I(I({},bt),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},t.prototype.getUtmParam=function(){var e=ht(),r=e[Ho],n=e[Bo],i=e[Go],o=e[Wo],a=e[Ko],s=e[$o];return{utm_campaign:r,utm_content:n,utm_id:i,utm_medium:o,utm_source:a,utm_term:s}},t.prototype.getReferrer=function(){var e,r,n={referrer:void 0,referring_domain:void 0};try{n.referrer=document.referrer||void 0,n.referring_domain=(r=(e=n.referrer)===null||e===void 0?void 0:e.split("/")[2])!==null&&r!==void 0?r:void 0}catch{}return n},t.prototype.getClickIds=function(){var e,r=ht();return e={},e[Lr]=r[Lr],e[Dr]=r[Dr],e[Nr]=r[Nr],e[xr]=r[xr],e[Mr]=r[Mr],e[Ur]=r[Ur],e[Fr]=r[Fr],e[jr]=r[jr],e[qr]=r[qr],e[Vr]=r[Vr],e[Hr]=r[Hr],e},t}(),Ke="data-amp-mask",Pe="*****",us=/\b(?:\d[ -]*?){13,16}\b/,cs=/(\d{3}-?\d{2}-?\d{4})/g,ls=/[^\s@]+@[^\s@.]+\.[^\s@]+/g,ai=function(t,e){var r,n;if(e===void 0&&(e=[]),typeof t!="string")return"";var i=t;i=i.replace(us,Pe),i=i.replace(cs,Pe),i=i.replace(ls,Pe);try{for(var o=F(e),a=o.next();!a.done;a=o.next()){var s=a.value;try{i=i.replace(s,Pe)}catch{}}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},si=function(t){if(typeof document>"u"||!document.title)return"";var e=document.querySelector("title");return e&&e.hasAttribute(Ke)?Pe:t?t(document.title):document.title},Qe=function(t,e){return typeof t=="boolean"?t:(t==null?void 0:t[e])!==!1},ui=function(t){return Qe(t,"attribution")},ds=function(t){return Qe(t,"fileDownloads")},fs=function(t){return Qe(t,"formInteractions")},ci=function(t){return Qe(t,"pageViews")},Zr=function(t){return Qe(t,"sessions")},li=function(t){return typeof t=="boolean"?t:typeof t=="object"&&(t.networkTracking===!0||typeof t.networkTracking=="object")},di=function(t){return typeof t=="boolean"?t:typeof t=="object"&&(t.elementInteractions===!0||typeof t.elementInteractions=="object")},vs=function(t){return typeof t=="object"&&t.webVitals===!0},fi=function(t){return typeof t=="boolean"?t:typeof t=="object"&&(t.frustrationInteractions===!0||typeof t.frustrationInteractions=="object")},hs=function(t){if(di(t.autocapture)&&typeof t.autocapture=="object"&&typeof t.autocapture.elementInteractions=="object")return t.autocapture.elementInteractions},ps=function(t){if(fi(t.autocapture)&&typeof t.autocapture=="object"&&typeof t.autocapture.frustrationInteractions=="object")return t.autocapture.frustrationInteractions},gs=function(t){var e;if(li(t.autocapture)){var r=void 0;return typeof t.autocapture=="object"&&typeof t.autocapture.networkTracking=="object"?r=t.autocapture.networkTracking:t.networkTrackingOptions&&(r=t.networkTrackingOptions),I(I({},r),{captureRules:(e=r==null?void 0:r.captureRules)===null||e===void 0?void 0:e.map(function(n){var i,o,a;if(!((i=n.urls)===null||i===void 0)&&i.length&&(!((o=n.hosts)===null||o===void 0)&&o.length)){var s=JSON.stringify(n.hosts),c=JSON.stringify(n.urls);return(a=t.loggerProvider)===null||a===void 0||a.warn("Found network capture rule with both urls='".concat(c,"' and hosts='").concat(s,"' set. ")+"Definition of urls takes precedence over hosts, so ignoring hosts."),I(I({},n),{hosts:void 0})}return n})})}},ms=function(t){var e=function(){return!1},r=void 0,n,i=t.pageCounter,o=ci(t.defaultTracking);return o&&(e=void 0,n=void 0,t.defaultTracking&&typeof t.defaultTracking=="object"&&t.defaultTracking.pageViews&&typeof t.defaultTracking.pageViews=="object"&&("trackOn"in t.defaultTracking.pageViews&&(e=t.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in t.defaultTracking.pageViews&&(r=t.defaultTracking.pageViews.trackHistoryChanges),"eventType"in t.defaultTracking.pageViews&&t.defaultTracking.pageViews.eventType&&(n=t.defaultTracking.pageViews.eventType))),{trackOn:e,trackHistoryChanges:r,eventType:n,pageCounter:i}},ys=function(t){return ui(t.defaultTracking)&&t.defaultTracking&&typeof t.defaultTracking=="object"&&t.defaultTracking.attribution&&typeof t.defaultTracking.attribution=="object"?I({},t.defaultTracking.attribution):{}},Ft=function(t,e){for(var r=0;r<e.length;r++){var n=e[r],i=n.name,o=n.args,a=n.resolve,s=t&&t[i];if(typeof s=="function"){var c=s.apply(t,o);typeof a=="function"&&a(c==null?void 0:c.promise)}}return t},jt=function(t){var e=t;return e&&e._q!==void 0},pr="2.26.2",vi="amplitude-ts",bs="Web",Es="$remote",Ts=function(){function t(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="".concat(vi,"/").concat(pr),typeof navigator<"u"&&(this.userAgent=navigator.userAgent)}return t.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},t.prototype.execute=function(e){var r,n;return S(this,void 0,void 0,function(){var i,o,a,s;return T(this,function(c){return i=new Date().getTime(),o=(r=this.config.lastEventId)!==null&&r!==void 0?r:-1,a=(n=e.event_id)!==null&&n!==void 0?n:o+1,this.config.lastEventId=a,e.time||(this.config.lastEventTime=i),s=I(I(I(I(I(I(I(I({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:i},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:bs}),this.config.trackingOptions.language&&{language:Sa()}),this.config.trackingOptions.ipAddress&&{ip:Es}),{insert_id:Ce(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:a,library:this.library,user_agent:this.userAgent}),[2,s]})})},t}(),ot=1e3,hi=function(t){Me(e,t);function e(r){var n=this,i,o,a;try{a=(i=$())===null||i===void 0?void 0:i.localStorage}catch(s){(o=r==null?void 0:r.loggerProvider)===null||o===void 0||o.debug("Failed to access localStorage. error=".concat(JSON.stringify(s))),a=void 0}return n=t.call(this,a)||this,n.loggerProvider=r==null?void 0:r.loggerProvider,n}return e.prototype.set=function(r,n){var i;return S(this,void 0,void 0,function(){var o;return T(this,function(a){switch(a.label){case 0:return Array.isArray(n)&&n.length>ot?(o=n.length-ot,[4,t.prototype.set.call(this,r,n.slice(0,ot))]):[3,2];case 1:return a.sent(),(i=this.loggerProvider)===null||i===void 0||i.error("Failed to save ".concat(o," events because the queue length exceeded ").concat(ot,".")),[3,4];case 2:return[4,t.prototype.set.call(this,r,n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},e}(Zn),Ss=function(t){Me(e,t);function e(){var r;return t.call(this,(r=$())===null||r===void 0?void 0:r.sessionStorage)||this}return e}(Zn),ws=function(t){Me(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state={done:4},r}return e.prototype.send=function(r,n){return S(this,void 0,void 0,function(){var i=this;return T(this,function(o){return[2,new Promise(function(a,s){typeof XMLHttpRequest>"u"&&s(new Error("XHRTransport is not supported."));var c=new XMLHttpRequest;c.open("POST",r,!0),c.onreadystatechange=function(){if(c.readyState===i.state.done){var u=c.responseText;try{a(i.buildResponse(JSON.parse(u)))}catch{a(i.buildResponse({code:c.status}))}}},c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Accept","*/*"),c.send(JSON.stringify(n))})]})})},e}(vr),_s=function(t){Me(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.send=function(r,n){return S(this,void 0,void 0,function(){var i=this;return T(this,function(o){return[2,new Promise(function(a,s){var c=$();if(!(c!=null&&c.navigator.sendBeacon))throw new Error("SendBeaconTransport is not supported");try{var u=JSON.stringify(n),l=c.navigator.sendBeacon(r,JSON.stringify(n));return a(l?i.buildResponse({code:200,events_ingested:n.events.length,payload_size_bytes:u.length,server_upload_time:Date.now()}):i.buildResponse({code:500}))}catch(d){s(d)}})]})})},e}(vr),Is=function(t,e,r){return r===void 0&&(r=!0),S(void 0,void 0,void 0,function(){var n,i,o,a,s,c,u,l,d;return T(this,function(f){switch(f.label){case 0:return n=Ta(t),[4,e.getRaw(n)];case 1:return i=f.sent(),i?r?[4,e.remove(n)]:[3,3]:[2,{optOut:!1}];case 2:f.sent(),f.label=3;case 3:return o=D(i.split("."),6),a=o[0],s=o[1],c=o[2],u=o[3],l=o[4],d=o[5],[2,{deviceId:a,userId:As(s),sessionId:qt(u),lastEventId:qt(d),lastEventTime:qt(l),optOut:!!c}]}})})},qt=function(t){var e=parseInt(t,32);if(!isNaN(e))return e},As=function(t){if(!(!atob||!escape||!t))try{return decodeURIComponent(escape(atob(t)))}catch{return}},ce="[Amplitude]",en="".concat(ce," Form Started"),ks="".concat(ce," Form Submitted"),Ps="".concat(ce," File Downloaded"),tn="session_start",rn="session_end",Rs="".concat(ce," File Extension"),Cs="".concat(ce," File Name"),Os="".concat(ce," Link ID"),Ls="".concat(ce," Link Text"),Ds="".concat(ce," Link URL"),Vt="".concat(ce," Form ID"),Ht="".concat(ce," Form Name"),Bt="".concat(ce," Form Destination"),pt="cookie",Ns="US",xs=function(t){Me(e,t);function e(r,n,i,o,a,s,c,u,l,d,f,v,h,p,g,m,y,b,w,E,_,C,k,L,A,R,x,z,W,j,X,se,ue,ae,le,de,ye,Y,Q){i===void 0&&(i=new fr),o===void 0&&(o={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),u===void 0&&(u=1e3),l===void 0&&(l=5),d===void 0&&(d=30),f===void 0&&(f=pt),m===void 0&&(m=new Xn),y===void 0&&(y=oe.Warn),w===void 0&&(w=!1),E===void 0&&(E=!1),k===void 0&&(k=""),L===void 0&&(L=Ns),R===void 0&&(R=30*60*1e3),x===void 0&&(x=new hi({loggerProvider:m})),z===void 0&&(z={ipAddress:!0,language:!0,platform:!0}),W===void 0&&(W="fetch"),j===void 0&&(j=!1),X===void 0&&(X=!0),ye===void 0&&(ye=!0),Y===void 0&&(Y=0);var O=t.call(this,{apiKey:r,storageProvider:x,transportProvider:pi(W)})||this;return O.apiKey=r,O.appVersion=n,O.cookieOptions=o,O.defaultTracking=a,O.autocapture=s,O.flushIntervalMillis=u,O.flushMaxRetries=l,O.flushQueueSize=d,O.identityStorage=f,O.ingestionMetadata=v,O.instanceName=h,O.loggerProvider=m,O.logLevel=y,O.minIdLength=b,O.offline=w,O.partnerId=_,O.plan=C,O.serverUrl=k,O.serverZone=L,O.sessionTimeout=R,O.storageProvider=x,O.trackingOptions=z,O.transport=W,O.useBatch=j,O.fetchRemoteConfig=X,O.networkTrackingOptions=le,O.identify=de,O.enableDiagnostics=ye,O.diagnosticsSampleRate=Y,O.diagnosticsClient=Q,O.version=pr,O._optOut=!1,O._cookieStorage=i,O.deviceId=c,O.lastEventId=p,O.lastEventTime=g,O.optOut=E,O.sessionId=A,O.pageCounter=ue,O.userId=se,O.debugLogsEnabled=ae,O.loggerProvider.enable(ae?oe.Debug:O.logLevel),O.networkTrackingOptions=le,O.identify=de,O.enableDiagnostics=ye,O.diagnosticsSampleRate=Y,O.diagnosticsClient=Q,O}return Object.defineProperty(e.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(r){this._cookieStorage!==r&&(this._cookieStorage=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceId",{get:function(){return this._deviceId},set:function(r){this._deviceId!==r&&(this._deviceId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},set:function(r){this._userId!==r&&(this._userId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId},set:function(r){this._sessionId!==r&&(this._sessionId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(r){this._optOut!==r&&(this._optOut=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(r){this._lastEventTime!==r&&(this._lastEventTime=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(r){this._lastEventId!==r&&(this._lastEventId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCounter",{get:function(){return this._pageCounter},set:function(r){this._pageCounter!==r&&(this._pageCounter=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugLogsEnabled",{set:function(r){this._debugLogsEnabled!==r&&(this._debugLogsEnabled=r,this.updateStorage())},enumerable:!1,configurable:!0}),e.prototype.updateStorage=function(){var r={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId,pageCounter:this._pageCounter,debugLogsEnabled:this._debugLogsEnabled};this.cookieStorage.set(Qn(this.apiKey),r)},e}(va),Ms=function(t,e,r){return e===void 0&&(e={}),S(void 0,void 0,void 0,function(){var n,i,o,a,s,c,u,l,d,f,v,h,p,g,m,y,b,w,E,_,C,k,L,A,R,x,z,W,j,X,se,ue,ae,le,de,ye,Y,Q,O,_t,It,At,kt,Pt,Rt;return T(this,function(Oe){switch(Oe.label){case 0:return n=e.identityStorage||pt,C={},n===pt?[3,1]:(o="",[3,5]);case 1:return(L=(k=e.cookieOptions)===null||k===void 0?void 0:k.domain)!==null&&L!==void 0?(a=L,[3,4]):[3,2];case 2:return[4,Fs()];case 3:a=Oe.sent(),Oe.label=4;case 4:o=a,Oe.label=5;case 5:return i=I.apply(void 0,[(C.domain=o,C.expiration=365,C.sameSite="Lax",C.secure=!1,C.upgrade=!0,C),e.cookieOptions]),s=Us(e.identityStorage,i),[4,Is(t,s,(R=(A=e.cookieOptions)===null||A===void 0?void 0:A.upgrade)!==null&&R!==void 0?R:!0)];case 6:return c=Oe.sent(),[4,s.get(Qn(t))];case 7:return u=Oe.sent(),l=ht(),d=l.ampTimestamp?Number(l.ampTimestamp):void 0,f=d?Date.now()<d:!0,v=(X=(j=(W=(x=e.deviceId)!==null&&x!==void 0?x:f?(z=l.ampDeviceId)!==null&&z!==void 0?z:l.deviceId:void 0)!==null&&W!==void 0?W:u==null?void 0:u.deviceId)!==null&&j!==void 0?j:c.deviceId)!==null&&X!==void 0?X:Ce(),h=(se=u==null?void 0:u.lastEventId)!==null&&se!==void 0?se:c.lastEventId,p=(ue=u==null?void 0:u.lastEventTime)!==null&&ue!==void 0?ue:c.lastEventTime,g=(le=(ae=e.optOut)!==null&&ae!==void 0?ae:u==null?void 0:u.optOut)!==null&&le!==void 0?le:c.optOut,m=(de=u==null?void 0:u.sessionId)!==null&&de!==void 0?de:c.sessionId,y=(Y=(ye=e.userId)!==null&&ye!==void 0?ye:u==null?void 0:u.userId)!==null&&Y!==void 0?Y:c.userId,r.previousSessionDeviceId=(Q=u==null?void 0:u.deviceId)!==null&&Q!==void 0?Q:c.deviceId,r.previousSessionUserId=(O=u==null?void 0:u.userId)!==null&&O!==void 0?O:c.userId,b={ipAddress:(It=(_t=e.trackingOptions)===null||_t===void 0?void 0:_t.ipAddress)!==null&&It!==void 0?It:!0,language:(kt=(At=e.trackingOptions)===null||At===void 0?void 0:At.language)!==null&&kt!==void 0?kt:!0,platform:(Rt=(Pt=e.trackingOptions)===null||Pt===void 0?void 0:Pt.platform)!==null&&Rt!==void 0?Rt:!0},w=u==null?void 0:u.pageCounter,E=u==null?void 0:u.debugLogsEnabled,e.autocapture!==void 0&&(e.defaultTracking=e.autocapture),_=new xs(t,e.appVersion,s,i,e.defaultTracking,e.autocapture,v,e.flushIntervalMillis,e.flushMaxRetries,e.flushQueueSize,n,e.ingestionMetadata,e.instanceName,h,p,e.loggerProvider,e.logLevel,e.minIdLength,e.offline,g,e.partnerId,e.plan,e.serverUrl,e.serverZone,m,e.sessionTimeout,e.storageProvider,b,e.transport,e.useBatch,e.fetchRemoteConfig,y,w,E,e.networkTrackingOptions,e.identify,e.enableDiagnostics),[4,_.storageProvider.isEnabled()];case 8:return Oe.sent()||(_.loggerProvider.warn("Storage provider ".concat(_.storageProvider.constructor.name," is not enabled. Falling back to MemoryStorage.")),_.storageProvider=new fr),[2,_]}})})},Us=function(t,e){switch(t===void 0&&(t=pt),e===void 0&&(e={}),t){case"localStorage":return new hi;case"sessionStorage":return new Ss;case"none":return new fr;case"cookie":default:return new Qt(I(I({},e),{expirationDays:e.expiration}))}},pi=function(t){return t==="xhr"?new ws:t==="beacon"?new _s:new Ma},Fs=function(t){return S(void 0,void 0,void 0,function(){var e,r,n,i,o,o,a,s,c,u;return T(this,function(l){switch(l.label){case 0:return[4,new Qt().isEnabled()];case 1:if(!l.sent()||typeof location>"u"||!location.hostname)return[2,""];for(e=location.hostname,r=e.split("."),n=[],i="AMP_TLDTEST",o=r.length-2;o>=0;--o)n.push(r.slice(o).join("."));o=0,l.label=2;case 2:return o<n.length?(a=n[o],s={domain:"."+a},c=new Qt(s),[4,c.set(i,1)]):[3,7];case 3:return l.sent(),[4,c.get(i)];case 4:return u=l.sent(),u?[4,c.remove(i)]:[3,6];case 5:return l.sent(),[2,"."+a];case 6:return o++,[3,2];case 7:return[2,""]}})})},js=function(t){var e={};for(var r in t){var n=t[r];n&&(e[r]=n)}return e},qs="[Amplitude] Page Viewed",Vs=function(t){t===void 0&&(t={});var e,r=$(),n=void 0,i=!1,o,a=t.trackOn,s=t.trackHistoryChanges,c=t.eventType,u=c===void 0?qs:c,l=function(m){var y=m;try{y=decodeURI(m)}catch(b){n==null||n.error("Malformed URI sequence: ",b)}return y},d=function(){return S(void 0,void 0,void 0,function(){var m,y,b;return T(this,function(w){switch(w.label){case 0:return m=l(typeof location<"u"&&location.href||""),b={event_type:u},y=[{}],[4,Hs()];case 1:return[2,(b.event_properties=I.apply(void 0,[I.apply(void 0,y.concat([w.sent()])),{"[Amplitude] Page Domain":typeof location<"u"&&location.hostname||"","[Amplitude] Page Location":m,"[Amplitude] Page Path":typeof location<"u"&&l(location.pathname)||"","[Amplitude] Page Title":si(ai),"[Amplitude] Page URL":m.split("?")[0]}]),b)]}})})},f=function(){return typeof a>"u"||typeof a=="function"&&a()},v=typeof location<"u"?location.href:null,h=function(){return S(void 0,void 0,void 0,function(){var m,y,b,w;return T(this,function(E){switch(E.label){case 0:return m=location.href,y=Gs(s,m,v||"")&&f(),v=m,y?(n==null||n.log("Tracking page view event"),e!=null?[3,1]:[3,3]):[3,4];case 1:return w=(b=e).track,[4,d()];case 2:w.apply(b,[E.sent()]),E.label=3;case 3:E.label=4;case 4:return[2]}})})},p=function(){h()},g={name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(m,y){return S(void 0,void 0,void 0,function(){var b,w;return T(this,function(E){switch(E.label){case 0:return e=y,o=m,n=m.loggerProvider,n.log("Installing @amplitude/plugin-page-view-tracking-browser"),i=!0,r&&(r.addEventListener("popstate",p),r.history.pushState=new Proxy(r.history.pushState,{apply:function(_,C,k){var L=D(k,3),A=L[0],R=L[1],x=L[2];_.apply(C,[A,R,x]),i&&h()}})),f()?(n.log("Tracking page view event"),w=(b=e).track,[4,d()]):[3,2];case 1:w.apply(b,[E.sent()]),E.label=2;case 2:return[2]}})})},execute:function(m){return S(void 0,void 0,void 0,function(){var y;return T(this,function(b){switch(b.label){case 0:return a==="attribution"&&Bs(m)?(n==null||n.log("Enriching campaign event to page view event with campaign parameters"),[4,d()]):[3,2];case 1:y=b.sent(),m.event_type=y.event_type,m.event_properties=I(I({},m.event_properties),y.event_properties),b.label=2;case 2:return o&&m.event_type===u&&(o.pageCounter=o.pageCounter?o.pageCounter+1:1,m.event_properties=I(I({},m.event_properties),{"[Amplitude] Page Counter":o.pageCounter})),[2,m]}})})},teardown:function(){return S(void 0,void 0,void 0,function(){return T(this,function(m){return r&&(r.removeEventListener("popstate",p),i=!1),[2]})})}};return g},Hs=function(){return S(void 0,void 0,void 0,function(){var t;return T(this,function(e){switch(e.label){case 0:return t=js,[4,new oi().parse()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},Bs=function(t){if(t.event_type==="$identify"&&t.user_properties){var e=t.user_properties,r=e[ke.SET]||{},n=e[ke.UNSET]||{},i=U(U([],D(Object.keys(r)),!1),D(Object.keys(n)),!1);return Object.keys(bt).every(function(o){return i.includes(o)})}return!1},Gs=function(t,e,r){switch(t){case"pathOnly":{if(r=="")return!0;var n=new URL(e),i=new URL(r),o=n.origin+n.pathname,a=i.origin+i.pathname;return o!==a}default:return e!==r}},Ws=function(){var t,e=[],r=function(u,l,d){u.addEventListener(l,d),e.push({element:u,type:l,handler:d})},n=function(){e.forEach(function(u){var l=u.element,d=u.type,f=u.handler;l==null||l.removeEventListener(d,f)}),e=[]},i="@amplitude/plugin-form-interaction-tracking-browser",o="enrichment",a=function(u,l){return S(void 0,void 0,void 0,function(){var d,f;return T(this,function(v){return d=function(){if(!l){u.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.");return}if(!(typeof document>"u")){var h=function(g){var m=!1;r(g,"change",function(){var y,b=nn(g);m||l.track(en,(y={},y[Vt]=Ue(g.id),y[Ht]=Ue(g.name),y[Bt]=b,y)),m=!0}),r(g,"submit",function(){var y,b,w=nn(g);m||l.track(en,(y={},y[Vt]=Ue(g.id),y[Ht]=Ue(g.name),y[Bt]=w,y)),l.track(ks,(b={},b[Vt]=Ue(g.id),b[Ht]=Ue(g.name),b[Bt]=w,b)),m=!1})},p=Array.from(document.getElementsByTagName("form"));p.forEach(h),typeof MutationObserver<"u"&&(t=new MutationObserver(function(g){g.forEach(function(m){m.addedNodes.forEach(function(y){y.nodeName==="FORM"&&h(y),"querySelectorAll"in y&&typeof y.querySelectorAll=="function"&&Array.from(y.querySelectorAll("form")).map(h)})})}),t.observe(document.body,{subtree:!0,childList:!0}))}},document.readyState==="complete"?d():(f=$(),f?f.addEventListener("load",d):u.loggerProvider.debug("Form interaction tracking is not installed because global is undefined.")),[2]})})},s=function(u){return S(void 0,void 0,void 0,function(){return T(this,function(l){return[2,u]})})},c=function(){return S(void 0,void 0,void 0,function(){return T(this,function(u){return t==null||t.disconnect(),n(),[2]})})};return{name:i,type:o,setup:a,execute:s,teardown:c}},Ue=function(t){if(typeof t=="string")return t},nn=function(t){var e=t.getAttribute("action");try{e=new URL(encodeURI(e??""),window.location.href).href}catch{}return e},Ks=function(){var t,e=[],r=function(u,l,d){u.addEventListener(l,d),e.push({element:u,type:l,handler:d})},n=function(){e.forEach(function(u){var l=u.element,d=u.type,f=u.handler;l==null||l.removeEventListener(d,f)}),e=[]},i="@amplitude/plugin-file-download-tracking-browser",o="enrichment",a=function(u,l){return S(void 0,void 0,void 0,function(){var d,f;return T(this,function(v){return d=function(){if(!l){u.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.");return}if(!(typeof document>"u")){var h=function(m){var y;try{y=new URL(m.href,window.location.href)}catch{return}var b=p.exec(y.href),w=b==null?void 0:b[1];w&&r(m,"click",function(){var E;w&&l.track(Ps,(E={},E[Rs]=w,E[Cs]=y.pathname,E[Os]=m.id,E[Ls]=m.text,E[Ds]=m.href,E))})},p=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)(\?.+)?$/,g=Array.from(document.getElementsByTagName("a"));g.forEach(h),typeof MutationObserver<"u"&&(t=new MutationObserver(function(m){m.forEach(function(y){y.addedNodes.forEach(function(b){b.nodeName==="A"&&h(b),"querySelectorAll"in b&&typeof b.querySelectorAll=="function"&&Array.from(b.querySelectorAll("a")).map(h)})})}),t.observe(document.body,{subtree:!0,childList:!0}))}},document.readyState==="complete"?d():(f=$(),f?f.addEventListener("load",d):u.loggerProvider.debug("File download tracking is not installed because global is undefined.")),[2]})})},s=function(u){return S(void 0,void 0,void 0,function(){return T(this,function(l){return[2,u]})})},c=function(){return S(void 0,void 0,void 0,function(){return T(this,function(u){return t==null||t.disconnect(),n(),[2]})})};return{name:i,type:o,setup:a,execute:s,teardown:c}},on=!1,$s=function(t){if(!(on||t.defaultTracking!==void 0)){var e=`\`options.defaultTracking\` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to \`options.defaultTracking\`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:

amplitude.init(<YOUR_API_KEY>, {
  defaultTracking: true,
});

Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.`;t.loggerProvider.warn(e),on=!0}},zs=function(){var t="@amplitude/plugin-network-checker-browser",e="before",r=$(),n=[],i=function(c,u){r!=null&&r.addEventListener&&(r==null||r.addEventListener(c,u),n.push({type:c,handler:u}))},o=function(){n.forEach(function(c){var u=c.type,l=c.handler;r==null||r.removeEventListener(u,l)}),n=[]},a=function(c,u){return S(void 0,void 0,void 0,function(){return T(this,function(l){return typeof navigator>"u"?(c.loggerProvider.debug("Network connectivity checker plugin is disabled because navigator is not available."),c.offline=!1,[2]):(c.offline=!navigator.onLine,i("online",function(){c.loggerProvider.debug("Network connectivity changed to online."),c.offline=!1,setTimeout(function(){u.flush()},c.flushIntervalMillis)}),i("offline",function(){c.loggerProvider.debug("Network connectivity changed to offline."),c.offline=!0}),[2])})})},s=function(){return S(void 0,void 0,void 0,function(){return T(this,function(c){return o(),[2]})})};return{name:t,type:e,setup:a,teardown:s}};function gi(t){var e,r,n,i,o,a,s,c,u,l,d;if(!(typeof t!="object"||t===null)&&!Array.isArray(t)){var f=Object.keys(t);try{for(var v=F(f),h=v.next();!h.done;h=v.next()){var p=h.value;try{var g=t[p];typeof(g==null?void 0:g.enabled)=="boolean"&&(g.enabled?(delete g.enabled,Object.keys(g).length===0&&(t[p]=!0)):t[p]=!1),gi(g)}catch{}}}catch(R){e={error:R}}finally{try{h&&!h.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}try{if(!((u=(c=(s=t.autocapture)===null||s===void 0?void 0:s.networkTracking)===null||c===void 0?void 0:c.captureRules)===null||u===void 0)&&u.length)try{for(var m=F(t.autocapture.networkTracking.captureRules),y=m.next();!y.done;y=m.next()){var b=y.value;try{for(var w=(o=void 0,F(["responseHeaders","requestHeaders"])),E=w.next();!E.done;E=w.next()){var _=E.value,C=(l=b[_])!==null&&l!==void 0?l:{},k=C.captureSafeHeaders,L=C.allowlist;if(!(!k&&!L)){if(L!==void 0&&!Array.isArray(L)){delete b[_];continue}b[_]=U(U([],D(k?vt:[]),!1),D(L??[]),!1)}}}catch(R){o={error:R}}finally{try{E&&!E.done&&(a=w.return)&&a.call(w)}finally{if(o)throw o.error}}}}catch(R){n={error:R}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}catch{}var A=(d=t.autocapture)===null||d===void 0?void 0:d.frustrationInteractions;A&&(A.rageClick&&(A.rageClicks=A.rageClick,delete A.rageClick),A.deadClick&&(A.deadClicks=A.deadClick,delete A.deadClick))}}function an(t,e,r){var n,i,o=[];try{for(var a=F(e??[]),s=a.next();!s.done;s=a.next()){var c=s.value;try{o.push(new RegExp(c))}catch(u){r.loggerProvider.warn("Invalid regex pattern: ".concat(c),u)}}}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return t.concat(o)}function Xs(t,e){var r,n,i,o,a,s,c;if(t){gi(t);try{e.loggerProvider.debug("Update browser config with remote configuration:",JSON.stringify(t));var u=t;if(u&&"autocapture"in u){if(typeof u.autocapture=="boolean"&&(e.autocapture=u.autocapture),typeof u.autocapture=="object"&&u.autocapture!==null){var l=I({},u.autocapture);if(e.autocapture===void 0&&(e.autocapture=u.autocapture),typeof u.autocapture.elementInteractions=="object"&&u.autocapture.elementInteractions!==null&&(!((i=u.autocapture.elementInteractions.pageUrlAllowlistRegex)===null||i===void 0)&&i.length)){l.elementInteractions=I({},u.autocapture.elementInteractions);var d=l.elementInteractions,f=(o=d.pageUrlAllowlist)!==null&&o!==void 0?o:[],v=u.autocapture.elementInteractions.pageUrlAllowlistRegex;d.pageUrlAllowlist=an(f,v,e),delete d.pageUrlAllowlistRegex}if(typeof u.autocapture.networkTracking=="object"&&u.autocapture.networkTracking!==null&&(!((a=u.autocapture.networkTracking.captureRules)===null||a===void 0)&&a.length)){l.networkTracking=I({},u.autocapture.networkTracking);var h=l.networkTracking,p=(s=h.captureRules)!==null&&s!==void 0?s:[];try{for(var g=F(p),m=g.next();!m.done;m=g.next()){var y=m.value;y.urls=an((c=y.urls)!==null&&c!==void 0?c:[],y.urlsRegex,e),delete y.urlsRegex}}catch(b){r={error:b}}finally{try{m&&!m.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}}typeof e.autocapture=="boolean"&&(e.autocapture=I({attribution:e.autocapture,fileDownloads:e.autocapture,formInteractions:e.autocapture,pageViews:e.autocapture,sessions:e.autocapture,elementInteractions:e.autocapture,webVitals:e.autocapture,frustrationInteractions:e.autocapture},l)),typeof e.autocapture=="object"&&(e.autocapture=I(I({},e.autocapture),l))}e.defaultTracking=e.autocapture}e.loggerProvider.debug("Browser config after remote config update:",JSON.stringify(e))}catch(b){e.loggerProvider.error("Failed to apply remote configuration because of error: ",b)}}}var Js="@amplitude/plugin-autocapture-browser",Ys="@amplitude/plugin-frustration-browser",er="[Amplitude] Element Clicked",Qs="[Amplitude] Dead Click",sn="[Amplitude] Rage Click",Zs="[Amplitude] Element Changed",eu="[Amplitude] Element ID",tu="[Amplitude] Element Class",un="[Amplitude] Element Tag",cn="[Amplitude] Element Text",ru="[Amplitude] Element Hierarchy",nu="[Amplitude] Element Href",iu="[Amplitude] Element Position Left",ou="[Amplitude] Element Position Top",au="[Amplitude] Element Aria Label",su="[Amplitude] Element Attributes",uu="[Amplitude] Element Parent Label",ln="[Amplitude] Page URL",cu="[Amplitude] Page Title",lu="[Amplitude] Viewport Height",du="[Amplitude] Viewport Width",ct="https://app.amplitude.com",fu="https://app.eu.amplitude.com",vu="https://apps.stag2.amplitude.com",hu={US:ct,EU:fu,STAGING:vu},pu="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",gu="amp-visual-tagging-selector-highlight",mi="data-amp-mask-attributes",mu=25,yu=Array.isArray;function bu(t){return t.length===1&&yu(t[0])?t[0]:t}function Eu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t=bu(t),t.length===1?sr(t[0]):new Ye(Tu(t))}function Tu(t){return function(e){for(var r=[],n=function(o){r.push(sr(t[o]).subscribe($t(e,function(a){if(r){for(var s=0;s<r.length;s++)s!==o&&r[s].unsubscribe();r=null}e.next(a)})))},i=0;r&&!e.closed&&i<t.length;i++)n(i)}}function Su(t,e){return Hi(function(r,n){var i=e??{},o=i.leading,a=o===void 0?!0:o,s=i.trailing,c=s===void 0?!1:s,u=!1,l=null,d=null,f=!1,v=function(){d==null||d.unsubscribe(),d=null,c&&(g(),f&&n.complete())},h=function(){d=null,f&&n.complete()},p=function(m){return d=sr(t(m)).subscribe($t(n,v,h))},g=function(){if(u){u=!1;var m=l;l=null,n.next(m),!f&&p(m)}};r.subscribe($t(n,function(m){u=!0,l=m,!(d&&!d.closed)&&(a?g():p(m))},function(){f=!0,!(c&&u&&d&&!d.closed)&&n.complete()}))})}function wu(t,e,r){e===void 0&&(e=Gi);var n=Bi(t,e);return Su(function(){return n},r)}var _u=["input","select","textarea"],yi=function(t,e){var r,n=(r=window==null?void 0:window.getComputedStyle)===null||r===void 0?void 0:r.call(window,t);return(n==null?void 0:n.getPropertyValue("cursor"))==="pointer"&&e==="click"},$e=function(t,e,r){return r===void 0&&(r=!1),function(n,i){var o,a,s=t.pageUrlAllowlist,c=t.pageUrlExcludelist,u=t.shouldTrackEventResolver,l=(a=(o=i==null?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase)===null||a===void 0?void 0:a.call(o);if(!l)return!1;if(u)return u(n,i);if(!Yt(window.location.href,s)||c&&c.length>0&&Yt(window.location.href,c))return!1;var d=String(i==null?void 0:i.getAttribute("type"))||"";if(typeof d=="string")switch(d.toLowerCase()){case"hidden":return!1;case"password":return!1}var f=yi(i,n);if(r&&f)return!0;if(e){var v=e.some(function(h){var p;return!!(!((p=i==null?void 0:i.matches)===null||p===void 0)&&p.call(i,h))});if(!v)return!1}switch(l){case"input":case"select":case"textarea":return n==="change"||n==="click";default:return f?!0:n==="click"}}},Iu=function(t){var e,r,n,i=(r=(e=t==null?void 0:t.tagName)===null||e===void 0?void 0:e.toLowerCase)===null||r===void 0?void 0:r.call(e),o=t instanceof HTMLElement?((n=t.getAttribute("contenteditable"))===null||n===void 0?void 0:n.toLowerCase())==="true":!1;return!_u.includes(i)&&!o},Au=function(t){return t?t.split(",").map(function(e){return e.trim()}).filter(function(e){return e.length>0&&e!=="id"&&e!=="class"}):[]},ku=function(t,e){return Object.entries(t).reduce(function(r,n){var i=D(n,2),o=i[0],a=i[1];if(o.startsWith(e)){var s=o.replace(e,"");s&&(r[s]=a||"")}return r},{})},Pu=function(t){return t==null||typeof t=="object"&&Object.keys(t).length===0||typeof t=="string"&&t.trim().length===0},dn=function(t){return Object.keys(t).reduce(function(e,r){var n=t[r];return Pu(n)||(e[r]=n),e},{})},gr=function(t,e){return t?e.some(function(r){var n;return(n=t==null?void 0:t.matches)===null||n===void 0?void 0:n.call(t,r)})?t:gr(t==null?void 0:t.parentElement,e):null},Ru=function(t){return new Promise(function(e,r){var n;try{var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.addEventListener("load",function(){e({status:!0})},{once:!0}),i.addEventListener("error",function(){r({status:!1,message:"Failed to load the script ".concat(t)})}),(n=document.head)===null||n===void 0||n.appendChild(i)}catch(o){r(o)}})};function Cu(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}var Ze=function(t){return!(t.event.target===null||!t.closestTrackedAncestor)};function Ou(t){return t.type==="click"||t.type==="change"}var Lu="1.15.2",Du=new Set(["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot",mi,Ke]),Nu=["type"],xu=["svg","path","g"],Mu=["password","hidden"],Uu=128;function Fu(t,e){var r,n,i,o,a,s;if(t===null)return null;var c=String(t.tagName).toLowerCase(),u={tag:c},l=Array.from((o=(i=t.parentElement)===null||i===void 0?void 0:i.children)!==null&&o!==void 0?o:[]);l.length&&(u.index=l.indexOf(t),u.indexOfType=l.filter(function(E){return E.tagName===t.tagName}).indexOf(t));var d=(s=(a=t.previousElementSibling)===null||a===void 0?void 0:a.tagName)===null||s===void 0?void 0:s.toLowerCase();d&&(u.prevSib=String(d));var f=t.getAttribute("id");f&&(u.id=String(f));var v=Array.from(t.classList);v.length&&(u.classes=v);var h={},p=Array.from(t.attributes),g=p.filter(function(E){return!Du.has(E.name)}),m=!Iu(t);if(!Mu.includes(String(t.getAttribute("type")))&&!xu.includes(c))try{for(var y=F(g),b=y.next();!b.done;b=y.next()){var w=b.value;if(!(m&&!Nu.includes(w.name))){if(e.has(w.name)){h[w.name]=Pe;continue}h[w.name]=String(w.value).substring(0,Uu)}}}catch(E){r={error:E}}finally{try{b&&!b.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}return Object.keys(h).length&&(u.attrs=h),u}function ju(t){var e=[];if(!t)return e;e.push(t);for(var r=t.parentElement;r&&r.tagName!=="HTML";)e.push(r),r=r.parentElement;return e}var qu=function(t,e){try{if(t.sourceType==="DOM_ELEMENT"){var r=document.documentElement;return t.scope&&e&&(r=e.closest(t.scope)),r&&t.selector?r.querySelector(t.selector):r}}catch{return}},Vu=function(t,e,r){t.forEach(function(n){if(typeof n!="string"&&n.actionType==="ATTACH_EVENT_PROPERTY"){var i=r.extractDataFromDataSource(n.dataSource,e.closestTrackedAncestor);e.targetElementProperties[n.destinationKey]=i}})},mr=function(){function t(e,r){var n,i,o=this,a;this.replaceSensitiveString=function(f){return ai(f,o.additionalMaskTextPatterns)},this.getHierarchy=function(f){var v,h,p,g,m=performance.now(),y=[];if(!f)return[];for(var b=ju(f),w=new Map,E=b.length-1;E>=0;E--){var _=b[E];if(_){var C=Au(_.getAttribute(mi)),k=E===b.length-1?[]:(p=w.get(b[E+1]))!==null&&p!==void 0?p:new Set,L=new Set(U(U([],D(k),!1),D(C),!1));w.set(_,L)}}y=b.map(function(j){var X;return Fu(j,(X=w.get(j))!==null&&X!==void 0?X:new Set)});var A=function(j){j!=null&&j.attrs&&Object.entries(j.attrs).forEach(function(X){var se=D(X,2),ue=se[0],ae=se[1];j.attrs&&(j.attrs[ue]=o.replaceSensitiveString(ae))})};try{for(var R=F(y),x=R.next();!x.done;x=R.next()){var z=x.value;A(z)}}catch(j){v={error:j}}finally{try{x&&!x.done&&(h=R.return)&&h.call(R)}finally{if(v)throw v.error}}var W=performance.now();return(g=o.diagnosticsClient)===null||g===void 0||g.recordHistogram("autocapturePlugin.getHierarchy",W-m),y},this.getNearestLabel=function(f){var v=f.parentElement;if(!v)return"";var h;try{h=v.querySelector(":scope>span,h1,h2,h3,h4,h5,h6")}catch{h=null}return h?o.getText(h):o.getNearestLabel(v)},this.getEventProperties=function(f,v,h){var p,g,m,y,b=(m=(g=v==null?void 0:v.tagName)===null||g===void 0?void 0:g.toLowerCase)===null||m===void 0?void 0:m.call(g),w=typeof v.getBoundingClientRect=="function"?v.getBoundingClientRect():{left:null,top:null},E=o.getHierarchy(v),_=(y=E[0])===null||y===void 0?void 0:y.attrs,C=o.getNearestLabel(v),k=ku(_??{},h),L=(p={},p[ru]=E,p[un]=b,p[cn]=o.getText(v),p[iu]=w.left==null?null:Math.round(w.left),p[ou]=w.top==null?null:Math.round(w.top),p[su]=k,p[uu]=C,p[ln]=Ia(window.location.href.split("?")[0]),p[cu]=si(o.replaceSensitiveString),p[lu]=window.innerHeight,p[du]=window.innerWidth,p);return L[eu]=v.getAttribute("id")||"",L[tu]=v.getAttribute("class"),L[au]=_==null?void 0:_["aria-label"],b==="a"&&f==="click"&&v instanceof HTMLAnchorElement&&(L[nu]=o.replaceSensitiveString(v.href)),dn(L)},this.addAdditionalEventProperties=function(f,v,h,p,g){g===void 0&&(g=!1);var m={event:f,timestamp:Date.now(),type:v};if(Ou(m)&&m.event.target!==null){if(g){var y=yi(m.event.target,m.type);if(y)return m.closestTrackedAncestor=m.event.target,m.targetElementProperties=o.getEventProperties(m.type,m.closestTrackedAncestor,p),m}var b=gr(m.event.target,h);return b&&(m.closestTrackedAncestor=b,m.targetElementProperties=o.getEventProperties(m.type,b,p)),m}return m},this.extractDataFromDataSource=function(f,v){if(f.sourceType==="DOM_ELEMENT"){var h=qu(f,v);return h?f.elementExtractType==="TEXT"?o.getText(h):f.elementExtractType==="ATTRIBUTE"&&f.attribute?h.getAttribute(f.attribute):void 0:void 0}},this.getText=function(f){var v=f.closest("[".concat(Ke,"]"))!==null;if(v)return Pe;var h="";if(!f.querySelector("[".concat(Ke,"], [contenteditable]")))h=f.innerText||"";else{var p=f.cloneNode(!0);p.querySelectorAll("[".concat(Ke,"], [contenteditable]")).forEach(function(g){g.innerText=Pe}),h=p.innerText||""}return o.replaceSensitiveString(h.substring(0,255)).replace(/\s+/g," ").trim()},this.getEventTagProps=function(f){var v,h,p;if(!f)return{};var g=(p=(h=f==null?void 0:f.tagName)===null||h===void 0?void 0:h.toLowerCase)===null||p===void 0?void 0:p.call(h),m=(v={},v[un]=g,v[cn]=o.getText(f),v[ln]=window.location.href.split("?")[0],v);return dn(m)},this.diagnosticsClient=r==null?void 0:r.diagnosticsClient;var s=(a=e.maskTextRegex)!==null&&a!==void 0?a:[],c=[];try{for(var u=F(s),l=u.next();!l.done;l=u.next()){var d=l.value;if(c.length>=mu)break;if(d instanceof RegExp)c.push(d);else if("pattern"in d&&typeof d.pattern=="string")try{c.push(new RegExp(d.pattern,"i"))}catch{}}}catch(f){n={error:f}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}this.additionalMaskTextPatterns=c}return t}(),Hu=function(){function t(e){var r=e===void 0?{}:e,n=r.origin,i=n===void 0?ct:n,o=this;this.endpoint=ct,this.requestCallbacks={},this.onSelect=function(a){o.notify({action:"element-selected",data:a})},this.onTrack=function(a,s){a==="selector-mode-changed"?o.notify({action:"track-selector-mode-changed",data:s}):a==="selector-moved"&&o.notify({action:"track-selector-moved",data:s})},this.endpoint=i}return t.prototype.notify=function(e){var r,n,i,o;(n=(r=this.logger)===null||r===void 0?void 0:r.debug)===null||n===void 0||n.call(r,"Message sent: ",JSON.stringify(e)),(o=(i=window.opener)===null||i===void 0?void 0:i.postMessage)===null||o===void 0||o.call(i,e,this.endpoint)},t.prototype.sendRequest=function(e,r,n){var i=this;n===void 0&&(n={timeout:15e3});var o=Cu(),a={id:o,action:e,args:r},s=new Promise(function(c,u){i.requestCallbacks[o]={resolve:c,reject:u},i.notify(a),(n==null?void 0:n.timeout)>0&&setTimeout(function(){u(new Error("".concat(e," timed out (id: ").concat(o,")"))),delete i.requestCallbacks[o]},n.timeout)});return s},t.prototype.handleResponse=function(e){var r;if(!this.requestCallbacks[e.id]){(r=this.logger)===null||r===void 0||r.warn("No callback found for request id: ".concat(e.id));return}this.requestCallbacks[e.id].resolve(e.responseData),delete this.requestCallbacks[e.id]},t.prototype.setup=function(e){var r=this,n=e===void 0?{dataExtractor:new mr({})}:e,i=n.logger,o=n.endpoint,a=n.isElementSelectable,s=n.cssSelectorAllowlist,c=n.actionClickAllowlist,u=n.dataExtractor;this.logger=i,o&&this.endpoint===ct&&(this.endpoint=o);var l=null;window.addEventListener("message",function(d){var f,v,h,p,g;if((v=(f=r.logger)===null||f===void 0?void 0:f.debug)===null||v===void 0||v.call(f,"Message received: ",JSON.stringify(d)),r.endpoint===d.origin){var m=d==null?void 0:d.data,y=m==null?void 0:m.action;if(y)if("id"in m)(p=(h=r.logger)===null||h===void 0?void 0:h.debug)===null||p===void 0||p.call(h,"Received Response to previous request: ",JSON.stringify(d)),r.handleResponse(m);else if(y==="ping")r.notify({action:"pong"});else if(y==="initialize-visual-tagging-selector"){var b=m==null?void 0:m.data;Ru(pu).then(function(){var w;l=(w=window==null?void 0:window.amplitudeVisualTaggingSelector)===null||w===void 0?void 0:w.call(window,{getEventTagProps:u.getEventTagProps,isElementSelectable:function(E){return a?a((b==null?void 0:b.actionType)||"click",E):!0},onTrack:r.onTrack,onSelect:r.onSelect,visualHighlightClass:gu,messenger:r,cssSelectorAllowlist:s,actionClickAllowlist:c,extractDataFromDataSource:u.extractDataFromDataSource,dataExtractor:u,diagnostics:{autocapture:{version:Lu}}}),r.notify({action:"selector-loaded"})}).catch(function(){var w;(w=r.logger)===null||w===void 0||w.warn("Failed to initialize visual tagging selector")})}else y==="close-visual-tagging-selector"&&((g=l==null?void 0:l.close)===null||g===void 0||g.call(l))}}),this.notify({action:"page-loaded"})},t}(),Bu=5;function Gu(t){var e=t.amplitude,r=t.allObservables,n=t.options,i=t.shouldTrackEvent,o=t.evaluateTriggers,a=r.clickObservable,s=a.pipe(Wi(),Z(function(d){var f=D(d,2),v=f[0],h=f[1],p=v.event.target!==h.event.target,g=Math.abs(h.event.screenX-v.event.screenX)<=20&&Math.abs(h.event.screenY-v.event.screenY)<=20;return p&&!g})),c=a.pipe(Ki(n.debounceTime),ne(function(){return"timeout"})),u=ur(s,c),l=a.pipe($i(0),Z(Ze),Z(function(d){return i("click",d.closestTrackedAncestor)}),ne(function(d){return o(d)}),zi(u));return l.subscribe(function(d){var f,v,h=(d.length>=Bu,er);try{for(var p=F(d),g=p.next();!g.done;g=p.next()){var m=g.value;e==null||e.track(h,m.targetElementProperties)}}catch(y){f={error:y}}finally{try{g&&!g.done&&(v=p.return)&&v.call(p)}finally{if(f)throw f.error}}})}function Wu(t){var e=t.amplitude,r=t.allObservables,n=t.getEventProperties,i=t.shouldTrackEvent,o=t.evaluateTriggers,a=r.changeObservable,s=a.pipe(Z(Ze),Z(function(c){return i("change",c.closestTrackedAncestor)}),ne(function(c){return o(c)}));return s.subscribe(function(c){e==null||e.track(Zs,n("change",c.closestTrackedAncestor))})}function Ku(t){var e=t.amplitude,r=t.allObservables,n=t.options,i=t.getEventProperties,o=t.shouldTrackEvent,a=t.shouldTrackActionClick,s=r.clickObservable,c=r.mutationObservable,u=r.navigateObservable,l=s.pipe(Z(function(h){return!o("click",h.closestTrackedAncestor)}),ne(function(h){var p=gr(h.event.target,n.actionClickAllowlist);return h.closestTrackedAncestor=p,h.closestTrackedAncestor!==null&&(h.targetElementProperties=i(h.type,h.closestTrackedAncestor)),h}),Z(Ze),Z(function(h){return a("click",h.closestTrackedAncestor)})),d=[c];u&&d.push(u);var f=ur.apply(void 0,U([],D(d),!1)),v=l.pipe(Xi(function(h){return f.pipe(Un(1),Ji({first:500,with:function(){return Yi}}),ne(function(){return h}))}));return v.subscribe(function(h){e==null||e.track(er,i("click",h.closestTrackedAncestor))})}var bi=function(){return new Ye(function(t){var e=new MutationObserver(function(r){t.next(r)});return e.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return e.disconnect()}})},Ei=function(t){return t===void 0&&(t="click"),ft(document,t,{capture:!0})},$u=function(t,e){try{if(e.subprop_key==="[Amplitude] Element Text")return e.subprop_op==="is"&&e.subprop_value.includes(t.targetElementProperties["[Amplitude] Element Text"]);if(e.subprop_key==="[Amplitude] Element Hierarchy")return e.subprop_op==="autotrack css match"&&!!t.closestTrackedAncestor.closest(e.subprop_value.toString())}catch(r){return console.error("Error matching event to filter",r),!1}return!1},tr={"[Amplitude] Element Clicked":"click","[Amplitude] Element Changed":"change"},fn=function(t){var e,r,n,i,o=Object.values(tr).reduce(function(v,h){return v[h]=new Set,v},{});if(!t)return o;try{for(var a=F(t),s=a.next();!s.done;s=a.next()){var c=s.value;try{try{for(var u=(n=void 0,F(c.definition)),l=u.next();!l.done;l=u.next()){var d=l.value,f=tr[d.event_type];f&&o[f].add(c.id)}}catch(v){n={error:v}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}catch(v){console.warn("Skipping Labeled Event due to malformed definition",c==null?void 0:c.id,v)}}}catch(v){e={error:v}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return o},vn=function(t){var e,r,n,i,o=new Map;try{for(var a=F(t),s=a.next();!s.done;s=a.next()){var c=s.value;try{for(var u=(n=void 0,F(c.conditions)),l=u.next();!l.done;l=u.next()){var d=l.value;if(d.type==="LABELED_EVENT"){var f=d.match.eventId,v=o.get(f);v||(v=[],o.set(f,v)),v.push(c)}}}catch(h){n={error:h}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(h){e={error:h}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return o},zu=function(t,e){return e.filter(function(r){return r.definition.some(function(n){return tr[n.event_type]===t.type&&n.filters.every(function(i){return $u(t,i)})})})},Xu=function(t,e){var r,n,i,o,a=new Set;try{for(var s=F(t),c=s.next();!c.done;c=s.next()){var u=c.value,l=e.get(u.id);if(l)try{for(var d=(i=void 0,F(l)),f=d.next();!f.done;f=d.next()){var v=f.value;a.add(v)}}catch(h){i={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return Array.from(a)},Ju=function(){function t(e,r,n,i){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=r,this.dataExtractor=n,this.options=i}return t.prototype.evaluate=function(e){var r,n,i=this.options.pageActions;if(!i)return e;var o=zu(e,Array.from(this.groupedLabeledEvents[e.type]).map(function(l){return i.labeledEvents[l]})),a=Xu(o,this.labeledEventToTriggerMap);try{for(var s=F(a),c=s.next();!c.done;c=s.next()){var u=c.value;Vu(u.actions,e,this.dataExtractor)}}catch(l){r={error:l}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return e},t.prototype.update=function(e,r,n){this.groupedLabeledEvents=e,this.labeledEventToTriggerMap=r,this.options=n},t}(),Yu=function(t,e,r,n){return new Ju(t,e,r,n)},pe;(function(t){t.ClickObservable="clickObservable",t.ChangeObservable="changeObservable",t.NavigateObservable="navigateObservable",t.MutationObservable="mutationObservable"})(pe||(pe={}));var Qu=function(t,e){var r,n,i,o,a,s,c,u;t===void 0&&(t={});var l=t.dataAttributePrefix,d=l===void 0?ei:l,f=t.visualTaggingOptions,v=f===void 0?{enabled:!0,messenger:new Hu}:f;t.cssSelectorAllowlist=(r=t.cssSelectorAllowlist)!==null&&r!==void 0?r:Ga,t.actionClickAllowlist=(n=t.actionClickAllowlist)!==null&&n!==void 0?n:Wa,t.debounceTime=(i=t.debounceTime)!==null&&i!==void 0?i:0,t.pageUrlExcludelist=(o=t.pageUrlExcludelist)===null||o===void 0?void 0:o.reduce(function(A,R){if(typeof R=="string"&&A.push(R),R instanceof RegExp&&A.push(R),typeof R=="object"&&R!==null&&"pattern"in R)try{A.push(new RegExp(R.pattern))}catch(x){return console.warn("Invalid regex pattern: ".concat(R.pattern),x),A}return A},[]);var h=Js,p="enrichment",g=[],m=new mr(t,e),y=function(){var A,R=Ei().pipe(ne(function(j){return m.addAdditionalEventProperties(j,"click",t.cssSelectorAllowlist,d)}),Le()),x=ft(document,"change",{capture:!0}).pipe(ne(function(j){return m.addAdditionalEventProperties(j,"change",t.cssSelectorAllowlist,d)}),Le()),z;window.navigation&&(z=ft(window.navigation,"navigate").pipe(ne(function(j){return m.addAdditionalEventProperties(j,"navigate",t.cssSelectorAllowlist,d)}),Le()));var W=bi().pipe(ne(function(j){return m.addAdditionalEventProperties(j,"mutation",t.cssSelectorAllowlist,d)}),Le());return A={},A[pe.ClickObservable]=R,A[pe.ChangeObservable]=x,A[pe.NavigateObservable]=z,A[pe.MutationObservable]=W,A},b=fn(Object.values((s=(a=t.pageActions)===null||a===void 0?void 0:a.labeledEvents)!==null&&s!==void 0?s:{})),w=vn((u=(c=t.pageActions)===null||c===void 0?void 0:c.triggers)!==null&&u!==void 0?u:[]),E=Yu(b,w,m,t),_=function(A){var R,x;A&&(t.pageActions=I(I({},t.pageActions),A),b=fn(Object.values((R=t.pageActions.labeledEvents)!==null&&R!==void 0?R:{})),w=vn((x=t.pageActions.triggers)!==null&&x!==void 0?x:[]),E.update(b,w,t))},C=function(A,R){return S(void 0,void 0,void 0,function(){var x,z,W,j,X,se,ue,ae,le,de;return T(this,function(ye){return typeof document>"u"?[2]:(A.fetchRemoteConfig&&(A.remoteConfigClient?A.remoteConfigClient.subscribe("analyticsSDK.pageActions","all",function(Y){_(Y)}):A.loggerProvider.debug("Remote config client is not provided, skipping remote config fetch")),x=$e(t,t.cssSelectorAllowlist),z=$e(t,t.actionClickAllowlist),W=y(),j=Gu({allObservables:W,options:t,amplitude:R,shouldTrackEvent:x,evaluateTriggers:E.evaluate.bind(E)}),g.push(j),X=Wu({allObservables:W,getEventProperties:function(){for(var Y=[],Q=0;Q<arguments.length;Q++)Y[Q]=arguments[Q];return m.getEventProperties.apply(m,U(U([],D(Y),!1),[d],!1))},amplitude:R,shouldTrackEvent:x,evaluateTriggers:E.evaluate.bind(E)}),g.push(X),se=Ku({allObservables:W,options:t,getEventProperties:function(){for(var Y=[],Q=0;Q<arguments.length;Q++)Y[Q]=arguments[Q];return m.getEventProperties.apply(m,U(U([],D(Y),!1),[d],!1))},amplitude:R,shouldTrackEvent:x,shouldTrackActionClick:z}),g.push(se),(le=A==null?void 0:A.loggerProvider)===null||le===void 0||le.log("".concat(h," has been successfully added.")),window.opener&&v.enabled&&(ue=t.cssSelectorAllowlist,ae=t.actionClickAllowlist,(de=v.messenger)===null||de===void 0||de.setup(I(I({dataExtractor:m,logger:A==null?void 0:A.loggerProvider},(A==null?void 0:A.serverZone)&&{endpoint:hu[A.serverZone]}),{isElementSelectable:$e(t,U(U([],D(ue),!1),D(ae),!1)),cssSelectorAllowlist:ue,actionClickAllowlist:ae}))),[2])})})},k=function(A){return S(void 0,void 0,void 0,function(){return T(this,function(R){return[2,A]})})},L=function(){return S(void 0,void 0,void 0,function(){var A,R,x,z,W;return T(this,function(j){try{for(A=F(g),R=A.next();!R.done;R=A.next())x=R.value,x.unsubscribe()}catch(X){z={error:X}}finally{try{R&&!R.done&&(W=A.return)&&W.call(A)}finally{if(z)throw z.error}}return[2]})})};return{name:h,type:p,setup:C,execute:k,teardown:L}},hn=3e3;function Zu(t){var e=t.amplitude,r=t.allObservables,n=t.getEventProperties,i=t.shouldTrackDeadClick,o=r.clickObservable,a=r.mutationObservable,s=r.navigateObservable,c=o.pipe(Z(Ze),Z(function(f){return i("click",f.closestTrackedAncestor)}),Z(function(f){var v=f.event.target;return v.closest('a[target="_blank"]')===null})),u=[a];s&&u.push(s);var l=ur.apply(void 0,U([],D(u),!1)),d=c.pipe(Qi(function(f){var v,h=new Ye(function(p){return v=setTimeout(function(){return p.next(f)},hn),function(){clearTimeout(v)}});return Eu(h,l.pipe(Un(1),ne(function(){return null}))).pipe(Z(function(p){return p!==null}))}),wu(hn));return d.subscribe(function(f){var v={"[Amplitude] X":f.event.clientX,"[Amplitude] Y":f.event.clientY};e.track(Qs,I(I({},n("click",f.closestTrackedAncestor)),v),{time:f.timestamp})})}var rr=Ja,Ti=Xa,pn=Ya;function gn(t,e){var r,n,i,o,a=e.event,s=a.clientX,c=a.clientY;t.yMin=Math.min((r=t.yMin)!==null&&r!==void 0?r:c,c),t.yMax=Math.max((n=t.yMax)!==null&&n!==void 0?n:c,c),t.xMin=Math.min((i=t.xMin)!==null&&i!==void 0?i:s,s),t.xMax=Math.max((o=t.xMax)!==null&&o!==void 0?o:s,s),t.isOutOfBounds=t.yMax-t.yMin>pn||t.xMax-t.xMin>pn}function mn(t){var e=t[0],r=t[t.length-1],n=I({"[Amplitude] Begin Time":new Date(e.timestamp).toISOString(),"[Amplitude] End Time":new Date(r.timestamp).toISOString(),"[Amplitude] Duration":r.timestamp-e.timestamp,"[Amplitude] Clicks":t.map(function(i){return{X:i.event.clientX,Y:i.event.clientY,Time:i.timestamp}}),"[Amplitude] Click Count":t.length},e.targetElementProperties);return{rageClickEvent:n,time:e.timestamp}}function ec(t,e){var r=Math.max(0,t.length-rr+1),n=t[r];return e.timestamp-n.timestamp>=Ti}function tc(t,e){return t.length>0&&t[t.length-1].closestTrackedAncestor!==e.closestTrackedAncestor}function rc(t){var e=t.amplitude,r=t.allObservables,n=t.shouldTrackRageClick,i=r.clickObservable,o=[],a={},s;function c(u){o=[],a={},u&&(gn(a,u),o.push(u))}return i.pipe(Z(Ze),Z(function(u){return n("click",u.closestTrackedAncestor)}),ne(function(u){if(s&&clearTimeout(s),gn(a,u),o.length===0)return o.push(u),null;if(tc(o,u)||ec(o,u)||a.isOutOfBounds){var l=o.length>=rr?mn(o):null;return c(u),l}return o.push(u),o.length>=rr&&(s=setTimeout(function(){var d=mn(o),f=d.rageClickEvent,v=d.time;e.track(sn,f,{time:v}),c()},Ti)),null}),Z(function(u){return u!==null})).subscribe(function(u){u!==null&&e.track(sn,u.rageClickEvent,{time:u.time})})}var nc=function(t){var e,r,n,i,o;t===void 0&&(t={});var a=Ys,s="enrichment",c=[],u=(r=(e=t.rageClicks)===null||e===void 0?void 0:e.cssSelectorAllowlist)!==null&&r!==void 0?r:za,l=(i=(n=t.deadClicks)===null||n===void 0?void 0:n.cssSelectorAllowlist)!==null&&i!==void 0?i:$a,d=(o=t.dataAttributePrefix)!==null&&o!==void 0?o:ei,f=new mr(t),v=U([],D(new Set(U(U([],D(u),!1),D(l),!1))),!1),h=function(){var y,b=Ei("pointerdown").pipe(ne(function(_){return f.addAdditionalEventProperties(_,"click",v,d,!0)}),Le()),w;window.navigation&&(w=ft(window.navigation,"navigate").pipe(ne(function(_){return f.addAdditionalEventProperties(_,"navigate",v,d)}),Le()));var E=bi().pipe(ne(function(_){return f.addAdditionalEventProperties(_,"mutation",v,d)}),Le());return y={},y[pe.ClickObservable]=b,y[pe.ChangeObservable]=new Ye,y[pe.NavigateObservable]=w,y[pe.MutationObservable]=E,y},p=function(y,b){return S(void 0,void 0,void 0,function(){var w,E,_,C,k,L;return T(this,function(A){return typeof document>"u"?[2]:(w=$e(t,u),E=$e(t,l),_=h(),C=rc({allObservables:_,amplitude:b,shouldTrackRageClick:w}),c.push(C),k=Zu({amplitude:b,allObservables:_,getEventProperties:function(R,x){return f.getEventProperties(R,x,d)},shouldTrackDeadClick:E}),c.push(k),(L=y==null?void 0:y.loggerProvider)===null||L===void 0||L.log("".concat(a," has been successfully added.")),[2])})})},g=function(y){return S(void 0,void 0,void 0,function(){return T(this,function(b){return[2,y]})})},m=function(){return S(void 0,void 0,void 0,function(){var y,b,w,E,_;return T(this,function(C){try{for(y=F(c),b=y.next();!b.done;b=y.next())w=b.value,w.unsubscribe()}catch(k){E={error:k}}finally{try{b&&!b.done&&(_=y.return)&&_.call(y)}finally{if(E)throw E.error}}return[2]})})};return{name:a,type:s,setup:p,execute:g,teardown:m}},ic="@amplitude/plugin-network-capture-browser",Si="[Amplitude] Network Request",wi="500-599";function lt(t,e){var r=e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&"),n="^"+r.replace(/\*/g,".*")+"$",i=new RegExp(n);return i.test(t)}function _i(t,e){var r,n,i=e.split(",");try{for(var o=F(i),a=o.next();!a.done;a=o.next()){var s=a.value,c=D(s.split("-").map(Number),2),u=c[0],l=c[1];if(t===u&&l===void 0||t>=u&&t<=l)return!0}}catch(d){r={error:d}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}function oc(t,e,r,n,i){if(!(t.hosts&&!t.hosts.find(function(a){return lt(e,a)}))&&!(n&&t.urls&&!Yt(n,t.urls))&&!(i&&t.methods&&!t.methods.find(function(a){return i.toLowerCase()===a.toLowerCase()||a==="*"}))){if(r||r===0){var o=t.statusCodeRange||wi;if(!_i(r,o))return!1}return!0}}function Ii(t){var e;if(t)try{var r=(e=$())===null||e===void 0?void 0:e.location.href,n=new URL(t,r),i=n.searchParams.toString(),o=n.hash.replace("#",""),a=n.href,s=n.host;n.hash="",n.search="";var c=n.href;return{query:i,fragment:o,href:a,hrefWithoutQueryOrHash:c,host:s}}catch{return}}function ac(t,e){if(t.includes("amplitude.com"))try{var r=e.body;if(typeof r!="string")return!1;var n=JSON.parse(r),i=n.events;if(i.find(function(o){return o.event_type===Si}))return!0}catch{}return!1}function yn(t){if(typeof t!="object"||t===null){if(t)return U([],D(vt),!1);if(t===void 0){var e=void 0;return e}return}if(t.length!==0)return t}function bn(t){var e,r;return!(!((e=t==null?void 0:t.allowlist)===null||e===void 0)&&e.length)&&!(!((r=t==null?void 0:t.blocklist)===null||r===void 0)&&r.length)}function sc(t,e){var r;e===void 0&&(e={});var n=Ii(t.url);if(!n)return!1;var i=n.host;if(e.ignoreAmplitudeRequests!==!1&&(lt(i,"*.amplitude.com")||lt(i,"amplitude.com"))||!((r=e.ignoreHosts)===null||r===void 0)&&r.find(function(a){return lt(i,a)})||!e.captureRules&&t.status!==void 0&&!_i(t.status,wi))return!1;if(e.captureRules){var o;if(U([],D(e.captureRules),!1).reverse().find(function(a){if(o=oc(a,i,t.status,t.url,t.method),o){var s=yn(a.responseHeaders);if(t.responseWrapper&&s){var c=t.responseWrapper.headers(s);c&&(t.responseHeaders=c)}var u=yn(a.requestHeaders);if(t.requestWrapper&&u){var l=t.requestWrapper.headers(u);l&&(t.requestHeaders=l)}t.responseWrapper&&a.responseBody&&!bn(a.responseBody)&&(t.responseBodyJson=t.responseWrapper.json(a.responseBody.allowlist,a.responseBody.blocklist)),t.requestWrapper&&a.requestBody&&!bn(a.requestBody)&&(t.requestBodyJson=t.requestWrapper.json(a.requestBody.allowlist,a.requestBody.blocklist))}return o!==void 0}),!o)return!1}return!(t.requestWrapper&&ac(i,t.requestWrapper))}function uc(t,e,r,n){return S(this,void 0,void 0,function(){var i,o,a;return T(this,function(s){switch(s.label){case 0:return e.requestBodyJson||e.responseBodyJson?[4,Promise.all([e.requestBodyJson,e.responseBodyJson])]:[3,2];case 1:if(i=D.apply(void 0,[s.sent(),2]),o=i[0],a=i[1],o)try{t["[Amplitude] Request Body"]=JSON.stringify(o)}catch(c){n==null||n.debug("Failed to stringify request body",c)}if(a)try{t["[Amplitude] Response Body"]=JSON.stringify(a)}catch{n==null||n.debug("Failed to stringify response body")}s.label=2;case 2:return r==null||r.track(Si,t),[2]}})})}function cc(t){var e=t.allObservables,r=t.networkTrackingOptions,n=t.amplitude,i=t.loggerProvider,o=e.networkObservable,a=o.pipe(Z(function(s){return sc(s.event,r)}));return a.subscribe(function(s){var c,u,l,d=s.event,f=Ii(d.url);if(f){var v=(u=d.responseWrapper)===null||u===void 0?void 0:u.bodySize,h=(l=d.requestWrapper)===null||l===void 0?void 0:l.bodySize,p=(c={},c["[Amplitude] URL"]=f.hrefWithoutQueryOrHash,c["[Amplitude] URL Query"]=f.query,c["[Amplitude] URL Fragment"]=f.fragment,c["[Amplitude] Request Method"]=d.method,c["[Amplitude] Status Code"]=d.status,c["[Amplitude] Start Time"]=d.startTime,c["[Amplitude] Completion Time"]=d.endTime,c["[Amplitude] Duration"]=d.duration,c["[Amplitude] Request Body Size"]=h,c["[Amplitude] Response Body Size"]=v,c["[Amplitude] Request Type"]=d.type,c["[Amplitude] Request Headers"]=d.requestHeaders,c["[Amplitude] Response Headers"]=d.responseHeaders,c);uc(p,d,n,i)}})}var nr;(function(t){t.NetworkObservable="networkObservable"})(nr||(nr={}));var lc=function(t){t===void 0&&(t={});var e=ic,r="enrichment",n,i=[],o=function(l,d){var f={event:l,timestamp:Date.now(),type:d};return f},a=function(){var l,d=new Ye(function(f){var v=new as(function(h){var p=o(h,"network");f.next(p)});return Qr.subscribe(v,n),function(){Qr.unsubscribe(v)}});return l={},l[nr.NetworkObservable]=d,l},s=function(l,d){return S(void 0,void 0,void 0,function(){var f,v;return T(this,function(h){return typeof document>"u"?[2]:(f=a(),n=l==null?void 0:l.loggerProvider,v=cc({allObservables:f,networkTrackingOptions:t,amplitude:d,loggerProvider:n}),i.push(v),n==null||n.log("".concat(e," has been successfully added.")),[2])})})},c=function(l){return S(void 0,void 0,void 0,function(){return T(this,function(d){return[2,l]})})},u=function(){return S(void 0,void 0,void 0,function(){var l,d,f,v,h;return T(this,function(p){try{for(l=F(i),d=l.next();!d.done;d=l.next())f=d.value,f.unsubscribe()}catch(g){v={error:g}}finally{try{d&&!d.done&&(h=l.return)&&h.call(l)}finally{if(v)throw v.error}}return[2]})})};return{name:e,type:r,setup:s,execute:c,teardown:u}},dc="web-vitals-browser",fc="[Amplitude] Web Vitals";let Ai=-1;const Be=t=>{addEventListener("pageshow",e=>{e.persisted&&(Ai=e.timeStamp,t(e))},!0)},ge=(t,e,r,n)=>{let i,o;return a=>{e.value>=0&&(a||n)&&(o=e.value-(i??0),(o||i===void 0)&&(i=e.value,e.delta=o,e.rating=((s,c)=>s>c[1]?"poor":s>c[0]?"needs-improvement":"good")(e.value,r),t(e)))}},yr=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},br=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},et=()=>{const t=br();return(t==null?void 0:t.activationStart)??0},me=(t,e=-1)=>{const r=br();let n="navigate";return Ai>=0?n="back-forward-cache":r&&(document.prerendering||et()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},Gt=new WeakMap;function Er(t,e){return Gt.get(t)||Gt.set(t,new e),Gt.get(t)}class vc{constructor(){be(this,"t");be(this,"i",0);be(this,"o",[])}h(e){var i;if(e.hadRecentInput)return;const r=this.o[0],n=this.o.at(-1);this.i&&r&&n&&e.startTime-n.startTime<1e3&&e.startTime-r.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),(i=this.t)==null||i.call(this,e)}}const tt=(t,e,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const n=new PerformanceObserver(i=>{Promise.resolve().then(()=>{e(i.getEntries())})});return n.observe({type:t,buffered:!0,...r}),n}}catch{}},Tr=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let Fe=-1;const ki=new Set,En=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,ir=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(const e of ki)e();isFinite(Fe)||(Fe=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",ir,!0))}},Tt=()=>{var t;if(Fe<0){const e=et();Fe=(document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(n=>n.name==="hidden"&&n.startTime>e)[0])==null?void 0:t.startTime)??En(),addEventListener("visibilitychange",ir,!0),addEventListener("prerenderingchange",ir,!0),Be(()=>{setTimeout(()=>{Fe=En()})})}return{get firstHiddenTime(){return Fe},onHidden(e){ki.add(e)}}},St=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},Tn=[1800,3e3],Pi=(t,e={})=>{St(()=>{const r=Tt();let n,i=me("FCP");const o=tt("paint",a=>{for(const s of a)s.name==="first-contentful-paint"&&(o.disconnect(),s.startTime<r.firstHiddenTime&&(i.value=Math.max(s.startTime-et(),0),i.entries.push(s),n(!0)))});o&&(n=ge(t,i,Tn,e.reportAllChanges),Be(a=>{i=me("FCP"),n=ge(t,i,Tn,e.reportAllChanges),yr(()=>{i.value=performance.now()-a.timeStamp,n(!0)})}))})},Sn=[.1,.25],hc=(t,e={})=>{const r=Tt();Pi(Tr(()=>{let n,i=me("CLS",0);const o=Er(e,vc),a=c=>{for(const u of c)o.h(u);o.i>i.value&&(i.value=o.i,i.entries=o.o,n())},s=tt("layout-shift",a);s&&(n=ge(t,i,Sn,e.reportAllChanges),r.onHidden(()=>{a(s.takeRecords()),n(!0)}),Be(()=>{o.i=0,i=me("CLS",0),n=ge(t,i,Sn,e.reportAllChanges),yr(()=>n())}),setTimeout(n))}))};let Ri=0,Wt=1/0,at=0;const pc=t=>{for(const e of t)e.interactionId&&(Wt=Math.min(Wt,e.interactionId),at=Math.max(at,e.interactionId),Ri=at?(at-Wt)/7+1:0)};let or;const wn=()=>or?Ri:performance.interactionCount??0,gc=()=>{"interactionCount"in performance||or||(or=tt("event",pc,{type:"event",buffered:!0,durationThreshold:0}))};let _n=0;class mc{constructor(){be(this,"u",[]);be(this,"l",new Map);be(this,"m");be(this,"p")}v(){_n=wn(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((wn()-_n)/50));return this.u[e]}h(e){var i,o;if((i=this.m)==null||i.call(this,e),!e.interactionId&&e.entryType!=="first-input")return;const r=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>r.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((a,s)=>s.P-a.P),this.u.length>10){const a=this.u.splice(10);for(const s of a)this.l.delete(s.id)}(o=this.p)==null||o.call(this,n)}}}const Ci=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=Tr(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e(()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})}))},In=[200,500],yc=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const r=Tt();St(()=>{gc();let n,i=me("INP");const o=Er(e,mc),a=c=>{Ci(()=>{for(const l of c)o.h(l);const u=o.L();u&&u.P!==i.value&&(i.value=u.P,i.entries=u.entries,n())})},s=tt("event",a,{durationThreshold:e.durationThreshold??40});n=ge(t,i,In,e.reportAllChanges),s&&(s.observe({type:"first-input",buffered:!0}),r.onHidden(()=>{a(s.takeRecords()),n(!0)}),Be(()=>{o.v(),i=me("INP"),n=ge(t,i,In,e.reportAllChanges)}))})};class bc{constructor(){be(this,"m")}h(e){var r;(r=this.m)==null||r.call(this,e)}}const An=[2500,4e3],Ec=(t,e={})=>{St(()=>{const r=Tt();let n,i=me("LCP");const o=Er(e,bc),a=c=>{e.reportAllChanges||(c=c.slice(-1));for(const u of c)o.h(u),u.startTime<r.firstHiddenTime&&(i.value=Math.max(u.startTime-et(),0),i.entries=[u],n())},s=tt("largest-contentful-paint",a);if(s){n=ge(t,i,An,e.reportAllChanges);const c=Tr(()=>{a(s.takeRecords()),s.disconnect(),n(!0)}),u=l=>{l.isTrusted&&(Ci(c),removeEventListener(l.type,u,{capture:!0}))};for(const l of["keydown","click","visibilitychange"])addEventListener(l,u,{capture:!0});Be(l=>{i=me("LCP"),n=ge(t,i,An,e.reportAllChanges),yr(()=>{i.value=performance.now()-l.timeStamp,n(!0)})})}})},kn=[800,1800],ar=t=>{document.prerendering?St(()=>ar(t)):document.readyState!=="complete"?addEventListener("load",()=>ar(t),!0):setTimeout(t)},Tc=(t,e={})=>{let r=me("TTFB"),n=ge(t,r,kn,e.reportAllChanges);ar(()=>{const i=br();i&&(r.value=Math.max(i.responseStart-et(),0),r.entries=[i],n(!0),Be(()=>{r=me("TTFB",0),n=ge(t,r,kn,e.reportAllChanges),n(!0)}))})};function Sc(t){var e,r=((e=t.entries[0])===null||e===void 0?void 0:e.startTime)||0;return performance.timeOrigin+r}function Ge(t){return{value:t.value,rating:t.rating,delta:t.delta,navigationType:t.navigationType,id:t.id,timestamp:Math.floor(Sc(t)),navigationStart:Math.floor(performance.timeOrigin)}}var wc=function(){var t=null,e=$(),r=e==null?void 0:e.document,n=e==null?void 0:e.location,i=function(s,c){return S(void 0,void 0,void 0,function(){var u,l,d;return T(this,function(f){return u=function(v){var h;if(!v)return"";var p=v;try{p=decodeURI(v)}catch(g){(h=s.loggerProvider)===null||h===void 0||h.error("Malformed URI sequence: ",g)}return p},r===void 0?[2]:(l=u(n==null?void 0:n.href),d={"[Amplitude] Page Domain":(n==null?void 0:n.hostname)||"","[Amplitude] Page Location":l,"[Amplitude] Page Path":u(n==null?void 0:n.pathname),"[Amplitude] Page Title":typeof document<"u"&&document.title||"","[Amplitude] Page URL":l.split("?")[0]},Ec(function(v){d["[Amplitude] LCP"]=Ge(v)}),Pi(function(v){d["[Amplitude] FCP"]=Ge(v)}),yc(function(v){d["[Amplitude] INP"]=Ge(v)}),hc(function(v){d["[Amplitude] CLS"]=Ge(v)}),Tc(function(v){d["[Amplitude] TTFB"]=Ge(v)}),t=function(){r.visibilityState==="hidden"&&t&&(c.track(fc,d),r.removeEventListener("visibilitychange",t),t=null)},r.addEventListener("visibilitychange",t),[2])})})},o=function(s){return S(void 0,void 0,void 0,function(){return T(this,function(c){return[2,s]})})},a=function(){return S(void 0,void 0,void 0,function(){return T(this,function(s){return t&&(r==null||r.removeEventListener("visibilitychange",t)),[2]})})};return{name:dc,type:"enrichment",setup:i,execute:o,teardown:a}},Pn=function(t){var e=t.split(".");return e.length<=2?t:e.slice(e.length-2,e.length).join(".")},_c=function(t){return Object.values(t).every(function(e){return!e})},Ic=function(t,e,r,n,i){i===void 0&&(i=!0),t.referrer;var o=t.referring_domain,a=dt(t,["referrer","referring_domain"]),s=e||{};s.referrer;var c=s.referring_domain,u=dt(s,["referrer","referring_domain"]);if(Ac(r.excludeReferrers,t.referring_domain))return n.debug("This is not a new campaign because ".concat(t.referring_domain," is in the exclude referrer list.")),!1;if(!i&&_c(t)&&e)return n.debug("This is not a new campaign because this is a direct traffic in the same session."),!1;var l=JSON.stringify(a)!==JSON.stringify(u),d=Pn(o||"")!==Pn(c||""),f=!e||l||d;return f?n.debug("This is a new campaign. An $identify event will be sent."):n.debug("This is not a new campaign because it's the same as the previous one."),f},Ac=function(t,e){return t===void 0&&(t=[]),e===void 0&&(e=""),t.some(function(r){return r instanceof RegExp?r.test(e):r===e})},kc=function(t,e){var r=I(I({},bt),t),n=Object.entries(r).reduce(function(i,o){var a,s=D(o,2),c=s[0],u=s[1];return i.setOnce("initial_".concat(c),(a=u??e.initialEmptyValue)!==null&&a!==void 0?a:"EMPTY"),u?i.set(c,u):i.unset(c)},new Xe);return zn(n)},Pc=function(t){var e=t;return e?(e.startsWith(".")&&(e=e.substring(1)),[new RegExp("".concat(e.replace(".","\\."),"$"))]):[]},Rc=function(){function t(e,r){var n;this.shouldTrackNewCampaign=!1,this.options=I({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:Pc((n=r.cookieOptions)===null||n===void 0?void 0:n.domain)},e),this.storage=r.cookieStorage,this.storageKey=Kr(r.apiKey,"MKTG"),this.webExpStorageKey=Kr(r.apiKey,"MKTG_ORIGINAL"),this.currentCampaign=bt,this.sessionTimeout=r.sessionTimeout,this.lastEventTime=r.lastEventTime,this.logger=r.loggerProvider,r.loggerProvider.log("Installing web attribution tracking.")}return t.prototype.init=function(){return S(this,void 0,void 0,function(){var e,r;return T(this,function(n){switch(n.label){case 0:return[4,this.fetchCampaign()];case 1:return r=D.apply(void 0,[n.sent(),2]),this.currentCampaign=r[0],this.previousCampaign=r[1],e=this.lastEventTime?Yn(this.sessionTimeout,this.lastEventTime):!0,Ic(this.currentCampaign,this.previousCampaign,this.options,this.logger,e)?(this.shouldTrackNewCampaign=!0,[4,this.storage.set(this.storageKey,this.currentCampaign)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.fetchCampaign=function(){return S(this,void 0,void 0,function(){var e;return T(this,function(r){switch(r.label){case 0:return[4,this.storage.get(this.webExpStorageKey)];case 1:return e=r.sent(),e?[4,this.storage.remove(this.webExpStorageKey)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[4,Promise.all([e||new oi().parse(),this.storage.get(this.storageKey)])];case 4:return[2,r.sent()]}})})},t.prototype.generateCampaignEvent=function(e){this.shouldTrackNewCampaign=!1;var r=kc(this.currentCampaign,this.options);return e&&(r.event_id=e),r},t.prototype.shouldSetSessionIdOnNewCampaign=function(){return this.shouldTrackNewCampaign&&!!this.options.resetSessionOnNewCampaign},t}(),Cc=function(t){Me(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._diagnosticsSampleRate=0,r}return e.prototype.init=function(r,n,i){r===void 0&&(r="");var o,a;return arguments.length>2?(o=n,a=i):typeof n=="string"?(o=n,a=void 0):(o=n==null?void 0:n.userId,a=n),re(this._init(I(I({},a),{userId:o,apiKey:r})))},e.prototype._init=function(r){var n,i,o;return S(this,void 0,void 0,function(){var a,s,c,u,l,d,f,v,h,p=this;return T(this,function(g){switch(g.label){case 0:return this.initializing?[2]:(this.initializing=!0,[4,Ms(r.apiKey,r,this)]);case 1:return a=g.sent(),a.fetchRemoteConfig?(s=new Ha(a.apiKey,a.loggerProvider,a.serverZone),[4,new Promise(function(m){s==null||s.subscribe("configs.analyticsSDK.browserSDK","all",function(y,b,w){a.loggerProvider.debug("Remote configuration received:",JSON.stringify({remoteConfig:y,source:b,lastFetch:w},null,2)),y&&Xs(y,a),m()})})]):[3,3];case 2:g.sent(),g.label=3;case 3:return c=new xa(a.apiKey,a.loggerProvider,a.serverZone,{enabled:a.enableDiagnostics,sampleRate:a.diagnosticsSampleRate||this._diagnosticsSampleRate}),c.setTag("library","".concat(vi,"/").concat(pr)),[4,t.prototype._init.call(this,a)];case 4:return g.sent(),this.logBrowserOptions(a),this.config.diagnosticsClient=c,this.config.remoteConfigClient=s,ui(this.config.defaultTracking)?(u=ys(this.config),this.webAttribution=new Rc(u,this.config),[4,this.webAttribution.init()]):[3,6];case 5:g.sent(),g.label=6;case 6:return l=ht(),d=l.ampTimestamp?Number(l.ampTimestamp):void 0,f=d?Date.now()<d:!0,this.config.identify&&this.identify(this.config.identify),v=f&&!Number.isNaN(Number(l.ampSessionId))?Number(l.ampSessionId):void 0,this.setSessionId((o=(i=(n=r.sessionId)!==null&&n!==void 0?n:v)!==null&&i!==void 0?i:this.config.sessionId)!==null&&o!==void 0?o:Date.now()),h=Je(r.instanceName),h.identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),this.config.offline===Ba?[3,8]:[4,this.add(zs()).promise];case 7:g.sent(),g.label=8;case 8:return[4,this.add(new ma).promise];case 9:return g.sent(),[4,this.add(new Ts).promise];case 10:return g.sent(),[4,this.add(new Ea).promise];case 11:return g.sent(),$s(this.config),ds(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding file download tracking plugin"),[4,this.add(Ks()).promise]):[3,13];case 12:g.sent(),g.label=13;case 13:return fs(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding form interaction plugin"),[4,this.add(Ws()).promise]):[3,15];case 14:g.sent(),g.label=15;case 15:return ci(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding page view tracking plugin"),[4,this.add(Vs(ms(this.config))).promise]):[3,17];case 16:g.sent(),g.label=17;case 17:return di(this.config.autocapture)?(this.config.loggerProvider.debug("Adding user interactions plugin (autocapture plugin)"),[4,this.add(Qu(hs(this.config),{diagnosticsClient:c})).promise]):[3,19];case 18:g.sent(),g.label=19;case 19:return fi(this.config.autocapture)?(this.config.loggerProvider.debug("Adding frustration interactions plugin"),[4,this.add(nc(ps(this.config))).promise]):[3,21];case 20:g.sent(),g.label=21;case 21:return li(this.config.autocapture)?(this.config.loggerProvider.debug("Adding network tracking plugin"),[4,this.add(lc(gs(this.config))).promise]):[3,23];case 22:g.sent(),g.label=23;case 23:return vs(this.config.autocapture)?(this.config.loggerProvider.debug("Adding web vitals plugin"),[4,this.add(wc()).promise]):[3,25];case 24:g.sent(),g.label=25;case 25:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 26:return g.sent(),h.eventBridge.setEventReceiver(function(m){var y=m.eventProperties||{},b=y.time,w=dt(y,["time"]),E=typeof b=="number"?{time:b}:void 0;p.track(m.eventType,w,E)}),[2]}})})},e.prototype.getUserId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.userId},e.prototype.setUserId=function(r){if(!this.config){this.q.push(this.setUserId.bind(this,r));return}this.config.loggerProvider.debug("function setUserId: ",r),(r!==this.config.userId||r===void 0)&&(this.config.userId=r,this.timeline.onIdentityChanged({userId:r}),ya(r,this.config.instanceName))},e.prototype.getDeviceId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.deviceId},e.prototype.setDeviceId=function(r){if(!this.config){this.q.push(this.setDeviceId.bind(this,r));return}this.config.loggerProvider.debug("function setDeviceId: ",r),r!==this.config.deviceId&&(this.config.deviceId=r,this.timeline.onIdentityChanged({deviceId:r}),ba(r,this.config.instanceName))},e.prototype.reset=function(){this.setDeviceId(Ce()),this.setUserId(void 0)},e.prototype.getIdentity=function(){var r,n;return{deviceId:(r=this.config)===null||r===void 0?void 0:r.deviceId,userId:(n=this.config)===null||n===void 0?void 0:n.userId,userProperties:this.userProperties}},e.prototype.getOptOut=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.optOut},e.prototype.getSessionId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.sessionId},e.prototype.setSessionId=function(r){var n,i=[];if(!this.config)return this.q.push(this.setSessionId.bind(this,r)),re(Promise.resolve());if(r===this.config.sessionId)return re(Promise.resolve());this.config.loggerProvider.debug("function setSessionId: ",r);var o=this.getSessionId();o!==r&&this.timeline.onSessionIdChanged(r);var a=this.config.lastEventTime,s=(n=this.config.lastEventId)!==null&&n!==void 0?n:-1;this.config.sessionId=r,this.config.lastEventTime=void 0,this.config.pageCounter=0,Zr(this.config.defaultTracking)&&(o&&a&&i.push(this.track(rn,void 0,{device_id:this.previousSessionDeviceId,event_id:++s,session_id:o,time:a+1,user_id:this.previousSessionUserId}).promise),this.config.lastEventTime=this.config.sessionId);var c=this.trackCampaignEventIfNeeded(++s,i);return Zr(this.config.defaultTracking)&&i.push(this.track(tn,void 0,{event_id:c?++s:s,session_id:this.config.sessionId,time:this.config.lastEventTime}).promise),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId,re(Promise.all(i))},e.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},e.prototype.setTransport=function(r){if(!this.config){this.q.push(this.setTransport.bind(this,r));return}this.config.transportProvider=pi(r)},e.prototype.identify=function(r,n){if(jt(r)){var i=r._q;r._q=[],r=Ft(new Xe,i)}return n!=null&&n.user_id&&this.setUserId(n.user_id),n!=null&&n.device_id&&this.setDeviceId(n.device_id),t.prototype.identify.call(this,r,n)},e.prototype.groupIdentify=function(r,n,i,o){if(jt(i)){var a=i._q;i._q=[],i=Ft(new Xe,a)}return t.prototype.groupIdentify.call(this,r,n,i,o)},e.prototype.revenue=function(r,n){if(jt(r)){var i=r._q;r._q=[],r=Ft(new da,i)}return t.prototype.revenue.call(this,r,n)},e.prototype.trackCampaignEventIfNeeded=function(r,n){if(!this.webAttribution||!this.webAttribution.shouldTrackNewCampaign)return!1;var i=this.webAttribution.generateCampaignEvent(r);return n?n.push(this.track(i).promise):this.track(i),this.config.loggerProvider.log("Tracking attribution."),!0},e.prototype.process=function(r){return S(this,void 0,void 0,function(){var n,i,o;return T(this,function(a){return n=Date.now(),i=Yn(this.config.sessionTimeout,this.config.lastEventTime),o=this.webAttribution&&this.webAttribution.shouldSetSessionIdOnNewCampaign(),r.event_type!==tn&&r.event_type!==rn&&(!r.session_id||r.session_id===this.getSessionId())&&(i||o?(this.setSessionId(n),o&&this.config.loggerProvider.log("Created a new session for new campaign.")):i||this.trackCampaignEventIfNeeded()),r.event_type===Re.IDENTIFY&&r.user_properties&&(this.userProperties=this.getOperationAppliedUserProperties(r.user_properties)),[2,t.prototype.process.call(this,r)]})})},e.prototype.logBrowserOptions=function(r){try{var n=I(I({},r),{apiKey:r.apiKey.substring(0,10)+"********"});this.config.loggerProvider.debug("Initialized Amplitude with BrowserConfig:",JSON.stringify(n))}catch(i){this.config.loggerProvider.error("Error logging browser config",i)}},e.prototype._setDiagnosticsSampleRate=function(r){if(!(r>1||r<0)&&!this.config){this._diagnosticsSampleRate=r;return}},e}(la),Oc=function(){var t=new Cc;return{init:B(t.init.bind(t),"init",V(t),H(t,["config"])),add:B(t.add.bind(t),"add",V(t),H(t,["config.apiKey","timeline.plugins"])),remove:B(t.remove.bind(t),"remove",V(t),H(t,["config.apiKey","timeline.plugins"])),track:B(t.track.bind(t),"track",V(t),H(t,["config.apiKey","timeline.queue.length"])),logEvent:B(t.logEvent.bind(t),"logEvent",V(t),H(t,["config.apiKey","timeline.queue.length"])),identify:B(t.identify.bind(t),"identify",V(t),H(t,["config.apiKey","timeline.queue.length"])),groupIdentify:B(t.groupIdentify.bind(t),"groupIdentify",V(t),H(t,["config.apiKey","timeline.queue.length"])),setGroup:B(t.setGroup.bind(t),"setGroup",V(t),H(t,["config.apiKey","timeline.queue.length"])),revenue:B(t.revenue.bind(t),"revenue",V(t),H(t,["config.apiKey","timeline.queue.length"])),flush:B(t.flush.bind(t),"flush",V(t),H(t,["config.apiKey","timeline.queue.length"])),getUserId:B(t.getUserId.bind(t),"getUserId",V(t),H(t,["config","config.userId"])),setUserId:B(t.setUserId.bind(t),"setUserId",V(t),H(t,["config","config.userId"])),getDeviceId:B(t.getDeviceId.bind(t),"getDeviceId",V(t),H(t,["config","config.deviceId"])),setDeviceId:B(t.setDeviceId.bind(t),"setDeviceId",V(t),H(t,["config","config.deviceId"])),reset:B(t.reset.bind(t),"reset",V(t),H(t,["config","config.userId","config.deviceId"])),getSessionId:B(t.getSessionId.bind(t),"getSessionId",V(t),H(t,["config"])),setSessionId:B(t.setSessionId.bind(t),"setSessionId",V(t),H(t,["config"])),extendSession:B(t.extendSession.bind(t),"extendSession",V(t),H(t,["config"])),setOptOut:B(t.setOptOut.bind(t),"setOptOut",V(t),H(t,["config"])),setTransport:B(t.setTransport.bind(t),"setTransport",V(t),H(t,["config"])),getIdentity:B(t.getIdentity.bind(t),"getIdentity",V(t),H(t,["config"])),getOptOut:B(t.getOptOut.bind(t),"getOptOut",V(t),H(t,["config"])),_setDiagnosticsSampleRate:B(t._setDiagnosticsSampleRate.bind(t),"_setDiagnosticsSampleRate",V(t),H(t,["config"]))}};const wt=Oc();var Lc=wt.identify,il=wt.init,Dc=wt.setUserId,Nc=wt.track;const xc=()=>{const t=N.useCallback(n=>{Dc(n)},[]),e=N.useCallback(n=>{const i=new Xe;Object.entries(n).forEach(([o,a])=>{i.set(o,a)}),Lc(i)},[]),r=N.useCallback((n,i)=>{Nc(n,i)},[]);return{setUserId:t,identify:e,track:r}},Oi=N.createContext(void 0);function ol({children:t}){const[e,r]=N.useState(null),[n,i]=N.useState(null),[o,a]=N.useState(!1),[s,c]=N.useState(!0),[u,l]=N.useState(null),[d,f]=N.useState(null),{address:v,isConnected:h}=vo(),{signMessageAsync:p}=Uo(),{disconnect:g}=Mo(),{setUserId:m}=xc(),y=N.useCallback(()=>{r(null),i(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),g()},[g]),b=N.useCallback(async()=>{if(!n||!(e!=null&&e.address)){const E=localStorage.getItem("auth_token"),_=localStorage.getItem("auth_user");return!!(E&&_)}if(v&&e.address.toLowerCase()!==v.toLowerCase())return console.log("Authenticated address doesn't match connected wallet address"),y(),!1;try{const E=await fetch(`${Ot}/api/auth/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e.address,token:n})});return E.ok?(await E.json()).valid:(y(),!1)}catch(E){return console.error("Token validation error:",E),y(),!1}},[n,e,v,y]);N.useEffect(()=>{(async()=>{c(!0);try{const _=localStorage.getItem("auth_token"),C=localStorage.getItem("auth_user");if(!h&&(_||C)){console.log("Wallet not connected, but auth data exists. Clearing auth data."),y(),c(!1);return}if(_&&C){const k=JSON.parse(C);i(_),r(k),await b()||(console.log("Saved token is invalid, logging out"),y(),wr.warning("Your session has expired. Please log in again."))}}catch(_){console.error("Error validating saved auth:",_),y()}finally{c(!1)}})()},[h,v,y]),N.useEffect(()=>{!h&&e&&y()},[h,e,y]),N.useEffect(()=>{v&&d&&v!==d&&(console.log("Wallet address changed from",d,"to",v),r(null),i(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),wr.info("Wallet switched. Please sign in with the new wallet.")),f(v||null)},[v,d]),N.useEffect(()=>{qi(g)},[g]);const w=N.useCallback(async()=>{if(!v){const E="No wallet connected";throw l(E),new Error(E)}try{a(!0),l(null);const E=await fetch(`${Ot}/api/auth/nonce`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:v})});if(!E.ok){const R="Failed to get authentication nonce";throw new Error(R)}const{message:_}=await E.json(),C=await p({message:_}),k=await fetch(`${Ot}/api/auth/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:v,signature:C})});if(!k.ok){const R="Signature verification failed";throw new Error(R)}const{user:L,token:A}=await k.json();r(L),i(A),localStorage.setItem("auth_token",A),localStorage.setItem("auth_user",JSON.stringify(L))}catch(E){const _=E instanceof Error?E.message:"Authentication failed";throw l(_),E}finally{a(!1)}},[v,p]);return N.useEffect(()=>{h&&v&&m(v)},[h,v]),xn.jsx(Oi.Provider,{value:{user:e,token:n,isAuthenticated:!!e&&!!n,isLoading:o||s,error:u,login:w,logout:y,validateToken:b},children:t})}function al(){const t=N.useContext(Oi);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}export{ol as A,_o as B,So as C,go as D,mt as E,ho as F,jn as G,Do as H,Lo as I,No as J,tl as M,nl as Q,Po as R,cr as S,Hc as W,vo as a,Mo as b,gt as c,Gn as d,Xc as e,Bc as f,Zc as g,po as h,Qc as i,Yc as j,Eo as k,Gc as l,zc as m,dr as n,qn as o,ze as p,lr as q,Kc as r,yo as s,il as t,al as u,Jc as v,$c as w,Wc as x,Io as y,el as z};
