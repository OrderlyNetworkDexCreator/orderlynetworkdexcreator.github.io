import{r as h,j as s}from"./index-gtzDq4NN.js";import{B as ve}from"./BackDexDashboard-DrPHIyI3.js";import{C as L,B as I}from"./Card-CTDM2G3r.js";import{u as q}from"./DexContext-BStH6aHx.js";import{d as _e,e as je}from"./usePrivateQuery-C4ovqd4J.js";import{u as ae,a as Ne}from"./useCreateOrderlyKey-Dfq3toG_.js";import{y as C}from"./globalDisconnect-BwfQ2Vw-.js";import{cf as se,cg as $,ch as Pe,ci as H,cj as Se,ck as Ce}from"./ModalContext-mlJE0UaS.js";import{c as y}from"./css-BzFf4VQ5.js";import{a as Q}from"./tooltip-BDJTYlm8.js";import{c as ke,u as ie,p as Me,d as De,r as Te,e as Oe}from"./Combination-CTmdEaXQ.js";import"./index-Dvs6MNyz.js";import{P as Ee}from"./PointSystemIcon-DZDfiAFx.js";import{c as We,p as Ye}from"./apiClient-DEwubw2O.js";import{u as oe}from"./useAuth-CdmGF86g.js";import{A as Fe}from"./NavigationMenuEditor-CH7me4j8.js";import{W as Le}from"./WalletConnect-R3qWhd59.js";import"./components-Cb_t2az9.js";import"./index-_0cUeJFu.js";import"./index-DG3TDxXu.js";import"./clsx-B-dksMZM.js";import"./OrderlyKeyContext-4mPVxEwy.js";import"./dijkstra-C00ieaqj.js";import"./dayjs.min-DsMxAas2.js";import"./tslib.es6-MJ473bz6.js";import"./browser-BqbI9gSd.js";import"./iconify-AJT-F7UA.js";var S=(t=>(t.Pending="pending",t.Active="active",t.Completed="completed",t))(S||{}),v=(t=>(t.Create="create",t.Edit="edit",t.View="view",t))(v||{});function qe(){const{brokerId:t}=q();return _e(t?`/v1/public/points/stages?broker_id=${t}`:null,{formatter:e=>{const n=[...(e==null?void 0:e.rows)||[]];return n.sort((r,a)=>a.start_time-r.start_time),n}})}function Re(t){return je(t?`/v1/admin/points/stage?stage_id=${t}`:null)}function Ae(){return ae("/v1/admin/points/stage")}function Ie(t){return ae(t?`/v1/admin/points/stage?stage_id=${t}`:"","DELETE")}const ce=6048e5,Be=864e5,U=Symbol.for("constructDateFrom");function P(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&U in t?t[U](e):t instanceof Date?new t.constructor(e):new Date(e)}function _(t,e){return P(e||t,t)}function Ve(t,e,n){const r=_(t,n==null?void 0:n.in);return isNaN(e)?P(t,NaN):(e&&r.setDate(r.getDate()+e),r)}function He(t,e,n){const r=_(t,n==null?void 0:n.in);if(isNaN(e))return P(t,NaN);if(!e)return r;const a=r.getDate(),i=P(t,r.getTime());i.setMonth(r.getMonth()+e+1,0);const c=i.getDate();return a>=c?i:(r.setFullYear(i.getFullYear(),i.getMonth(),a),r)}function Xe(t,e,n){const{years:r=0,months:a=0,weeks:i=0,days:c=0,hours:l=0,minutes:o=0,seconds:d=0}=e,u=_(t,n==null?void 0:n.in),m=a||r?He(u,a+r*12):u,x=c||i?Ve(m,c+i*7):m,b=o+l*60,g=(d+b*60)*1e3;return P(t,+x+g)}let Ge={};function B(){return Ge}function F(t,e){var l,o,d,u;const n=B(),r=(e==null?void 0:e.weekStartsOn)??((o=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:o.weekStartsOn)??n.weekStartsOn??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=_(t,e==null?void 0:e.in),i=a.getDay(),c=(i<r?7:0)+i-r;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function R(t,e){return F(t,{...e,weekStartsOn:1})}function de(t,e){const n=_(t,e==null?void 0:e.in),r=n.getFullYear(),a=P(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const i=R(a),c=P(n,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const l=R(c);return n.getTime()>=i.getTime()?r+1:n.getTime()>=l.getTime()?r:r-1}function z(t){const e=_(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Qe(t,...e){const n=P.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function K(t,e){const n=_(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function $e(t,e,n){const[r,a]=Qe(n==null?void 0:n.in,t,e),i=K(r),c=K(a),l=+i-z(i),o=+c-z(c);return Math.round((l-o)/Be)}function Ue(t,e){const n=de(t,e),r=P(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),R(r)}function ze(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Ke(t){return!(!ze(t)&&typeof t!="number"||isNaN(+_(t)))}function Je(t,e){const n=_(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Ze={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},et=(t,e,n)=>{let r;const a=Ze[t];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function X(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const tt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},nt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},rt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},at={date:X({formats:tt,defaultWidth:"full"}),time:X({formats:nt,defaultWidth:"full"}),dateTime:X({formats:rt,defaultWidth:"full"})},st={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},it=(t,e,n,r)=>st[t];function W(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,l=n!=null&&n.width?String(n.width):c;a=t.formattingValues[l]||t.formattingValues[c]}else{const c=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[l]||t.values[c]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const ot={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ct={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ut={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ft=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},ht={ordinalNumber:ft,era:W({values:ot,defaultWidth:"wide"}),quarter:W({values:ct,defaultWidth:"wide",argumentCallback:t=>t-1}),month:W({values:dt,defaultWidth:"wide"}),day:W({values:lt,defaultWidth:"wide"}),dayPeriod:W({values:ut,defaultWidth:"wide",formattingValues:mt,defaultFormattingWidth:"wide"})};function Y(t){return(e,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const c=i[0],l=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],o=Array.isArray(l)?xt(l,m=>m.test(c)):gt(l,m=>m.test(c));let d;d=t.valueCallback?t.valueCallback(o):o,d=n.valueCallback?n.valueCallback(d):d;const u=e.slice(c.length);return{value:d,rest:u}}}function gt(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function xt(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function bt(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const a=r[0],i=e.match(t.parsePattern);if(!i)return null;let c=t.valueCallback?t.valueCallback(i[0]):i[0];c=n.valueCallback?n.valueCallback(c):c;const l=e.slice(a.length);return{value:c,rest:l}}}const pt=/^(\d+)(th|st|nd|rd)?/i,yt=/\d+/i,wt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vt={any:[/^b/i,/^(a|c)/i]},_t={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jt={any:[/1/i,/2/i,/3/i,/4/i]},Nt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Pt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},St={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ct={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Mt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Dt={ordinalNumber:bt({matchPattern:pt,parsePattern:yt,valueCallback:t=>parseInt(t,10)}),era:Y({matchPatterns:wt,defaultMatchWidth:"wide",parsePatterns:vt,defaultParseWidth:"any"}),quarter:Y({matchPatterns:_t,defaultMatchWidth:"wide",parsePatterns:jt,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Y({matchPatterns:Nt,defaultMatchWidth:"wide",parsePatterns:Pt,defaultParseWidth:"any"}),day:Y({matchPatterns:St,defaultMatchWidth:"wide",parsePatterns:Ct,defaultParseWidth:"any"}),dayPeriod:Y({matchPatterns:kt,defaultMatchWidth:"any",parsePatterns:Mt,defaultParseWidth:"any"})},Tt={code:"en-US",formatDistance:et,formatLong:at,formatRelative:it,localize:ht,match:Dt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ot(t,e){const n=_(t,e==null?void 0:e.in);return $e(n,Je(n))+1}function Et(t,e){const n=_(t,e==null?void 0:e.in),r=+R(n)-+Ue(n);return Math.round(r/ce)+1}function le(t,e){var u,m,x,b;const n=_(t,e==null?void 0:e.in),r=n.getFullYear(),a=B(),i=(e==null?void 0:e.firstWeekContainsDate)??((m=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(x=a.locale)==null?void 0:x.options)==null?void 0:b.firstWeekContainsDate)??1,c=P((e==null?void 0:e.in)||t,0);c.setFullYear(r+1,0,i),c.setHours(0,0,0,0);const l=F(c,e),o=P((e==null?void 0:e.in)||t,0);o.setFullYear(r,0,i),o.setHours(0,0,0,0);const d=F(o,e);return+n>=+l?r+1:+n>=+d?r:r-1}function Wt(t,e){var l,o,d,u;const n=B(),r=(e==null?void 0:e.firstWeekContainsDate)??((o=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:o.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=le(t,e),i=P((e==null?void 0:e.in)||t,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),F(i,e)}function Yt(t,e){const n=_(t,e==null?void 0:e.in),r=+F(n,e)-+Wt(n,e);return Math.round(r/ce)+1}function p(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const k={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return p(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):p(n+1,2)},d(t,e){return p(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return p(t.getHours()%12||12,e.length)},H(t,e){return p(t.getHours(),e.length)},m(t,e){return p(t.getMinutes(),e.length)},s(t,e){return p(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return p(a,e.length)}},T={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},J={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return k.y(t,e)},Y:function(t,e,n,r){const a=le(t,r),i=a>0?a:1-a;if(e==="YY"){const c=i%100;return p(c,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):p(i,e.length)},R:function(t,e){const n=de(t);return p(n,e.length)},u:function(t,e){const n=t.getFullYear();return p(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return p(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return p(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return k.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return p(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const a=Yt(t,r);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):p(a,e.length)},I:function(t,e,n){const r=Et(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):p(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):k.d(t,e)},D:function(t,e,n){const r=Ot(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):p(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return p(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return p(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),a=r===0?7:r;switch(e){case"i":return String(a);case"ii":return p(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let a;switch(r===12?a=T.noon:r===0?a=T.midnight:a=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let a;switch(r>=17?a=T.evening:r>=12?a=T.afternoon:r>=4?a=T.morning:a=T.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return k.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):k.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):p(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):p(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):k.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):k.s(t,e)},S:function(t,e){return k.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return ee(r);case"XXXX":case"XX":return D(r);case"XXXXX":case"XXX":default:return D(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return ee(r);case"xxxx":case"xx":return D(r);case"xxxxx":case"xxx":default:return D(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Z(r,":");case"OOOO":default:return"GMT"+D(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Z(r,":");case"zzzz":default:return"GMT"+D(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return p(r,e.length)},T:function(t,e,n){return p(+t,e.length)}};function Z(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+e+p(i,2)}function ee(t,e){return t%60===0?(t>0?"-":"+")+p(Math.abs(t)/60,2):D(t,e)}function D(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=p(Math.trunc(r/60),2),i=p(r%60,2);return n+a+e+i}const te=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ue=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Ft=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return te(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",te(r,e)).replace("{{time}}",ue(a,e))},Lt={p:ue,P:Ft},qt=/^D+$/,Rt=/^Y+$/,At=["D","DD","YY","YYYY"];function It(t){return qt.test(t)}function Bt(t){return Rt.test(t)}function Vt(t,e,n){const r=Ht(t,e,n);if(console.warn(r),At.includes(t))throw new RangeError(r)}function Ht(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Xt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Gt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Qt=/^'([^]*?)'?$/,$t=/''/g,Ut=/[a-zA-Z]/;function zt(t,e,n){var u,m,x,b;const r=B(),a=r.locale??Tt,i=r.firstWeekContainsDate??((m=(u=r.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??1,c=r.weekStartsOn??((b=(x=r.locale)==null?void 0:x.options)==null?void 0:b.weekStartsOn)??0,l=_(t,n==null?void 0:n.in);if(!Ke(l))throw new RangeError("Invalid time value");let o=e.match(Gt).map(f=>{const g=f[0];if(g==="p"||g==="P"){const w=Lt[g];return w(f,a.formatLong)}return f}).join("").match(Xt).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const g=f[0];if(g==="'")return{isToken:!1,value:Kt(f)};if(J[g])return{isToken:!0,value:f};if(g.match(Ut))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:f}});a.localize.preprocessor&&(o=a.localize.preprocessor(l,o));const d={firstWeekContainsDate:i,weekStartsOn:c,locale:a};return o.map(f=>{if(!f.isToken)return f.value;const g=f.value;(Bt(g)||It(g))&&Vt(g,e,String(t));const w=J[g[0]];return w(l,g,a.localize,d)}).join("")}function Kt(t){const e=t.match(Qt);return e?e[1].replace($t,"'"):t}function A(t,e="MM/dd/yyyy HH:mm:ss"){if(t)return zt(t,e)}function ne(t,e="MM/dd/yyyy HH:mm:ss"){if(!t)return;const n=typeof t=="string"||typeof t=="number"?new Date(t):t;if(isNaN(n.getTime()))return;const r=n.getUTCFullYear(),a=String(n.getUTCMonth()+1).padStart(2,"0"),i=String(n.getUTCDate()).padStart(2,"0"),c=String(n.getUTCHours()).padStart(2,"0"),l=String(n.getUTCMinutes()).padStart(2,"0"),o=String(n.getUTCSeconds()).padStart(2,"0");return e.replace("yyyy",r.toString()).replace("MM",a).replace("dd",i).replace("HH",c).replace("mm",l).replace("ss",o)}const re={stage_name:"",stage_description:"",start_date:void 0,end_date:void 0,is_continuous:!1,volume_boost:"0.1",pnl_boost:"1",l1_referral_boost:"10",l2_referral_boost:"5"};function Jt({type:t,pointDetail:e}){const[n,r]=h.useState({...re}),[a,i]=h.useState({}),c=d=>{i(u=>({...u,[d]:void 0}))},l=(d,u)=>{r(m=>({...m,[d]:u})),c(d)};return h.useEffect(()=>{if(t!==v.Create&&e){const{stage_name:d,stage_description:u,start_date:m,end_date:x,volume_boost:b,pnl_boost:f,l1_referral_boost:g,l2_referral_boost:w}=e;r({stage_name:d,stage_description:u,start_date:m?new Date(m):void 0,end_date:x?new Date(x):void 0,is_continuous:!x,volume_boost:(b==null?void 0:b.toString())||"0.1",pnl_boost:(f==null?void 0:f.toString())||"1",l1_referral_boost:(g==null?void 0:g.toString())||"10",l2_referral_boost:(w==null?void 0:w.toString())||"5"})}},[t,e]),h.useEffect(()=>{t||(r({...re}),i({}))},[t]),{values:n,errors:a,setValue:l,validateForm:()=>{var b,f,g,w,j;const d={};if(((b=n.stage_name)==null?void 0:b.trim())===""&&(d.stage_name="Campaign title is required"),(((g=(f=n.stage_name)==null?void 0:f.trim())==null?void 0:g.length)||0)>40&&(d.stage_name="Campaign title must be less than 40 characters"),(((j=(w=n.stage_description)==null?void 0:w.trim())==null?void 0:j.length)||0)>280&&(d.stage_description="Description must be less than 280 characters"),n.start_date===void 0&&(d.start_date="Start date is required"),!n.is_continuous){if(n.end_date===void 0)d.end_date="End date is required";else if(n.start_date){const N=`${A(n.start_date,"yyyy-MM-dd")}T00:00:00Z`;`${A(n.end_date,"yyyy-MM-dd")}T23:59:59Z`<N&&(d.end_date="End date must be after start date")}}n.volume_boost===""?d.volume_boost="Trading volume is required":Number(n.volume_boost)<0&&(d.volume_boost="Trading volume cannot be less than 0"),n.pnl_boost===""?d.pnl_boost="PNL is required":Number(n.pnl_boost)<0&&(d.pnl_boost="PNL cannot be less than 0"),n.l1_referral_boost===""?d.l1_referral_boost="L1 referral rate is required":Number(n.l1_referral_boost)<0&&(d.l1_referral_boost="L1 referral rate cannot be less than 0"),n.l2_referral_boost===""?d.l2_referral_boost="L2 referral rate is required":Number(n.l2_referral_boost)<0&&(d.l2_referral_boost="L2 referral rate cannot be less than 0"),i(d);const x=Object.keys(d);return x.length>0?(C.error(d[x[0]]),!1):!0}}}function Zt(t){const{type:e,pointDetail:n}=t,[r,{isMutating:a}]=Ae(),i=o=>({stage_name:o.stage_name,stage_description:o.stage_description,start_date:o.start_date?A(o.start_date,"yyyy-MM-dd"):void 0,end_date:o.is_continuous?void 0:o.end_date?A(o.end_date,"yyyy-MM-dd"):void 0,is_continuous:o.is_continuous,volume_boost:Number(o.volume_boost??.1),pnl_boost:Number(o.pnl_boost??1),l1_referral_boost:Number(o.l1_referral_boost??10),l2_referral_boost:Number(o.l2_referral_boost??5)}),c=async o=>{try{const d=i(o),u=e===v.Edit?n==null?void 0:n.stage_id:void 0,m=await r({stage_id:u,...d});m.success?(e===v.Create?C.success(s.jsxs("div",{children:["Campaign created successfully",s.jsx("div",{className:"text-[13px] text-base-contrast-54",children:"You can now view and manage it in the campaign list."})]})):e===v.Edit&&C.success(s.jsxs("div",{children:["Campaign updated successfully",s.jsx("div",{className:"text-[13px] text-base-contrast-54",children:"It may take some time for changes to process."})]})),t.onSuccess()):C.error(m.message)}catch(d){console.error("Error creating campaign:",d);const u=d instanceof Error?d.message:"An error occurred";return C.error(u),d}};return{onSubmit:o=>{se.confirm({title:"Publish Campaign?",okLabel:"Confirm Publish",content:s.jsx("span",{className:"text-warning",children:"Please confirm that you want to publish this campaign. Once published, it cannot be deleted or withdrawn, but you may continue to modify its parameters."}),size:"md",onOk:()=>c(o)})},isMutating:a}}const me=t=>s.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,className:y("cursor-pointer",t.className),children:s.jsx("path",{d:"M8 1.343a6.667 6.667 0 1 0 0 13.333A6.667 6.667 0 0 0 8 1.343m0 3.333A.667.667 0 1 1 8 6.01a.667.667 0 0 1 0-1.334m0 2c.368 0 .666.299.666.667v3.333a.667.667 0 0 1-1.333 0V7.343c0-.368.298-.667.667-.667",fill:"#fff",fillOpacity:.36})});function G({label:t,tooltip:e,className:n=""}){return e?s.jsxs("div",{className:y("flex items-center gap-1 mb-1 md:mb-2",n),children:[s.jsx("span",{className:"block text-xs font-semibold text-base-contrast-54",children:t}),s.jsx(Q,{delayDuration:300,align:"center",sideOffset:4,className:"max-w-[276px]",content:e,children:s.jsx(me,{})})]}):s.jsx("label",{className:y("block text-xs font-semibold text-base-contrast-54 mb-1 md:mb-2",n),children:t})}function M({label:t,tooltip:e,value:n,onChange:r,type:a="text",placeholder:i,disabled:c=!1,helpText:l,classNames:o,rows:d=4,error:u=!1,errorMessage:m}){const x=y("w-full px-3 py-2.5 rounded-[6px] focus:ring-1 text-sm bg-base-6 border text-base-contrast",u?"border-error focus:ring-error focus:border-error":"border-transparent focus:ring-primary focus:border-primary"),f=y(x,c&&"cursor-not-allowed bg-base-8 text-base-contrast-36 placeholder:text-base-contrast-36",o==null?void 0:o.input);return s.jsxs("div",{className:y("mb-4",o==null?void 0:o.root),children:[t&&s.jsx(G,{label:t,tooltip:e}),a==="textarea"?s.jsx("textarea",{placeholder:i,value:n,onChange:r||void 0,disabled:c,className:y(f,"min-h-[100px] resize-y"),rows:d}):s.jsx("input",{type:a,value:n,onChange:r,placeholder:i,disabled:c,className:y(f,a==="number"&&"[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none")}),m&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-error"}),s.jsx("p",{className:"text-xs text-error leading-[18px] tracking-[0.36px]",children:m})]}),l&&!m&&s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-base-contrast-54"}),s.jsx("p",{className:"text-xs text-base-contrast-54 leading-[18px] tracking-[0.36px]",children:l})]})]})}function en(t){const{values:e,setValue:n,readonly:r,errors:a}=t;return s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("h2",{className:"text-base font-semibold text-base-contrast-80 leading-6 tracking-[0.48px]",children:"Coefficient"}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(M,{type:"number",label:"Trading volume",value:e.volume_boost,onChange:i=>n("volume_boost",i.target.value),helpText:`Trading points = perp_volume × ${e.volume_boost||.1}`,disabled:r,error:!!a.volume_boost,errorMessage:a.volume_boost})}),s.jsx("div",{className:"flex-1",children:s.jsx(M,{type:"number",label:"PNL",tooltip:"The profit or loss of each trade will be recorded in absolute value.",value:e.pnl_boost,onChange:i=>n("pnl_boost",i.target.value),helpText:`PNL points = |PNL| × ${e.pnl_boost||1}`,disabled:r,error:!!a.pnl_boost,errorMessage:a.pnl_boost})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(M,{type:"number",label:"L1 Referral rate(%)",tooltip:"Points earned from the first-level invitee's invitees",value:e.l1_referral_boost,onChange:i=>n("l1_referral_boost",i.target.value),helpText:`The first-level invitee's rebate inviter ${e.l1_referral_boost||10}% of their points`,disabled:r,error:!!a.l1_referral_boost,errorMessage:a.l1_referral_boost})}),s.jsx("div",{className:"flex-1",children:s.jsx(M,{type:"number",label:"L2 Referral rate(%)",tooltip:"Second-level referral rate percentage",value:e.l2_referral_boost,onChange:i=>n("l2_referral_boost",i.target.value),helpText:`The second-level invitee's rebate inviter ${e.l2_referral_boost||5}% of their points`,disabled:r,error:!!a.l2_referral_boost,errorMessage:a.l2_referral_boost})})]})]})}function tn(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function nn(t){const e=rn(t),n=h.forwardRef((r,a)=>{const{children:i,...c}=r,l=h.Children.toArray(i),o=l.find(sn);if(o){const d=o.props.children,u=l.map(m=>m===o?h.Children.count(d)>1?h.Children.only(null):h.isValidElement(d)?d.props.children:null:m);return s.jsx(e,{...c,ref:a,children:h.isValidElement(d)?h.cloneElement(d,void 0,u):null})}return s.jsx(e,{...c,ref:a,children:i})});return n.displayName=`${t}.Slot`,n}function rn(t){const e=h.forwardRef((n,r)=>{const{children:a,...i}=n;if(h.isValidElement(a)){const c=cn(a),l=on(i,a.props);return a.type!==h.Fragment&&(l.ref=r?ke(r,c):c),h.cloneElement(a,l)}return h.Children.count(a)>1?h.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var an=Symbol("radix.slottable");function sn(t){return h.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===an}function on(t,e){const n={...e};for(const r in e){const a=t[r],i=e[r];/^on[A-Z]/.test(r)?a&&i?n[r]=(...l)=>{const o=i(...l);return a(...l),o}:a&&(n[r]=a):r==="style"?n[r]={...a,...i}:r==="className"&&(n[r]=[a,i].filter(Boolean).join(" "))}return{...t,...n}}function cn(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var dn=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],fe=dn.reduce((t,e)=>{const n=nn(`Primitive.${e}`),r=h.forwardRef((a,i)=>{const{asChild:c,...l}=a,o=c?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(o,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),V="Switch",[ln,Jn]=De(V),[un,mn]=ln(V),he=h.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:a,defaultChecked:i,required:c,disabled:l,value:o="on",onCheckedChange:d,form:u,...m}=t,[x,b]=h.useState(null),f=ie(e,E=>b(E)),g=h.useRef(!1),w=x?u||!!x.closest("form"):!0,[j,N]=Me({prop:a,defaultProp:i??!1,onChange:d,caller:V});return s.jsxs(un,{scope:n,checked:j,disabled:l,children:[s.jsx(fe.button,{type:"button",role:"switch","aria-checked":j,"aria-required":c,"data-state":pe(j),"data-disabled":l?"":void 0,disabled:l,value:o,...m,ref:f,onClick:tn(t.onClick,E=>{N(we=>!we),w&&(g.current=E.isPropagationStopped(),g.current||E.stopPropagation())})}),w&&s.jsx(be,{control:x,bubbles:!g.current,name:r,value:o,checked:j,required:c,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});he.displayName=V;var ge="SwitchThumb",xe=h.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,a=mn(ge,n);return s.jsx(fe.span,{"data-state":pe(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:e})});xe.displayName=ge;var fn="SwitchBubbleInput",be=h.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...a},i)=>{const c=h.useRef(null),l=ie(c,i),o=Te(n),d=Oe(e);return h.useEffect(()=>{const u=c.current;if(!u)return;const m=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(m,"checked").set;if(o!==n&&b){const f=new Event("click",{bubbles:r});b.call(u,n),u.dispatchEvent(f)}},[o,n,r]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:l,style:{...a.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});be.displayName=fn;function pe(t){return t?"checked":"unchecked"}var hn=he,gn=xe;function ye({className:t,...e}){return s.jsx(hn,{"data-slot":"switch",className:y("peer data-[state=checked]:bg-secondary data-[state=unchecked]:bg-[#535E7B] focus-visible:border-ring focus-visible:ring-ring/50 inline-flex h-5 w-10 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 px-0.5",t),...e,children:s.jsx(gn,{"data-slot":"switch-thumb",className:y("bg-white pointer-events-none block h-4 w-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[18px] data-[state=unchecked]:translate-x-0")})})}function xn(t){const{values:e,setValue:n,readonly:r,errors:a,stages:i,disabledStartDate:c,minStartTime:l}=t;return s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("h2",{className:"text-base font-semibold text-base-contrast-80 leading-6 tracking-[0.48px]",children:"Basic information"}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(M,{label:"Campaign Title",placeholder:"Name your campaign title",value:e.stage_name,onChange:o=>n("stage_name",o.target.value),disabled:r,error:!!a.stage_name,errorMessage:a.stage_name})}),s.jsx("div",{className:"flex-1",children:s.jsx(M,{label:"Stages",tooltip:"This default number will increase as more campaigns are created. The stage is mainly used to help organize and track data in the future.",value:(i==null?void 0:i.toString())||"",disabled:!0})})]}),s.jsx("div",{children:s.jsx(M,{label:"Description",placeholder:"Description...",type:"textarea",value:e.stage_description,onChange:o=>n("stage_description",o.target.value),disabled:r,error:!!a.stage_description,errorMessage:a.stage_description})}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:y(c&&"cursor-not-allowed"),children:[s.jsx(G,{label:"Start Date (UTC)",className:"h-5"}),s.jsx($,{value:e.start_date,onChange:o=>n("start_date",o),disabled:{before:l},className:y("w-full border bg-base-8 focus:ring-0 rounded-[6px]",a.start_date?"border-error focus:border-error":"border-transparent",c&&"pointer-events-none"),placeholder:"Select a date"}),a.start_date?s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-error"}),s.jsx("p",{className:"text-xs text-error leading-[18px] tracking-[0.36px]",children:a.start_date})]}):s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-base-contrast-54"}),s.jsx("p",{className:"text-xs text-base-contrast-54 leading-[18px] tracking-[0.36px]",children:"Starts at 00:00:00 UTC"})]})]})}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:y(r&&"cursor-not-allowed"),children:[s.jsxs("div",{className:"flex items-center justify-between gap-1 mb-1 md:mb-2 flex-wrap",children:[s.jsx(G,{label:"End Date (UTC)",className:"mb-0 md:mb-0"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Q,{delayDuration:300,align:"center",sideOffset:4,className:"max-w-[276px]",content:"You can leave the end time unset for now. Before creating a new campaign, please set the end date for the current one.",children:s.jsx(me,{})}),s.jsx("span",{className:"text-xs font-semibold text-base-contrast-54 whitespace-nowrap",children:"Recurring"}),s.jsx(ye,{checked:e.is_continuous,onCheckedChange:o=>n("is_continuous",o),disabled:r})]})]}),e.is_continuous?s.jsx(M,{value:"Recurring",classNames:{root:"mb-0"},disabled:!0}):s.jsx($,{value:e.end_date,onChange:o=>n("end_date",o),disabled:{before:e.start_date||l},className:y("w-full border bg-base-8 focus:ring-0 rounded-[6px]",a.end_date?"border-error focus:border-error":"border-transparent",r&&"pointer-events-none"),placeholder:"Select a date"}),!e.is_continuous&&s.jsx(s.Fragment,{children:a.end_date?s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-error"}),s.jsx("p",{className:"text-xs text-error leading-[18px] tracking-[0.36px]",children:a.end_date})]}):s.jsxs("div",{className:"flex items-center gap-1 mt-1 pl-1",children:[s.jsx("div",{className:"w-1 h-1 rounded-full bg-base-contrast-54"}),s.jsx("p",{className:"text-xs text-base-contrast-54 leading-[18px] tracking-[0.36px]",children:"Ends at 23:59:59 UTC"})]})})]})})]})]})}function bn(t){const{currentPoints:e,type:n,latestPoints:r}=t,{data:a}=Re(e==null?void 0:e.stage_id),{values:i,errors:c,setValue:l,validateForm:o}=Jt({type:n,pointDetail:a}),{onSubmit:d,isMutating:u}=Zt({type:n,pointDetail:a,onSuccess:()=>{t.refresh(),t.close()}}),m=()=>{o()&&d(i)},x=h.useMemo(()=>n===v.Create?r?(r.epoch_period||0)+1:1:a==null?void 0:a.epoch_period,[r,a,n]),b=()=>{if(n===v.Create)return"Create Your Points Campaign";if(n===v.Edit)return"Edit Your Points Campaign";if(n===v.View)return"View Your Points Campaign"},f=n===v.View,g=h.useMemo(()=>n===v.Edit&&e?f||(e==null?void 0:e.status)===S.Active:f,[n,e,f]),w=()=>{const j=Xe(new Date,{days:1}),N=r!=null&&r.end_time?r.end_time*1e3:void 0;return N&&N>j.getTime()?new Date(N):j};return s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm text-gray-400 hover:text-primary-light mb-2 inline-flex items-center",onClick:t.close,children:[s.jsx("div",{className:"i-mdi:arrow-left h-4 w-4 mr-1"}),"Back to Point Campaign Setup"]}),s.jsx("h1",{className:"text-lg md:text-2xl font-bold gradient-text",children:b()}),s.jsx(L,{className:"p-4 md:p-8 bg-white/[0.04] border-line-12 mt-6 md:mt-12",children:s.jsxs("div",{className:"flex flex-col gap-8",children:[s.jsx(xn,{values:i,setValue:l,readonly:f,errors:c,stages:x,disabledStartDate:g,minStartTime:w()}),s.jsx(en,{values:i,setValue:l,readonly:f,errors:c}),!f&&s.jsx("div",{className:"flex justify-end",children:s.jsx(I,{variant:"primary",size:"md",onClick:m,isLoading:u,children:"Save & Publish"})})]})})]})}function pn(t){const{data:e,disabledCreate:n}=t,{page:r,pageSize:a,parsePagination:i}=Pe(),c=h.useMemo(()=>i({total:(e==null?void 0:e.length)??0,current_page:r,records_per_page:a}),[i,r,a,e==null?void 0:e.length]),l=h.useMemo(()=>[{title:"Stage",dataIndex:"epoch_period",width:50},{title:"Status",dataIndex:"status",width:60,render:(u,m)=>{const x={[S.Pending]:"Ready to go",[S.Active]:"Ongoing",[S.Completed]:"Ended"};return s.jsx("span",{className:y({"text-base-contrast-80":u===S.Pending,"text-success":u===S.Active,"text-base-contrast-36":u===S.Completed}),children:x[u]})}},{title:"Title",dataIndex:"stage_name",render:u=>s.jsx("div",{className:"py-2",children:u})},{title:"Time",dataIndex:"start_time",render:(u,m)=>{const{start_time:x,end_time:b}=m,f="MM/dd/yyyy";return s.jsxs("span",{children:[ne(x*1e3,f)," -"," ",b?ne(b*1e3,f):"Recurring"]})}},{title:"Action",dataIndex:"action",width:80,render:(u,m)=>{const x=m.status;return s.jsxs("div",{children:[x===S.Completed&&s.jsx(H,{variant:"text",color:"primary",size:"sm",onClick:()=>t.onView(m),children:"View"}),x!==S.Completed&&s.jsx(H,{variant:"text",color:"primary",size:"sm",onClick:()=>t.onEdit(m),children:"Edit"}),x===S.Pending&&s.jsx(H,{variant:"text",color:"danger",size:"sm",onClick:()=>t.onDelete(m),children:"Delete"})]})}}],[]),o=h.useMemo(()=>e==null?void 0:e.some(u=>u.is_continuous),[e]),d=()=>{const u=s.jsx(I,{variant:"primary",size:"sm",onClick:t.onCreate,disabled:n||o,children:"Create"});return n||o?s.jsx(Q,{delayDuration:100,content:o?"Please set an end date for the last stage first.":"Please enable the Point System first to create a campaign.",children:u}):u};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex flex-row items-center justify-between gap-4",children:[s.jsx("div",{className:"text-sm md:text-base font-semibold",children:"Point Campaign List"}),d()]}),s.jsx(Se,{classNames:{root:"mt-4 px-3 rounded bg-[rgb(19,21,25)]",header:"border-b border-b-line-4",body:"font-medium"},columns:l,dataSource:e,pagination:c,emptyView:s.jsx("div",{className:"text-sm md:text-base my-4 text-base-contrast-54",children:"No campaigns"})})]})}const O="Points";function yn({enabledMenus:t}){const[e,n]=h.useState(t.includes(O)),[r,a]=h.useState(!1),{token:i}=oe(),{dexData:c,updateDexData:l}=q();h.useEffect(()=>{n(t.includes(O))},[t]);const o=async u=>{a(!0);try{const m=Fe.filter(g=>g.isDefault).map(g=>g.id),x=t.includes(O)?t.filter(g=>g!==O).join(","):[t.length>0?t:m,O].join(","),b=We({enabledMenus:x}),f=await Ye(`api/dex/${c==null?void 0:c.id}`,b,i,{showToastOnError:!1});C.success(s.jsxs("div",{children:["Point system enabled",s.jsx("div",{className:"text-[13px] text-base-contrast-54",children:"The feature will show on your DEX UI within 5 minutes."})]})),n(u),l({enabledMenus:x})}catch(m){C.error(m instanceof Error?m.message:"Failed to enable point system")}finally{a(!1)}},d=u=>{o(u)};return s.jsx(L,{className:"my-6 md:my-12 border-line-6",children:s.jsxs("div",{className:"flex flex-row items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ee,{className:"flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm md:text-lg font-semibold mb-1",children:"Enable Point System"}),s.jsx("p",{className:"text-xs md:text-sm text-base-contrast-80",children:"Once enabled, the point system will appear in the header and cannot be turned off for now."})]})]}),r?s.jsx(Ce,{size:"md"}):s.jsx(ye,{checked:e,onCheckedChange:d,className:"flex-shrink-0",disabled:r||e})]})})}const wn=t=>s.jsxs(L,{className:y("w-full py-5 md:py-10 px-4 md:px-8 flex flex-col gap-4 md:gap-5 items-center text-center",t.className),children:[s.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-base-contrast",children:"Connect wallet"}),s.jsx("p",{className:"text-sm md:text-sm text-base-contrast-54",children:"Authentication required. Please connect your wallet and login."}),s.jsx("div",{className:"flex justify-center",children:s.jsx(Le,{})})]}),vn=t=>{const{brokerId:e}=q(),{isAuthenticated:n}=oe(),{hasValidKey:r,isCreatingKey:a,createOrderlyKey:i,accountId:c}=Ne(),l=()=>{!e||!c||i({brokerId:e,accountId:c}).then(o=>{})};return n?r?t.children:s.jsx(L,{className:y("border border-warning/20 bg-warning/5 p-4",t.className),children:s.jsxs("div",{className:"flex gap-4 items-start",children:[s.jsx("div",{className:"bg-warning/20 p-2 rounded-full flex-shrink-0",children:s.jsx("div",{className:"i-mdi:key text-warning w-6 h-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-medium text-warning",children:"Orderly Key Required"}),s.jsx("p",{className:"text-gray-300 mt-1 mb-4",children:"This key provides secure access to the Orderly Network API. It will be stored locally to manage your distributor profile. A wallet signature is required to create this key."}),s.jsx(I,{onClick:l,disabled:a,className:"flex items-center gap-2",children:a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"i-svg-spinners:pulse-rings-multiple w-4 h-4"}),"Creating Key..."]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"i-mdi:key-plus w-4 h-4"}),"Create Orderly Key"]})})]})]})}):s.jsx(wn,{className:t.className})},_n=t=>{const{isGraduated:e}=q();return e?t.children:s.jsx(L,{className:y("border border-warning/20 bg-warning/5",t.className),children:s.jsxs("div",{className:"flex gap-4 items-start",children:[s.jsx("div",{className:"bg-warning/20 p-3 rounded-full flex-shrink-0",children:s.jsx("div",{className:"i-mdi:lock text-warning w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-warning mb-2",children:"Graduation Required"}),s.jsx("p",{className:"text-gray-300 mb-4",children:"The feature you are trying to access is only available for graduated DEXs. You need to graduate your DEX first to access the feature."}),s.jsxs(I,{as:"a",href:"/dex/graduation",className:"inline-flex",children:[s.jsx("div",{className:"i-mdi:rocket-launch w-4 h-4"}),"Graduate Your DEX"]})]})]})})};function jn(t){const[e]=Ie(t.stage_id),n=async()=>{try{const a=await e({});a.success?(C.success(s.jsxs("div",{children:["Campaign deleted",s.jsx("div",{className:"text-[13px] text-base-contrast-54",children:"The campaign has been successfully removed."})]})),t.onSuccess()):C.error((a==null?void 0:a.message)||"Campaign delete failed")}catch(a){console.error("Error deleting campaign:",a),C.error((a==null?void 0:a.message)||"Campaign delete failed")}};return{onDelete:()=>{se.confirm({title:"Delete Campaign?",okLabel:"Delete",content:s.jsx("span",{className:"text-warning",children:"Are you sure you want to delete this campaign? This action cannot be undone."}),size:"md",onOk:n})}}}const Zn=()=>[{title:"Create point system - Orderly one"},{name:"description",content:"Configure and manage point campaigns for your DEX. Set up trading volume, PNL, and referral coefficients"}];function er(){const[t,e]=h.useState(null),[n,r]=h.useState(null),{dexData:a}=q(),i=h.useMemo(()=>Nn(a==null?void 0:a.enabledMenus),[a==null?void 0:a.enabledMenus]),{data:c,mutate:l}=qe(),o=()=>{l()},{onDelete:d}=jn({stage_id:n==null?void 0:n.stage_id,onSuccess:o}),u=()=>{e(v.Create)},m=N=>{r(N),e(v.Edit)},x=N=>{r(N),e(v.View)},b=()=>{e(null),r(null)},f=N=>{r(N),d()},g=h.useMemo(()=>c==null?void 0:c[0],[c]),w=h.useMemo(()=>!i.includes(O),[i]),j=()=>t?s.jsx(bn,{type:t,currentPoints:n,close:b,refresh:o,latestPoints:g}):s.jsxs("div",{children:[s.jsx(ve,{}),s.jsx("h1",{className:"text-lg md:text-2xl font-bold gradient-text",children:"Point Campaign Setup"}),s.jsx(vn,{className:"mt-10",children:s.jsxs(_n,{className:"mt-10",children:[s.jsx(yn,{enabledMenus:i}),s.jsx(pn,{data:c,onView:x,onEdit:m,onDelete:f,onCreate:u,disabledCreate:w})]})})]});return s.jsx("div",{className:"container mx-auto p-4 max-w-3xl mt-26 pb-52",children:j()})}function Nn(t){return t?t.split(",").map(e=>e.trim()).filter(Boolean):[]}export{er as default,Zn as meta};
