const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webp_enc_simd-DusA0kJf.js","assets/index-gtzDq4NN.js","assets/index-BftLqECp.js","assets/webp_enc-CJZuSIRu.js"])))=>i.map(i=>d[i]);
import{r as H,W as Bt,j as x,p as Z}from"./index-gtzDq4NN.js";import{B as Kt,C as bn}from"./Card-DzC9HQ_p.js";import{F as _n}from"./FormInput-CKH1Jbq0.js";import{g as wn}from"./apiClient-Br2nePLb.js";import{u as An}from"./useAuth-RM4Avg_6.js";import{g as or,_ as en}from"./index-BftLqECp.js";import{u as $n}from"./ModalContext-3rcxIYCP.js";import{y as Ye}from"./globalDisconnect-DEHmIGkh.js";function Tn(i=!0){const{token:l,isAuthenticated:r}=An(),[u,v]=H.useState(null),[R,T]=H.useState(!1),[_,E]=H.useState(0),U=H.useRef(null),q=H.useCallback(P=>{const M=Math.floor(P/60),ne=P%60;return`${M.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`},[]),F=H.useCallback(async()=>{if(!(!i||!r||!l)){T(!0);try{const P=await wn("api/dex/rate-limit-status",l,{showToastOnError:!1});v(P),E(P.remainingCooldownSeconds)}catch(P){console.debug("Error checking rate limit:",P)}finally{T(!1)}}},[i,r,l]),oe=H.useCallback(()=>{U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{F()},500)},[F]);return H.useEffect(()=>{if(!i||!(u!=null&&u.isRateLimited)||_<=0)return;const P=setInterval(()=>{E(M=>{const ne=M-1;return ne<=0?(setTimeout(()=>F(),100),0):ne})},1e3);return()=>clearInterval(P)},[i,u==null?void 0:u.isRateLimited,F]),H.useEffect(()=>{i&&r&&l&&F()},[i,r,l,F]),H.useEffect(()=>{if(!i||!r||!l)return;const P=()=>{document.hidden||oe()},M=()=>{oe()};return document.addEventListener("visibilitychange",P),window.addEventListener("focus",M),()=>{document.removeEventListener("visibilitychange",P),window.removeEventListener("focus",M)}},[i,r,l,oe]),H.useEffect(()=>()=>{U.current&&clearTimeout(U.current)},[]),{isRateLimited:!!(i&&(u!=null&&u.isRateLimited)&&_>0),remainingSeconds:_,formattedTime:q(_),checkRateLimit:F,isChecking:R}}function la({onSubmit:i,children:l,submitText:r,isLoading:u=!1,loadingText:v="Submitting",disabled:R=!1,className:T="",enableRateLimit:_=!1}){const[E,U]=H.useState({}),q=Tn(_),F=q.isRateLimited,oe=H.useCallback((I,Q)=>{U(se=>({...se,[I]:Q}))},[]),P=H.useCallback(I=>{I.preventDefault(),i(I,E)},[i,E]),M=I=>{I.key==="Enter"&&I.target instanceof HTMLInputElement&&I.preventDefault()},ne=H.useMemo(()=>Bt.Children.map(l,I=>{if(Bt.isValidElement(I)&&I.type===_n){const Q=I.props;if(Q.id)return Bt.cloneElement(I,{onError:se=>oe(Q.id,se)})}return I}),[l,oe]);return x.jsxs("form",{onSubmit:P,onKeyDown:M,className:T,children:[ne,r&&x.jsxs(x.Fragment,{children:[F&&x.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4 mb-4",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("div",{className:"i-mdi:clock-alert text-warning h-5 w-5"}),x.jsx("span",{className:"text-warning font-medium",children:"Please Wait"})]}),x.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"You can only update your DEX once every 5 minutes."}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-xs text-gray-400",children:"Time remaining:"}),x.jsx("span",{className:"font-mono text-warning font-bold",children:q.formattedTime})]})]}),x.jsx(Kt,{className:"w-full justify-center max-w-md mxa",type:"submit",variant:"primary",size:"md",disabled:R||u||F,isLoading:u,loadingText:v,children:F?`Wait ${q.formattedTime}`:r})]})]})}function Rn(i,l,r={}){return i({noInitialRun:!0,instantiateWasm:void 0,...r})}var En=(()=>{var i=import.meta.url;return function(l={}){var r=l,u,v,R=new Promise((e,t)=>{u=e,v=t});const _=globalThis.ServiceWorkerGlobalScope!==void 0&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,E=typeof Z=="object"&&Z.release&&Z.release.name==="node";(_||E)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(t,o,c){this.data=t,this.width=o,this.height=c}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));var U=Object.assign({},r),q="./this.program",F=(e,t)=>{throw t},oe=typeof window=="object",P=typeof importScripts=="function";typeof Z=="object"&&typeof Z.versions=="object"&&Z.versions.node;var M="";function ne(e){return r.locateFile?r.locateFile(e,M):M+e}var I;(oe||P)&&(P?M=self.location.href:typeof document<"u"&&document.currentScript&&(M=document.currentScript.src),i&&(M=i),M.startsWith("blob:")?M="":M=M.substr(0,M.replace(/[?#].*/,"").lastIndexOf("/")+1),P&&(I=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var Q=r.print||console.log.bind(console),se=r.printErr||console.error.bind(console);Object.assign(r,U),U=null,r.arguments&&r.arguments,r.thisProgram&&(q=r.thisProgram),r.quit&&(F=r.quit);var Ee;r.wasmBinary&&(Ee=r.wasmBinary);var xe,De=!1,ce,B,G,me,be,S,z,O;function k(){var e=xe.buffer;r.HEAP8=ce=new Int8Array(e),r.HEAP16=G=new Int16Array(e),r.HEAPU8=B=new Uint8Array(e),r.HEAPU16=me=new Uint16Array(e),r.HEAP32=be=new Int32Array(e),r.HEAPU32=S=new Uint32Array(e),r.HEAPF32=z=new Float32Array(e),r.HEAPF64=O=new Float64Array(e)}var j=[],D=[],V=[];function ie(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)de(r.preRun.shift());cr(j)}function K(){cr(D)}function _e(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Ne(r.postRun.shift());cr(V)}function de(e){j.unshift(e)}function Ve(e){D.unshift(e)}function Ne(e){V.unshift(e)}var we=0,Ce=null;function Ue(e){var t;we++,(t=r.monitorRunDependencies)==null||t.call(r,we)}function Be(e){var o;if(we--,(o=r.monitorRunDependencies)==null||o.call(r,we),we==0&&Ce){var t=Ce;Ce=null,t()}}function Wr(e){var o;(o=r.onAbort)==null||o.call(r,e),e="Aborted("+e+")",se(e),De=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw v(t),t}var Yr="data:application/octet-stream;base64,",ze=e=>e.startsWith(Yr),Fe;r.locateFile?(Fe="mozjpeg_dec.wasm",ze(Fe)||(Fe=ne(Fe))):Fe=new URL("/assets/mozjpeg_dec-muSO2n8T.wasm",import.meta.url).href;function sr(e){if(e==Fe&&Ee)return new Uint8Array(Ee);if(I)return I(e);throw"both async and sync fetching of the wasm failed"}function ke(e){return!Ee&&(oe||P)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw`failed to load wasm binary file at '${e}'`;return t.arrayBuffer()}).catch(()=>sr(e)):Promise.resolve().then(()=>sr(e))}function lr(e,t,o){return ke(e).then(c=>WebAssembly.instantiate(c,t)).then(o,c=>{se(`failed to asynchronously prepare wasm: ${c}`),Wr(c)})}function Jr(e,t,o,c){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!ze(t)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(h=>{var m=WebAssembly.instantiateStreaming(h,o);return m.then(c,function(w){return se(`wasm streaming compile failed: ${w}`),se("falling back to ArrayBuffer instantiation"),lr(t,o,c)})}):lr(t,o,c)}function xr(){var e={a:Ht};function t(c,h){return ae=c.exports,xe=ae.A,k(),Mr=ae.F,Ve(ae.B),Be(),ae}Ue();function o(c){t(c.instance)}if(r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(c){se(`Module.instantiateWasm callback failed with error: ${c}`),v(c)}return Jr(Ee,Fe,e,o).catch(v),{}}function Zr(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var cr=e=>{for(;e.length>0;)e.shift()(r)};r.noExitRuntime;class fr{constructor(t){this.excPtr=t,this.ptr=t-24}set_type(t){S[this.ptr+4>>2]=t}get_type(){return S[this.ptr+4>>2]}set_destructor(t){S[this.ptr+8>>2]=t}get_destructor(){return S[this.ptr+8>>2]}set_caught(t){t=t?1:0,ce[this.ptr+12]=t}get_caught(){return ce[this.ptr+12]!=0}set_rethrown(t){t=t?1:0,ce[this.ptr+13]=t}get_rethrown(){return ce[this.ptr+13]!=0}init(t,o){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(o)}set_adjusted_ptr(t){S[this.ptr+16>>2]=t}get_adjusted_ptr(){return S[this.ptr+16>>2]}get_exception_ptr(){var t=Zt(this.get_type());if(t)return S[this.excPtr>>2];var o=this.get_adjusted_ptr();return o!==0?o:this.excPtr}}var Ur=0,Qr=(e,t,o)=>{var c=new fr(e);throw c.init(t,o),Ur=e,Ur},et=(e,t,o,c,h)=>{},ur=()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Fr=e},Fr,fe=e=>{for(var t="",o=e;B[o];)t+=Fr[B[o++]];return t},re={},ue={},pe={},qe,le=e=>{throw new qe(e)},kr,Pr=e=>{throw new kr(e)},rt=(e,t,o)=>{e.forEach(function(y){pe[y]=t});function c(y){var A=o(y);A.length!==e.length&&Pr("Mismatched type converter count");for(var C=0;C<e.length;++C)ve(e[C],A[C])}var h=new Array(t.length),m=[],w=0;t.forEach((y,A)=>{ue.hasOwnProperty(y)?h[A]=ue[y]:(m.push(y),re.hasOwnProperty(y)||(re[y]=[]),re[y].push(()=>{h[A]=ue[y],++w,w===m.length&&c(h)}))}),m.length===0&&c(h)};function dr(e,t,o={}){var c=t.name;if(e||le(`type "${c}" must have a positive integer typeid pointer`),ue.hasOwnProperty(e)){if(o.ignoreDuplicateRegistrations)return;le(`Cannot register type '${c}' twice`)}if(ue[e]=t,delete pe[e],re.hasOwnProperty(e)){var h=re[e];delete re[e],h.forEach(m=>m())}}function ve(e,t,o={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return dr(e,t,o)}var X=8,Ir=(e,t,o,c)=>{t=fe(t),ve(e,{name:t,fromWireType:function(h){return!!h},toWireType:function(h,m){return m?o:c},argPackAdvance:X,readValueFromPointer:function(h){return this.fromWireType(B[h])},destructorFunction:null})},Ze=[],Ae=[],he=e=>{e>9&&--Ae[e+1]===0&&(Ae[e]=void 0,Ze.push(e))},tt=()=>Ae.length/2-5-Ze.length,hr=()=>{Ae.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=tt},te={toValue:e=>(e||le("Cannot use deleted val. handle = "+e),Ae[e]),toHandle:e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const t=Ze.pop()||Ae.length;return Ae[t]=e,Ae[t+1]=1,t}}}};function Qe(e){return this.fromWireType(S[e>>2])}var nt={name:"emscripten::val",fromWireType:e=>{var t=te.toValue(e);return he(e),t},toWireType:(e,t)=>te.toHandle(t),argPackAdvance:X,readValueFromPointer:Qe,destructorFunction:null},it=e=>ve(e,nt),at=(e,t)=>{switch(t){case 4:return function(o){return this.fromWireType(z[o>>2])};case 8:return function(o){return this.fromWireType(O[o>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},Le=(e,t,o)=>{t=fe(t),ve(e,{name:t,fromWireType:c=>c,toWireType:(c,h)=>h,argPackAdvance:X,readValueFromPointer:at(t,o),destructorFunction:null})},Ge=(e,t)=>Object.defineProperty(t,"name",{value:e}),jr=e=>{for(;e.length;){var t=e.pop(),o=e.pop();o(t)}};function ot(e){for(var t=1;t<e.length;++t)if(e[t]!==null&&e[t].destructorFunction===void 0)return!0;return!1}function st(e,t,o,c,h,m){var w=t.length;w<2&&le("argTypes array size mismatch! Must at least get return value and 'this' types!"),t[1];var y=ot(t),A=t[0].name!=="void",C=w-2,L=new Array(C),J=[],ge=[],Ie=function(...He){He.length!==C&&le(`function ${e} called with ${He.length} arguments, expected ${C}`),ge.length=0;var gn;J.length=1,J[0]=h;for(var ir=0;ir<C;++ir)L[ir]=t[ir+2].toWireType(ge,He[ir]),J.push(L[ir]);var mn=c(...J);function pn(vn){if(y)jr(ge);else for(var ar=2;ar<t.length;ar++){var yn=ar===1?gn:L[ar-2];t[ar].destructorFunction!==null&&t[ar].destructorFunction(yn)}if(A)return t[0].fromWireType(vn)}return pn(mn)};return Ge(e,Ie)}var lt=(e,t,o)=>{if(e[t].overloadTable===void 0){var c=e[t];e[t]=function(...h){return e[t].overloadTable.hasOwnProperty(h.length)||le(`Function '${o}' called with an invalid number of arguments (${h.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[h.length].apply(this,h)},e[t].overloadTable=[],e[t].overloadTable[c.argCount]=c}},ct=(e,t,o)=>{r.hasOwnProperty(e)?((o===void 0||r[e].overloadTable!==void 0&&r[e].overloadTable[o]!==void 0)&&le(`Cannot register public name '${e}' twice`),lt(r,e,e),r.hasOwnProperty(o)&&le(`Cannot register multiple overloads of a function with the same number of arguments (${o})!`),r[e].overloadTable[o]=t):(r[e]=t,o!==void 0&&(r[e].numArguments=o))},ft=(e,t)=>{for(var o=[],c=0;c<e;c++)o.push(S[t+c*4>>2]);return o},ut=(e,t,o)=>{r.hasOwnProperty(e)||Pr("Replacing nonexistent public symbol"),r[e].overloadTable!==void 0&&o!==void 0?r[e].overloadTable[o]=t:(r[e]=t,r[e].argCount=o)},dt=(e,t,o)=>{e=e.replace(/p/g,"i");var c=r["dynCall_"+e];return c(t,...o)},er=[],Mr,Ke=e=>{var t=er[e];return t||(e>=er.length&&(er.length=e+1),er[e]=t=Mr.get(e)),t},Or=(e,t,o=[])=>{if(e.includes("j"))return dt(e,t,o);var c=Ke(t)(...o);return c},ht=(e,t)=>(...o)=>Or(e,t,o),gt=(e,t)=>{e=fe(e);function o(){return e.includes("j")?ht(e,t):Ke(t)}var c=o();return typeof c!="function"&&le(`unknown function pointer with signature ${e}: ${t}`),c},mt=(e,t)=>{var o=Ge(t,function(c){this.name=t,this.message=c;var h=new Error(c).stack;h!==void 0&&(this.stack=this.toString()+`
`+h.replace(/^Error(:[^\n]*)?\n/,""))});return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},o},gr,mr=e=>{var t=zr(e),o=fe(t);return Pe(t),o},pt=(e,t)=>{var o=[],c={};function h(m){if(!c[m]&&!ue[m]){if(pe[m]){pe[m].forEach(h);return}o.push(m),c[m]=!0}}throw t.forEach(h),new gr(`${e}: `+o.map(mr).join([", "]))},vt=e=>{e=e.trim();const t=e.indexOf("(");return t!==-1?e.substr(0,t):e},yt=(e,t,o,c,h,m,w)=>{var y=ft(t,o);e=fe(e),e=vt(e),h=gt(c,h),ct(e,function(){pt(`Cannot call ${e} due to unbound types`,y)},t-1),rt([],y,A=>{var C=[A[0],null].concat(A.slice(1));return ut(e,st(e,C,null,h,m),t-1),[]})},bt=(e,t,o)=>{switch(t){case 1:return o?c=>ce[c]:c=>B[c];case 2:return o?c=>G[c>>1]:c=>me[c>>1];case 4:return o?c=>be[c>>2]:c=>S[c>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},_t=(e,t,o,c,h)=>{t=fe(t);var m=L=>L;if(c===0){var w=32-8*o;m=L=>L<<w>>>w}var y=t.includes("unsigned"),A=(L,J)=>{},C;y?C=function(L,J){return A(J,this.name),J>>>0}:C=function(L,J){return A(J,this.name),J},ve(e,{name:t,fromWireType:m,toWireType:C,argPackAdvance:X,readValueFromPointer:bt(t,o,c!==0),destructorFunction:null})},wt=(e,t,o)=>{var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],h=c[t];function m(w){var y=S[w>>2],A=S[w+4>>2];return new h(ce.buffer,A,y)}o=fe(o),ve(e,{name:o,fromWireType:m,argPackAdvance:X,readValueFromPointer:m},{ignoreDuplicateRegistrations:!0})},At=(e,t,o,c)=>{if(!(c>0))return 0;for(var h=o,m=o+c-1,w=0;w<e.length;++w){var y=e.charCodeAt(w);if(y>=55296&&y<=57343){var A=e.charCodeAt(++w);y=65536+((y&1023)<<10)|A&1023}if(y<=127){if(o>=m)break;t[o++]=y}else if(y<=2047){if(o+1>=m)break;t[o++]=192|y>>6,t[o++]=128|y&63}else if(y<=65535){if(o+2>=m)break;t[o++]=224|y>>12,t[o++]=128|y>>6&63,t[o++]=128|y&63}else{if(o+3>=m)break;t[o++]=240|y>>18,t[o++]=128|y>>12&63,t[o++]=128|y>>6&63,t[o++]=128|y&63}}return t[o]=0,o-h},$t=(e,t,o)=>At(e,B,t,o),Tt=e=>{for(var t=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c<=127?t++:c<=2047?t+=2:c>=55296&&c<=57343?(t+=4,++o):t+=3}return t},Dr=(e,t,o)=>{for(var c=t+o,h="";!(t>=c);){var m=e[t++];if(!m)return h;if(!(m&128)){h+=String.fromCharCode(m);continue}var w=e[t++]&63;if((m&224)==192){h+=String.fromCharCode((m&31)<<6|w);continue}var y=e[t++]&63;if((m&240)==224?m=(m&15)<<12|w<<6|y:m=(m&7)<<18|w<<12|y<<6|e[t++]&63,m<65536)h+=String.fromCharCode(m);else{var A=m-65536;h+=String.fromCharCode(55296|A>>10,56320|A&1023)}}return h},Rt=(e,t)=>e?Dr(B,e,t):"",Et=(e,t)=>{t=fe(t);var o=t==="std::string";ve(e,{name:t,fromWireType(c){var h=S[c>>2],m=c+4,w;if(o)for(var y=m,A=0;A<=h;++A){var C=m+A;if(A==h||B[C]==0){var L=C-y,J=Rt(y,L);w===void 0?w=J:(w+="\0",w+=J),y=C+1}}else{for(var ge=new Array(h),A=0;A<h;++A)ge[A]=String.fromCharCode(B[m+A]);w=ge.join("")}return Pe(c),w},toWireType(c,h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));var m,w=typeof h=="string";w||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int8Array||le("Cannot pass non-string to std::string"),o&&w?m=Tt(h):m=h.length;var y=Vt(4+m+1),A=y+4;if(S[y>>2]=m,o&&w)$t(h,A,m+1);else if(w)for(var C=0;C<m;++C){var L=h.charCodeAt(C);L>255&&(Pe(A),le("String has UTF-16 code units that do not fit in 8 bits")),B[A+C]=L}else for(var C=0;C<m;++C)B[A+C]=h[C];return c!==null&&c.push(Pe,y),y},argPackAdvance:X,readValueFromPointer:Qe,destructorFunction(c){Pe(c)}})},Ct=(e,t)=>{for(var o="",c=0;!(c>=t/2);++c){var h=G[e+c*2>>1];if(h==0)break;o+=String.fromCharCode(h)}return o},St=(e,t,o)=>{if(o??(o=2147483647),o<2)return 0;o-=2;for(var c=t,h=o<e.length*2?o/2:e.length,m=0;m<h;++m){var w=e.charCodeAt(m);G[t>>1]=w,t+=2}return G[t>>1]=0,t-c},Wt=e=>e.length*2,xt=(e,t)=>{for(var o=0,c="";!(o>=t/4);){var h=be[e+o*4>>2];if(h==0)break;if(++o,h>=65536){var m=h-65536;c+=String.fromCharCode(55296|m>>10,56320|m&1023)}else c+=String.fromCharCode(h)}return c},Nr=(e,t,o)=>{if(o??(o=2147483647),o<4)return 0;for(var c=t,h=c+o-4,m=0;m<e.length;++m){var w=e.charCodeAt(m);if(w>=55296&&w<=57343){var y=e.charCodeAt(++m);w=65536+((w&1023)<<10)|y&1023}if(be[t>>2]=w,t+=4,t+4>h)break}return be[t>>2]=0,t-c},Ut=e=>{for(var t=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c>=55296&&c<=57343&&++o,t+=4}return t},Ft=(e,t,o)=>{o=fe(o);var c,h,m,w;t===2?(c=Ct,h=St,w=Wt,m=y=>me[y>>1]):t===4&&(c=xt,h=Nr,w=Ut,m=y=>S[y>>2]),ve(e,{name:o,fromWireType:y=>{for(var A=S[y>>2],C,L=y+4,J=0;J<=A;++J){var ge=y+4+J*t;if(J==A||m(ge)==0){var Ie=ge-L,He=c(L,Ie);C===void 0?C=He:(C+="\0",C+=He),L=ge+t}}return Pe(y),C},toWireType:(y,A)=>{typeof A!="string"&&le(`Cannot pass non-string to C++ string type ${o}`);var C=w(A),L=Vt(4+C+t);return S[L>>2]=C/t,h(A,L+4,C+t),y!==null&&y.push(Pe,L),L},argPackAdvance:X,readValueFromPointer:Qe,destructorFunction(y){Pe(y)}})},kt=(e,t)=>{t=fe(t),ve(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:(o,c)=>{}})},Pt=(e,t,o)=>B.copyWithin(e,t,t+o),rr=[],It=(e,t,o,c)=>(e=rr[e],t=te.toValue(t),e(null,t,o,c)),jt={},Mt=e=>{var t=jt[e];return t===void 0?fe(e):t},Lr=()=>{if(typeof globalThis=="object")return globalThis;function e(t){t.$$$embind_global$$$=t;var o=typeof $$$embind_global$$$=="object"&&t.$$$embind_global$$$==t;return o||delete t.$$$embind_global$$$,o}if(typeof $$$embind_global$$$=="object"||(typeof or=="object"&&e(or)?$$$embind_global$$$=or:typeof self=="object"&&e(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Ot=e=>e===0?te.toHandle(Lr()):(e=Mt(e),te.toHandle(Lr()[e])),Dt=e=>{var t=rr.length;return rr.push(e),t},Nt=(e,t)=>{var o=ue[e];return o===void 0&&le(`${t} has unknown type ${mr(e)}`),o},pr=(e,t)=>{for(var o=new Array(e),c=0;c<e;++c)o[c]=Nt(S[t+c*4>>2],"parameter "+c);return o},$e=Reflect.construct,Hr=(e,t,o)=>{var c=[],h=e.toWireType(c,o);return c.length&&(S[t>>2]=te.toHandle(c)),h},Vr=(e,t,o)=>{var c=pr(e,t),h=c.shift();e--;var m=new Array(e),w=(A,C,L,J)=>{for(var ge=0,Ie=0;Ie<e;++Ie)m[Ie]=c[Ie].readValueFromPointer(J+ge),ge+=c[Ie].argPackAdvance;var He=o===1?$e(C,m):C.apply(A,m);return Hr(h,L,He)},y=`methodCaller<(${c.map(A=>A.name).join(", ")}) => ${h.name}>`;return Dt(Ge(y,w))},tr=e=>{e>9&&(Ae[e+1]+=1)},Br=e=>{var t=te.toValue(e);jr(t),he(e)},n=()=>{Wr("")},a=()=>2147483648,s=e=>{var t=xe.buffer,o=(e-t.byteLength+65535)/65536;try{return xe.grow(o),k(),1}catch{}},f=e=>{var t=B.length;e>>>=0;var o=a();if(e>o)return!1;for(var c=(A,C)=>A+(C-A%C)%C,h=1;h<=4;h*=2){var m=t*(1+.2/h);m=Math.min(m,e+100663296);var w=Math.min(o,c(Math.max(e,m),65536)),y=s(w);if(y)return!0}return!1},d={},g=()=>q||"./this.program",b=()=>{if(!b.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:g()};for(var o in d)d[o]===void 0?delete t[o]:t[o]=d[o];var c=[];for(var o in t)c.push(`${o}=${t[o]}`);b.strings=c}return b.strings},p=(e,t)=>{for(var o=0;o<e.length;++o)ce[t++]=e.charCodeAt(o);ce[t]=0},$=(e,t)=>{var o=0;return b().forEach((c,h)=>{var m=t+o;S[e+h*4>>2]=m,p(c,m),o+=c.length+1}),0},W=(e,t)=>{var o=b();S[e>>2]=o.length;var c=0;return o.forEach(h=>c+=h.length+1),S[t>>2]=c,0},Y=e=>{F(e,new Zr(e))},N=(e,t)=>{Y(e)},ee=N,Se=e=>52;function Xe(e,t,o,c,h){return 70}var We=[null,[],[]],nr=(e,t)=>{var o=We[e];t===0||t===10?((e===1?Q:se)(Dr(o,0)),o.length=0):o.push(t)},Lt=(e,t,o,c)=>{for(var h=0,m=0;m<o;m++){var w=S[t>>2],y=S[t+4>>2];t+=8;for(var A=0;A<y;A++)nr(e,B[w+A]);h+=y}return S[c>>2]=h,0};ur(),qe=r.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},kr=r.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},hr(),gr=r.UnboundTypeError=mt(Error,"UnboundTypeError");var Ht={o:Qr,q:et,m:Ir,l:it,j:Le,f:yt,b:_t,a:wt,e:Et,c:Ft,n:kt,v:Pt,i:It,d:he,k:Ot,h:Vr,y:tr,g:Br,r:n,s:f,t:$,u:W,z:ee,w:Se,p:Xe,x:Lt},ae=xr(),zr=e=>(zr=ae.C)(e),Vt=e=>(Vt=ae.D)(e),Pe=e=>(Pe=ae.E)(e),Zt=e=>(Zt=ae.G)(e);r.dynCall_jiji=(e,t,o,c,h)=>(r.dynCall_jiji=ae.H)(e,t,o,c,h);var qr;Ce=function e(){qr||Qt(),qr||(Ce=e)};function Qt(){if(we>0||(ie(),we>0))return;function e(){qr||(qr=!0,r.calledRun=!0,!De&&(K(),u(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),_e()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),e()},1)):e()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Qt(),R}})();const Cn={preserveOrientation:!1};let Xt;async function Sn(i,l){Xt=Rn(En,i,l)}async function Wn(i,l={}){Xt||Sn();const r={...Cn,...l},v=(await Xt).decode(i,r.preserveOrientation);if(!v)throw new Error("Decoding error");return v}let Oe;const nn=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&nn.decode();let vr=null;function an(){return(vr===null||vr.byteLength===0)&&(vr=new Uint8Array(Oe.memory.buffer)),vr}function xn(i,l){return i=i>>>0,nn.decode(an().subarray(i,i+l))}let yr=null;function Un(){return(yr===null||yr.byteLength===0)&&(yr=new Uint8ClampedArray(Oe.memory.buffer)),yr}function Fn(i,l){return i=i>>>0,Un().subarray(i/1,i/1+l)}const je=new Array(128).fill(void 0);je.push(void 0,null,!0,!1);let Er=je.length;function kn(i){Er===je.length&&je.push(je.length+1);const l=Er;return Er=je[l],je[l]=i,l}let on=0;function Pn(i,l){const r=l(i.length*1,1)>>>0;return an().set(i,r/1),on=i.length,r}function In(i){return je[i]}function jn(i){i<132||(je[i]=Er,Er=i)}function Mn(i){const l=In(i);return jn(i),l}function On(i){const l=Pn(i,Oe.__wbindgen_malloc),r=on,u=Oe.decode(l,r);return Mn(u)}async function Dn(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const r=await i.arrayBuffer();return await WebAssembly.instantiate(r,l)}else{const r=await WebAssembly.instantiate(i,l);return r instanceof WebAssembly.Instance?{instance:r,module:i}:r}}function Nn(){const i={};return i.wbg={},i.wbg.__wbg_newwithownedu8clampedarrayandsh_91db5987993a08fb=function(l,r,u,v){var R=Fn(l,r).slice();Oe.__wbindgen_free(l,r*1,1);const T=new ImageData(R,u>>>0,v>>>0);return kn(T)},i.wbg.__wbindgen_throw=function(l,r){throw new Error(xn(l,r))},i}function Ln(i,l){return Oe=i.exports,sn.__wbindgen_wasm_module=l,vr=null,yr=null,Oe}async function sn(i){if(Oe!==void 0)return Oe;typeof i>"u"&&(i=new URL("/assets/squoosh_png_bg-BsfxGNEB.wasm",import.meta.url));const l=Nn();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:r,module:u}=await Dn(await i,l);return Ln(r,u)}const Hn=globalThis.ServiceWorkerGlobalScope!==void 0,Vn=Hn&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,Bn=typeof Z=="object"&&Z.release&&Z.release.name==="node";(Vn||Bn)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,r,u){this.data=l,this.width=r,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let zt;async function zn(i){return zt||(zt=sn(i)),zt}async function qn(i){await zn();const l=await On(new Uint8Array(i));if(!l)throw new Error("Encoding error.");return l}var Gn=(()=>{var i=import.meta.url;return function(r={}){var r=typeof r<"u"?r:{},u,v;r.ready=new Promise(function(n,a){u=n,v=a});const T=globalThis.ServiceWorkerGlobalScope!==void 0&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,_=typeof Z=="object"&&Z.release&&Z.release.name==="node";(T||_)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(a,s,f){this.data=a,this.width=s,this.height=f}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));var E=Object.assign({},r),U=typeof window=="object",q=typeof importScripts=="function";typeof Z=="object"&&typeof Z.versions=="object"&&Z.versions.node;var F="";function oe(n){return r.locateFile?r.locateFile(n,F):F+n}var P;(U||q)&&(q?F=self.location.href:typeof document<"u"&&document.currentScript&&(F=document.currentScript.src),i&&(F=i),F.indexOf("blob:")!==0?F=F.substr(0,F.replace(/[?#].*/,"").lastIndexOf("/")+1):F="",q&&(P=n=>{var a=new XMLHttpRequest;return a.open("GET",n,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)})),r.print||console.log.bind(console);var M=r.printErr||console.warn.bind(console);Object.assign(r,E),E=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var ne;r.wasmBinary&&(ne=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&ze("no native wasm support detected");var I,Q=!1;function se(n,a,s){for(var f=a+s,d="";!(a>=f);){var g=n[a++];if(!g)return d;if(!(g&128)){d+=String.fromCharCode(g);continue}var b=n[a++]&63;if((g&224)==192){d+=String.fromCharCode((g&31)<<6|b);continue}var p=n[a++]&63;if((g&240)==224?g=(g&15)<<12|b<<6|p:g=(g&7)<<18|b<<12|p<<6|n[a++]&63,g<65536)d+=String.fromCharCode(g);else{var $=g-65536;d+=String.fromCharCode(55296|$>>10,56320|$&1023)}}return d}function Ee(n,a){return n?se(G,n,a):""}function xe(n,a,s,f){if(!(f>0))return 0;for(var d=s,g=s+f-1,b=0;b<n.length;++b){var p=n.charCodeAt(b);if(p>=55296&&p<=57343){var $=n.charCodeAt(++b);p=65536+((p&1023)<<10)|$&1023}if(p<=127){if(s>=g)break;a[s++]=p}else if(p<=2047){if(s+1>=g)break;a[s++]=192|p>>6,a[s++]=128|p&63}else if(p<=65535){if(s+2>=g)break;a[s++]=224|p>>12,a[s++]=128|p>>6&63,a[s++]=128|p&63}else{if(s+3>=g)break;a[s++]=240|p>>18,a[s++]=128|p>>12&63,a[s++]=128|p>>6&63,a[s++]=128|p&63}}return a[s]=0,s-d}function De(n,a,s){return xe(n,G,a,s)}function ce(n){for(var a=0,s=0;s<n.length;++s){var f=n.charCodeAt(s);f<=127?a++:f<=2047?a+=2:f>=55296&&f<=57343?(a+=4,++s):a+=3}return a}var B,G,me,be,S,z,O,k;function j(){var n=I.buffer;r.HEAP8=B=new Int8Array(n),r.HEAP16=me=new Int16Array(n),r.HEAP32=S=new Int32Array(n),r.HEAPU8=G=new Uint8Array(n),r.HEAPU16=be=new Uint16Array(n),r.HEAPU32=z=new Uint32Array(n),r.HEAPF32=O=new Float32Array(n),r.HEAPF64=k=new Float64Array(n)}var D,V=[],ie=[],K=[];function _e(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Ne(r.preRun.shift());fr(V)}function de(){fr(ie)}function Ve(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Ce(r.postRun.shift());fr(K)}function Ne(n){V.unshift(n)}function we(n){ie.unshift(n)}function Ce(n){K.unshift(n)}var Ue=0,Be=null;function Wr(n){Ue++,r.monitorRunDependencies&&r.monitorRunDependencies(Ue)}function Yr(n){if(Ue--,r.monitorRunDependencies&&r.monitorRunDependencies(Ue),Ue==0&&Be){var a=Be;Be=null,a()}}function ze(n){r.onAbort&&r.onAbort(n),n="Aborted("+n+")",M(n),Q=!0,n+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(n);throw v(a),a}var Fe="data:application/octet-stream;base64,";function sr(n){return n.startsWith(Fe)}var ke;r.locateFile?(ke="webp_dec.wasm",sr(ke)||(ke=oe(ke))):ke=new URL("/assets/webp_dec-C990n7mh.wasm",import.meta.url).href;function lr(n){try{if(n==ke&&ne)return new Uint8Array(ne);if(P)return P(n);throw"both async and sync fetching of the wasm failed"}catch(a){ze(a)}}function Jr(n){return!ne&&(U||q)&&typeof fetch=="function"?fetch(n,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+n+"'";return a.arrayBuffer()}).catch(function(){return lr(n)}):Promise.resolve().then(function(){return lr(n)})}function xr(n,a,s){return Jr(n).then(function(f){return WebAssembly.instantiate(f,a)}).then(function(f){return f}).then(s,function(f){M("failed to asynchronously prepare wasm: "+f),ze(f)})}function Zr(n,a,s,f){return!n&&typeof WebAssembly.instantiateStreaming=="function"&&!sr(a)&&typeof fetch=="function"?fetch(a,{credentials:"same-origin"}).then(function(d){var g=WebAssembly.instantiateStreaming(d,s);return g.then(f,function(b){return M("wasm streaming compile failed: "+b),M("falling back to ArrayBuffer instantiation"),xr(a,s,f)})}):xr(a,s,f)}function cr(){var n={a:Nt};function a(f,d){var g=f.exports;return r.asm=g,I=r.asm.s,j(),D=r.asm.y,we(r.asm.t),Yr(),g}Wr();function s(f){a(f.instance)}if(r.instantiateWasm)try{return r.instantiateWasm(n,a)}catch(f){M("Module.instantiateWasm callback failed with error: "+f),v(f)}return Zr(ne,ke,n,s).catch(v),{}}function fr(n){for(;n.length>0;)n.shift()(r)}function Ur(n){this.excPtr=n,this.ptr=n-24,this.set_type=function(a){z[this.ptr+4>>2]=a},this.get_type=function(){return z[this.ptr+4>>2]},this.set_destructor=function(a){z[this.ptr+8>>2]=a},this.get_destructor=function(){return z[this.ptr+8>>2]},this.set_refcount=function(a){S[this.ptr>>2]=a},this.set_caught=function(a){a=a?1:0,B[this.ptr+12>>0]=a},this.get_caught=function(){return B[this.ptr+12>>0]!=0},this.set_rethrown=function(a){a=a?1:0,B[this.ptr+13>>0]=a},this.get_rethrown=function(){return B[this.ptr+13>>0]!=0},this.init=function(a,s){this.set_adjusted_ptr(0),this.set_type(a),this.set_destructor(s),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var a=S[this.ptr>>2];S[this.ptr>>2]=a+1},this.release_ref=function(){var a=S[this.ptr>>2];return S[this.ptr>>2]=a-1,a===1},this.set_adjusted_ptr=function(a){z[this.ptr+16>>2]=a},this.get_adjusted_ptr=function(){return z[this.ptr+16>>2]},this.get_exception_ptr=function(){var a=Vr(this.get_type());if(a)return z[this.excPtr>>2];var s=this.get_adjusted_ptr();return s!==0?s:this.excPtr}}function Qr(n,a,s){var f=new Ur(n);throw f.init(a,s),n}function et(n,a,s,f,d){}function ur(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}function Fr(){for(var n=new Array(256),a=0;a<256;++a)n[a]=String.fromCharCode(a);fe=n}var fe=void 0;function re(n){for(var a="",s=n;G[s];)a+=fe[G[s++]];return a}var ue={},pe={},qe={},le=48,kr=57;function Pr(n){if(n===void 0)return"_unknown";n=n.replace(/[^a-zA-Z0-9_]/g,"$");var a=n.charCodeAt(0);return a>=le&&a<=kr?"_"+n:n}function rt(n,a){return n=Pr(n),{[n]:function(){return a.apply(this,arguments)}}[n]}function dr(n,a){var s=rt(a,function(f){this.name=a,this.message=f;var d=new Error(f).stack;d!==void 0&&(this.stack=this.toString()+`
`+d.replace(/^Error(:[^\n]*)?\n/,""))});return s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},s}var ve=void 0;function X(n){throw new ve(n)}var Ir=void 0;function Ze(n){throw new Ir(n)}function Ae(n,a,s){n.forEach(function(p){qe[p]=a});function f(p){var $=s(p);$.length!==n.length&&Ze("Mismatched type converter count");for(var W=0;W<n.length;++W)he(n[W],$[W])}var d=new Array(a.length),g=[],b=0;a.forEach((p,$)=>{pe.hasOwnProperty(p)?d[$]=pe[p]:(g.push(p),ue.hasOwnProperty(p)||(ue[p]=[]),ue[p].push(()=>{d[$]=pe[p],++b,b===g.length&&f(d)}))}),g.length===0&&f(d)}function he(n,a,s={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");var f=a.name;if(n||X('type "'+f+'" must have a positive integer typeid pointer'),pe.hasOwnProperty(n)){if(s.ignoreDuplicateRegistrations)return;X("Cannot register type '"+f+"' twice")}if(pe[n]=a,delete qe[n],ue.hasOwnProperty(n)){var d=ue[n];delete ue[n],d.forEach(g=>g())}}function tt(n,a,s,f,d){var g=ur(s);a=re(a),he(n,{name:a,fromWireType:function(b){return!!b},toWireType:function(b,p){return p?f:d},argPackAdvance:8,readValueFromPointer:function(b){var p;if(s===1)p=B;else if(s===2)p=me;else if(s===4)p=S;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType(p[b>>g])},destructorFunction:null})}var hr=[],te=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Qe(n){n>4&&--te[n].refcount===0&&(te[n]=void 0,hr.push(n))}function nt(){for(var n=0,a=5;a<te.length;++a)te[a]!==void 0&&++n;return n}function it(){for(var n=5;n<te.length;++n)if(te[n]!==void 0)return te[n];return null}function at(){r.count_emval_handles=nt,r.get_first_emval=it}var Le={toValue:n=>(n||X("Cannot use deleted val. handle = "+n),te[n].value),toHandle:n=>{switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var a=hr.length?hr.pop():te.length;return te[a]={refcount:1,value:n},a}}}};function Ge(n){return this.fromWireType(S[n>>2])}function jr(n,a){a=re(a),he(n,{name:a,fromWireType:function(s){var f=Le.toValue(s);return Qe(s),f},toWireType:function(s,f){return Le.toHandle(f)},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:null})}function ot(n,a){switch(a){case 2:return function(s){return this.fromWireType(O[s>>2])};case 3:return function(s){return this.fromWireType(k[s>>3])};default:throw new TypeError("Unknown float type: "+n)}}function st(n,a,s){var f=ur(s);a=re(a),he(n,{name:a,fromWireType:function(d){return d},toWireType:function(d,g){return g},argPackAdvance:8,readValueFromPointer:ot(a,f),destructorFunction:null})}function lt(n){for(;n.length;){var a=n.pop(),s=n.pop();s(a)}}function ct(n,a,s,f,d,g){var b=a.length;b<2&&X("argTypes array size mismatch! Must at least get return value and 'this' types!"),a[1];for(var p=!1,$=1;$<a.length;++$)if(a[$]!==null&&a[$].destructorFunction===void 0){p=!0;break}var W=a[0].name!=="void",Y=b-2,N=new Array(Y),ee=[],Se=[];return function(){arguments.length!==Y&&X("function "+n+" called with "+arguments.length+" arguments, expected "+Y+" args!"),Se.length=0;var Xe;ee.length=1,ee[0]=d;for(var We=0;We<Y;++We)N[We]=a[We+2].toWireType(Se,arguments[We]),ee.push(N[We]);var nr=f.apply(null,ee);function Lt(Ht){if(p)lt(Se);else for(var ae=2;ae<a.length;ae++){var zr=ae===1?Xe:N[ae-2];a[ae].destructorFunction!==null&&a[ae].destructorFunction(zr)}if(W)return a[0].fromWireType(Ht)}return Lt(nr)}}function ft(n,a,s){if(n[a].overloadTable===void 0){var f=n[a];n[a]=function(){return n[a].overloadTable.hasOwnProperty(arguments.length)||X("Function '"+s+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+n[a].overloadTable+")!"),n[a].overloadTable[arguments.length].apply(this,arguments)},n[a].overloadTable=[],n[a].overloadTable[f.argCount]=f}}function ut(n,a,s){r.hasOwnProperty(n)?((s===void 0||r[n].overloadTable!==void 0&&r[n].overloadTable[s]!==void 0)&&X("Cannot register public name '"+n+"' twice"),ft(r,n,n),r.hasOwnProperty(s)&&X("Cannot register multiple overloads of a function with the same number of arguments ("+s+")!"),r[n].overloadTable[s]=a):(r[n]=a,s!==void 0&&(r[n].numArguments=s))}function dt(n,a){for(var s=[],f=0;f<n;f++)s.push(z[a+f*4>>2]);return s}function er(n,a,s){r.hasOwnProperty(n)||Ze("Replacing nonexistant public symbol"),r[n].overloadTable!==void 0&&s!==void 0?r[n].overloadTable[s]=a:(r[n]=a,r[n].argCount=s)}function Mr(n,a,s){var f=r["dynCall_"+n];return s&&s.length?f.apply(null,[a].concat(s)):f.call(null,a)}var Ke=[];function Or(n){var a=Ke[n];return a||(n>=Ke.length&&(Ke.length=n+1),Ke[n]=a=D.get(n)),a}function ht(n,a,s){if(n.includes("j"))return Mr(n,a,s);var f=Or(a).apply(null,s);return f}function gt(n,a){var s=[];return function(){return s.length=0,Object.assign(s,arguments),ht(n,a,s)}}function mt(n,a){n=re(n);function s(){return n.includes("j")?gt(n,a):Or(a)}var f=s();return typeof f!="function"&&X("unknown function pointer with signature "+n+": "+a),f}var gr=void 0;function mr(n){var a=Hr(n),s=re(a);return $e(a),s}function pt(n,a){var s=[],f={};function d(g){if(!f[g]&&!pe[g]){if(qe[g]){qe[g].forEach(d);return}s.push(g),f[g]=!0}}throw a.forEach(d),new gr(n+": "+s.map(mr).join([", "]))}function vt(n,a,s,f,d,g,b){var p=dt(a,s);n=re(n),d=mt(f,d),ut(n,function(){pt("Cannot call "+n+" due to unbound types",p)},a-1),Ae([],p,function($){var W=[$[0],null].concat($.slice(1));return er(n,ct(n,W,null,d,g),a-1),[]})}function yt(n,a,s){switch(a){case 0:return s?function(d){return B[d]}:function(d){return G[d]};case 1:return s?function(d){return me[d>>1]}:function(d){return be[d>>1]};case 2:return s?function(d){return S[d>>2]}:function(d){return z[d>>2]};default:throw new TypeError("Unknown integer type: "+n)}}function bt(n,a,s,f,d){a=re(a);var g=ur(s),b=N=>N;if(f===0){var p=32-8*s;b=N=>N<<p>>>p}var $=a.includes("unsigned"),W=(N,ee)=>{},Y;$?Y=function(N,ee){return W(ee,this.name),ee>>>0}:Y=function(N,ee){return W(ee,this.name),ee},he(n,{name:a,fromWireType:b,toWireType:Y,argPackAdvance:8,readValueFromPointer:yt(a,g,f!==0),destructorFunction:null})}function _t(n,a,s){var f=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],d=f[a];function g(b){b=b>>2;var p=z,$=p[b],W=p[b+1];return new d(p.buffer,W,$)}s=re(s),he(n,{name:s,fromWireType:g,argPackAdvance:8,readValueFromPointer:g},{ignoreDuplicateRegistrations:!0})}function wt(n,a){a=re(a);var s=a==="std::string";he(n,{name:a,fromWireType:function(f){var d=z[f>>2],g=f+4,b;if(s)for(var p=g,$=0;$<=d;++$){var W=g+$;if($==d||G[W]==0){var Y=W-p,N=Ee(p,Y);b===void 0?b=N:(b+="\0",b+=N),p=W+1}}else{for(var ee=new Array(d),$=0;$<d;++$)ee[$]=String.fromCharCode(G[g+$]);b=ee.join("")}return $e(f),b},toWireType:function(f,d){d instanceof ArrayBuffer&&(d=new Uint8Array(d));var g,b=typeof d=="string";b||d instanceof Uint8Array||d instanceof Uint8ClampedArray||d instanceof Int8Array||X("Cannot pass non-string to std::string"),s&&b?g=ce(d):g=d.length;var p=pr(4+g+1),$=p+4;if(z[p>>2]=g,s&&b)De(d,$,g+1);else if(b)for(var W=0;W<g;++W){var Y=d.charCodeAt(W);Y>255&&($e($),X("String has UTF-16 code units that do not fit in 8 bits")),G[$+W]=Y}else for(var W=0;W<g;++W)G[$+W]=d[W];return f!==null&&f.push($e,p),p},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:function(f){$e(f)}})}function At(n,a){for(var s="",f=0;!(f>=a/2);++f){var d=me[n+f*2>>1];if(d==0)break;s+=String.fromCharCode(d)}return s}function $t(n,a,s){if(s===void 0&&(s=2147483647),s<2)return 0;s-=2;for(var f=a,d=s<n.length*2?s/2:n.length,g=0;g<d;++g){var b=n.charCodeAt(g);me[a>>1]=b,a+=2}return me[a>>1]=0,a-f}function Tt(n){return n.length*2}function Dr(n,a){for(var s=0,f="";!(s>=a/4);){var d=S[n+s*4>>2];if(d==0)break;if(++s,d>=65536){var g=d-65536;f+=String.fromCharCode(55296|g>>10,56320|g&1023)}else f+=String.fromCharCode(d)}return f}function Rt(n,a,s){if(s===void 0&&(s=2147483647),s<4)return 0;for(var f=a,d=f+s-4,g=0;g<n.length;++g){var b=n.charCodeAt(g);if(b>=55296&&b<=57343){var p=n.charCodeAt(++g);b=65536+((b&1023)<<10)|p&1023}if(S[a>>2]=b,a+=4,a+4>d)break}return S[a>>2]=0,a-f}function Et(n){for(var a=0,s=0;s<n.length;++s){var f=n.charCodeAt(s);f>=55296&&f<=57343&&++s,a+=4}return a}function Ct(n,a,s){s=re(s);var f,d,g,b,p;a===2?(f=At,d=$t,b=Tt,g=()=>be,p=1):a===4&&(f=Dr,d=Rt,b=Et,g=()=>z,p=2),he(n,{name:s,fromWireType:function($){for(var W=z[$>>2],Y=g(),N,ee=$+4,Se=0;Se<=W;++Se){var Xe=$+4+Se*a;if(Se==W||Y[Xe>>p]==0){var We=Xe-ee,nr=f(ee,We);N===void 0?N=nr:(N+="\0",N+=nr),ee=Xe+a}}return $e($),N},toWireType:function($,W){typeof W!="string"&&X("Cannot pass non-string to C++ string type "+s);var Y=b(W),N=pr(4+Y+a);return z[N>>2]=Y>>p,d(W,N+4,Y+a),$!==null&&$.push($e,N),N},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:function($){$e($)}})}function St(n,a){a=re(a),he(n,{isVoid:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(s,f){}})}var Wt={};function xt(n){var a=Wt[n];return a===void 0?re(n):a}function Nr(){if(typeof globalThis=="object")return globalThis;function n(a){a.$$$embind_global$$$=a;var s=typeof $$$embind_global$$$=="object"&&a.$$$embind_global$$$==a;return s||delete a.$$$embind_global$$$,s}if(typeof $$$embind_global$$$=="object"||(typeof or=="object"&&n(or)?$$$embind_global$$$=or:typeof self=="object"&&n(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")}function Ut(n){return n===0?Le.toHandle(Nr()):(n=xt(n),Le.toHandle(Nr()[n]))}function Ft(n){n>4&&(te[n].refcount+=1)}function kt(n,a){var s=pe[n];return s===void 0&&X(a+" has unknown type "+mr(n)),s}function Pt(n){var a=new Array(n+1);return function(s,f,d){a[0]=s;for(var g=0;g<n;++g){var b=kt(z[f+g*4>>2],"parameter "+g);a[g+1]=b.readValueFromPointer(d),d+=b.argPackAdvance}var p=new(s.bind.apply(s,a));return Le.toHandle(p)}}var rr={};function It(n,a,s,f){n=Le.toValue(n);var d=rr[a];return d||(d=Pt(a),rr[a]=d),d(n,s,f)}function jt(){ze("")}function Mt(n,a,s){G.copyWithin(n,a,a+s)}function Lr(){return 2147483648}function Ot(n){var a=I.buffer;try{return I.grow(n-a.byteLength+65535>>>16),j(),1}catch{}}function Dt(n){var a=G.length;n=n>>>0;var s=Lr();if(n>s)return!1;let f=($,W)=>$+(W-$%W)%W;for(var d=1;d<=4;d*=2){var g=a*(1+.2/d);g=Math.min(g,n+100663296);var b=Math.min(s,f(Math.max(n,g),65536)),p=Ot(b);if(p)return!0}return!1}Fr(),ve=r.BindingError=dr(Error,"BindingError"),Ir=r.InternalError=dr(Error,"InternalError"),at(),gr=r.UnboundTypeError=dr(Error,"UnboundTypeError");var Nt={n:Qr,o:et,l:tt,r:jr,k:st,c:vt,b:bt,a:_t,g:wt,f:Ct,m:St,d:Qe,e:Ut,i:Ft,h:It,j:jt,q:Mt,p:Dt};cr();var pr=function(){return(pr=r.asm.u).apply(null,arguments)},$e=function(){return($e=r.asm.v).apply(null,arguments)},Hr=r.___getTypeName=function(){return(Hr=r.___getTypeName=r.asm.w).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.x).apply(null,arguments)};var Vr=function(){return(Vr=r.asm.z).apply(null,arguments)},tr;Be=function n(){tr||Br(),tr||(Be=n)};function Br(){if(Ue>0||(_e(),Ue>0))return;function n(){tr||(tr=!0,r.calledRun=!0,!Q&&(de(),u(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Ve()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),n()},1)):n()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Br(),r.ready}})();function Yt(i,l,r={}){return i({noInitialRun:!0,instantiateWasm:void 0,...r})}let Jt;async function Kn(i,l){Jt=Yt(Gn,i,l)}async function Xn(i){Jt||Kn();const r=(await Jt).decode(i);if(!r)throw new Error("Decoding error");return r}const Yn={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0},Jn=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));let Je;async function Zn(i,l){if(await Jn()){const u=await en(()=>import("./webp_enc_simd-DusA0kJf.js"),__vite__mapDeps([0,1,2]));return Je=Yt(u.default,i,l),Je}const r=await en(()=>import("./webp_enc-CJZuSIRu.js"),__vite__mapDeps([3,1,2]));return Je=Yt(r.default,i,l),Je}async function Qn(i,l={}){Je||(Je=Zn());const r={...Yn,...l},v=(await Je).encode(i.data,i.width,i.height,r);if(!v)throw new Error("Encoding error.");return v.buffer}function ei(i,l,r,u){const v=i/l,R=r/u;if(R>v){const E=i/R,U=(l-E)/2;return{sw:i,sh:E,sx:0,sy:U}}const T=l*R,_=(i-T)/2;return{sh:l,sw:T,sx:_,sy:0}}let ye,br=null;function ri(){return(br===null||br.byteLength===0)&&(br=new Uint8Array(ye.memory.buffer)),br}let ln=0;function ti(i,l){const r=l(i.length*1,1)>>>0;return ri().set(i,r/1),ln=i.length,r}let _r=null;function rn(){return(_r===null||_r.byteLength===0)&&(_r=new Int32Array(ye.memory.buffer)),_r}let wr=null;function ni(){return(wr===null||wr.byteLength===0)&&(wr=new Uint8ClampedArray(ye.memory.buffer)),wr}function ii(i,l){return i=i>>>0,ni().subarray(i/1,i/1+l)}function ai(i,l,r,u,v,R,T,_){try{const F=ye.__wbindgen_add_to_stack_pointer(-16),oe=ti(i,ye.__wbindgen_malloc),P=ln;ye.resize(F,oe,P,l,r,u,v,R,T,_);var E=rn()[F/4+0],U=rn()[F/4+1],q=ii(E,U).slice();return ye.__wbindgen_free(E,U*1,1),q}finally{ye.__wbindgen_add_to_stack_pointer(16)}}async function oi(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const r=await i.arrayBuffer();return await WebAssembly.instantiate(r,l)}else{const r=await WebAssembly.instantiate(i,l);return r instanceof WebAssembly.Instance?{instance:r,module:i}:r}}function si(){const i={};return i.wbg={},i}function li(i,l){return ye=i.exports,cn.__wbindgen_wasm_module=l,_r=null,br=null,wr=null,ye}async function cn(i){if(ye!==void 0)return ye;typeof i>"u"&&(i=new URL("/assets/squoosh_resize_bg-YY9xfwUg.wasm",import.meta.url));const l=si();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:r,module:u}=await oi(await i,l);return li(r,u)}const ci=globalThis.ServiceWorkerGlobalScope!==void 0,fi=ci&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,ui=typeof Z=="object"&&Z.release&&Z.release.name==="node";(fi||ui)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,r,u){this.data=l,this.width=r,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let Te,Ar=null;function fn(){return(Ar===null||Ar.byteLength===0)&&(Ar=new Uint32Array(Te.memory.buffer)),Ar}let un=0;function di(i,l){const r=l(i.length*4,4)>>>0;return fn().set(i,r/4),un=i.length,r}let $r=null;function tn(){return($r===null||$r.byteLength===0)&&($r=new Int32Array(Te.memory.buffer)),$r}function hi(i,l){return i=i>>>0,fn().subarray(i/4,i/4+l)}function gi(i,l,r,u){try{const _=Te.__wbindgen_add_to_stack_pointer(-16),E=di(i,Te.__wbindgen_malloc),U=un;Te.resize(_,E,U,l,r,u);var v=tn()[_/4+0],R=tn()[_/4+1],T=hi(v,R).slice();return Te.__wbindgen_free(v,R*4,4),T}finally{Te.__wbindgen_add_to_stack_pointer(16)}}async function mi(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const r=await i.arrayBuffer();return await WebAssembly.instantiate(r,l)}else{const r=await WebAssembly.instantiate(i,l);return r instanceof WebAssembly.Instance?{instance:r,module:i}:r}}function pi(){const i={};return i.wbg={},i}function vi(i,l){return Te=i.exports,dn.__wbindgen_wasm_module=l,$r=null,Ar=null,Te}async function dn(i){if(Te!==void 0)return Te;typeof i>"u"&&(i=new URL("/assets/squooshhqx_bg-jpRtGvMp.wasm",import.meta.url));const l=pi();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:r,module:u}=await mi(await i,l);return vi(r,u)}const yi=globalThis.ServiceWorkerGlobalScope!==void 0,bi=yi&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,_i=typeof Z=="object"&&Z.release&&Z.release.name==="node";(bi||_i)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,r,u){this.data=l,this.width=r,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let Re,Tr=null;function wi(){return(Tr===null||Tr.byteLength===0)&&(Tr=new Uint8ClampedArray(Re.memory.buffer)),Tr}function Ai(i,l){return i=i>>>0,wi().subarray(i/1,i/1+l)}const Me=new Array(128).fill(void 0);Me.push(void 0,null,!0,!1);let Cr=Me.length;function $i(i){Cr===Me.length&&Me.push(Me.length+1);const l=Cr;return Cr=Me[l],Me[l]=i,l}let Rr=null;function Gr(){return(Rr===null||Rr.byteLength===0)&&(Rr=new Uint8Array(Re.memory.buffer)),Rr}let Sr=0;function Ti(i,l){const r=l(i.length*1,1)>>>0;return Gr().set(i,r/1),Sr=i.length,r}const Kr=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Ri=typeof Kr.encodeInto=="function"?function(i,l){return Kr.encodeInto(i,l)}:function(i,l){const r=Kr.encode(i);return l.set(r),{read:i.length,written:r.length}};function Ei(i,l,r){if(r===void 0){const _=Kr.encode(i),E=l(_.length,1)>>>0;return Gr().subarray(E,E+_.length).set(_),Sr=_.length,E}let u=i.length,v=l(u,1)>>>0;const R=Gr();let T=0;for(;T<u;T++){const _=i.charCodeAt(T);if(_>127)break;R[v+T]=_}if(T!==u){T!==0&&(i=i.slice(T)),v=r(v,u,u=T+i.length*3,1)>>>0;const _=Gr().subarray(v+T,v+u),E=Ri(i,_);T+=E.written,v=r(v,u,T,1)>>>0}return Sr=T,v}function Ci(i){return Me[i]}function Si(i){i<132||(Me[i]=Cr,Cr=i)}function Wi(i){const l=Ci(i);return Si(i),l}function xi(i,l,r,u,v,R){const T=Ti(i,Re.__wbindgen_malloc),_=Sr,E=Ei(R,Re.__wbindgen_malloc,Re.__wbindgen_realloc),U=Sr,q=Re.resize(T,_,l,r,u,v,E,U);return Wi(q)}async function Ui(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const r=await i.arrayBuffer();return await WebAssembly.instantiate(r,l)}else{const r=await WebAssembly.instantiate(i,l);return r instanceof WebAssembly.Instance?{instance:r,module:i}:r}}function Fi(){const i={};return i.wbg={},i.wbg.__wbg_newwithownedu8clampedarrayandsh_2ac355435db12a85=function(l,r,u,v){var R=Ai(l,r).slice();Re.__wbindgen_free(l,r*1,1);const T=new ImageData(R,u>>>0,v>>>0);return $i(T)},i}function ki(i,l){return Re=i.exports,hn.__wbindgen_wasm_module=l,Rr=null,Tr=null,Re}async function hn(i){if(Re!==void 0)return Re;typeof i<"u"&&(Object.getPrototypeOf(i)===Object.prototype?{module_or_path:i}=i:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof i>"u"&&(i=new URL("/assets/jsquash_magic_kernel_bg-CM70fO1F.wasm",import.meta.url));const l=Fi();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:r,module:u}=await Ui(await i,l);return ki(r,u)}const Pi={width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0},Ii=["magicKernel","magicKernelSharp2013","magicKernelSharp2021"];let Xr,qt,Gt;function ji(i){return Xr||(Xr=cn(i)),Xr}function Mi(i){return qt||(qt=dn(i)),qt}function Oi(i){return Gt||(Gt=hn(i)),Gt}function Di(i){return i.method==="hqx"}function Ni(i){return Ii.includes(i.method)}function Li(i,l,r,u,v){const R=new Uint32Array(i.data.buffer);for(let T=0;T<v;T+=1){const _=(T+r)*i.width+l;R.copyWithin(T*u,_,_+u)}return new ImageData(new Uint8ClampedArray(R.buffer.slice(0,u*v*4)),u,v)}function Hi(i,{min:l=Number.MIN_VALUE,max:r=Number.MAX_VALUE}){return Math.min(Math.max(i,l),r)}const Vi=["triangle","catrom","mitchell","lanczos3"];async function Bi(i,l){await Mi();const r=l.width/i.width,u=l.height/i.height,v=Math.max(r,u),R=Hi(Math.ceil(v),{min:1,max:4});if(R===1)return i;const T=gi(new Uint32Array(i.data.buffer),i.width,i.height,R);return new ImageData(new Uint8ClampedArray(T.buffer),i.width*R,i.height*R)}async function zi(i,l){return await Oi(),xi(new Uint8Array(i.data.buffer),i.width,i.height,l.width,l.height,l.method)}async function qi(i,l){let r={...Pi,...l},u=i;if(ji(),Di(r)&&(u=await Bi(u,r),r={...r,method:"catrom"}),await Xr,r.fitMethod==="contain"){const{sx:R,sy:T,sw:_,sh:E}=ei(i.width,i.height,r.width,r.height);u=Li(u,Math.round(R),Math.round(T),Math.round(_),Math.round(E))}if(Ni(r))return zi(u,r);const v=ai(new Uint8Array(u.data.buffer),u.width,u.height,r.width,r.height,Vi.indexOf(r.method),r.premultiply,r.linearRGB);return new ImageData(new Uint8ClampedArray(v.buffer),r.width,r.height)}const Gi={primaryLogo:{width:600,height:120},secondaryLogo:{width:120,height:120},favicon:{width:96,height:96},pnlPoster:{width:960,height:540},banner:{width:1200,height:630},logo:{width:400,height:400}};function Ki(i,l){const u=new OffscreenCanvas(l.width,l.height).getContext("2d");if(!u)throw new Error("Could not create canvas context for cropping");const v=new OffscreenCanvas(i.width,i.height),R=v.getContext("2d");if(!R)throw new Error("Could not create source canvas context");return R.putImageData(i,0,0),u.drawImage(v,l.x,l.y,l.width,l.height,0,0,l.width,l.height),u.getImageData(0,0,l.width,l.height)}async function Xi(i,l){let r;switch(i){case"jpeg":r=await Wn(l);break;case"png":r=await qn(l);break;case"webp":r=await Xn(l);break;default:throw new Error(`Unknown source type: ${i}`)}return r}async function Yi(i){return Qn(i,{quality:80})}function Ji(i){return new Promise((l,r)=>{const u=new Image;u.onload=()=>{l({width:u.width,height:u.height})},u.onerror=()=>{r(new Error("Failed to load image for dimension calculation"))},u.src=i})}function Zi(i){return new Promise(l=>{var u;const r=(u=i.clipboardData)==null?void 0:u.items;if(!r){l(null);return}for(let v=0;v<r.length;v++)if(r[v].type.indexOf("image")!==-1){const R=r[v].getAsFile();if(!R){l(null);return}const T=new FileReader;T.onload=_=>{var U;const E=(U=_.target)==null?void 0:U.result;l(typeof E=="string"?E:null)},T.onerror=()=>l(null),T.readAsDataURL(R);return}l(null)})}async function Qi(i,l,r,u="contain",v){try{const R=i.replace(/^data:[^,]+,/,""),T=Uint8Array.from(atob(R),F=>F.charCodeAt(0));let _;if(i.includes("image/png"))_="png";else if(i.includes("image/jpeg"))_="jpeg";else if(i.includes("image/webp"))_="webp";else throw new Error("Unsupported image format. Please use JPEG, PNG, or WebP.");let E=await Xi(_,T);v&&v.width>0&&v.height>0&&(E=Ki(E,v));const U=l&&r?await qi(E,{width:l,height:r,fitMethod:u}):E,q=await Yi(U);return new Blob([q],{type:"image/webp"})}catch(R){throw console.error("Error processing image:",R),new Error(`Failed to process image: ${R instanceof Error?R.message:String(R)}`)}}function pa({id:i,label:l,value:r,onChange:u,imageType:v,helpText:R}){const{openModal:T}=$n(),[_,E]=H.useState(!1),[U,q]=H.useState(null),[F,oe]=H.useState(!1),P=H.useRef(null),M=H.useRef(null),ne=H.useRef(null),I=H.useRef(null),Q=Gi[v],se=v==="secondaryLogo"||v==="favicon"||v==="logo",Ee=v==="pnlPoster";H.useEffect(()=>{if(U&&URL.revokeObjectURL(U),r){const O=URL.createObjectURL(r);q(O)}else q(null);return()=>{U&&URL.revokeObjectURL(U)}},[r]);const xe=H.useCallback(async(O,k,j)=>{E(!0);try{const D=(j==null?void 0:j.width)||Q.width,V=(j==null?void 0:j.height)||Q.height;let ie=D,K=V;const _e=D>Q.width,de=V>Q.height;if(_e||de){const Ne=Q.width/D,we=Q.height/V,Ce=Math.min(Ne,we);ie=Math.round(D*Ce),K=Math.round(V*Ce)}const Ve=await Qi(O,ie,K,"contain",k);u(Ve)}catch(D){console.error("Image processing error:",D),Ye.error("Failed to process image. Please try again.")}finally{E(!1)}},[Q,u]),De=H.useCallback(async O=>{if(!O){console.error("No image data provided"),Ye.error("No image data provided. Please try again."),E(!1);return}P.current=O;try{const k=await Ji(O);M.current=k;let j;if(v==="primaryLogo")j={x:0,y:0,width:k.width,height:k.height};else if(v==="pnlPoster"){const V=1.7777777777777777;let ie=k.width,K=k.width/V;K>k.height&&(K=k.height,ie=k.height*V);const _e=Math.max(0,(k.width-ie)/2),de=Math.max(0,(k.height-K)/2);j={x:Math.round(_e),y:Math.round(de),width:Math.round(ie),height:Math.round(K)}}else if(v==="banner")j={x:0,y:0,width:k.width,height:k.height};else{const V=Math.min(k.width,k.height);j={x:0,y:0,width:V,height:V}}T("imageCrop",{imageSource:O,originalDimensions:k,initialCrop:j,targetDimensions:Q,enforceSquare:se,enforce16by9:Ee,onApply:async(V,ie)=>{const K=P.current;if(!K){console.error("Missing original image source");return}if(V.width<=0||V.height<=0){console.error("Invalid crop dimensions");return}await xe(K,V,ie)}}),E(!1)}catch(k){console.error("Error getting image dimensions or processing image:",k),Ye.error("Could not process image. Please ensure it\\'s a valid image file."),E(!1)}},[T,xe,v,se,Ee]),ce=H.useCallback(async O=>{var k;if(!_){E(!0);try{let j=null;if(O){let D;"nativeEvent"in O?(O.preventDefault(),D=O.nativeEvent):(O.preventDefault(),D=O),j=await Zi(D)}else try{const D=await navigator.clipboard.read();for(const V of D){for(const ie of V.types)if(ie.startsWith("image/")){const K=await V.getType(ie);j=await new Promise(_e=>{const de=new FileReader;de.onload=Ve=>{var Ne;return _e(((Ne=Ve.target)==null?void 0:Ne.result)||null)},de.readAsDataURL(K)});break}if(j)break}}catch(D){console.error("Clipboard API error:",D),Ye.error("Could not access clipboard. Please try using Ctrl+V or ⌘+V directly in the paste area."),(k=ne.current)==null||k.focus(),E(!1);return}if(!j){console.error("No image found in clipboard"),Ye.error("No image found in clipboard. Please copy an image first."),E(!1);return}await De(j)}catch(j){console.error("Image paste error:",j),E(!1)}}},[_,De]),B=async O=>{var j;if(_)return;const k=(j=O.target.files)==null?void 0:j[0];if(k){E(!0);try{const D=await new Promise((V,ie)=>{const K=new FileReader;K.onload=_e=>{var de;return V((de=_e.target)==null?void 0:de.result)},K.onerror=ie,K.readAsDataURL(k)});D?await De(D):(Ye.error("Could not read the selected image file."),E(!1))}catch(D){console.error("File selection error:",D),Ye.error("Failed to load the selected image. Please try again."),E(!1)}I.current&&(I.current.value="")}},G=()=>{P.current=null,M.current=null,u(null)},me=()=>oe(!0),be=()=>oe(!1),S=async()=>{await ce()},z=()=>{I.current&&I.current.click()};return x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("label",{htmlFor:i,className:"block text-sm font-bold text-gray-200",children:l}),U&&x.jsx("button",{type:"button",onClick:G,className:"text-xs text-error hover:text-error/70 transition-colors",disabled:_,children:"Clear"})]}),x.jsx("div",{className:"mt-1",children:U?x.jsxs("div",{className:"relative group border border-light/15 rounded-lg p-2 flex justify-center items-center bg-base-8/30 min-h-[150px]",children:[x.jsx("img",{src:U,alt:`${v} preview`,className:"max-h-40 max-w-full object-contain rounded"}),x.jsx("button",{onClick:G,className:"absolute top-1.5 right-1.5 bg-black/50 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 hover:bg-black/70 transition-all focus:opacity-100","aria-label":"Remove image",type:"button",disabled:_,children:x.jsx("div",{className:"i-mdi:close h-3 w-3"})})]}):x.jsxs("div",{ref:ne,tabIndex:0,className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors min-h-[150px] flex flex-col justify-center items-center
              ${F?"border-primary-light bg-primary-light/5":"border-light/20 hover:border-light/30 bg-base-8/20"}
              ${_?"opacity-60 cursor-default pointer-events-none":""}`,onPaste:ce,onFocus:me,onBlur:be,onKeyDown:O=>{var k;(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),(k=ne.current)==null||k.focus())},role:"button","aria-label":l?String(l):"Paste image area",children:[x.jsx("div",{className:`mx-auto mb-2 ${F?"text-primary-light":"text-gray-400"}`,children:x.jsx("div",{className:"i-mdi:image-outline h-10 w-10 mx-auto"})}),x.jsx("p",{className:`text-sm ${F?"text-gray-200":"text-gray-400"} mb-1`,children:_?"Processing...":"Drag & drop, paste, or"}),!_&&x.jsx("button",{type:"button",onClick:z,className:"text-sm text-primary-light hover:underline focus:outline-none focus:ring-1 focus:ring-primary-light rounded px-1",children:"select a file"})]})}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-3",children:[x.jsx(Kt,{type:"button",onClick:S,variant:"secondary",size:"sm",className:"w-full sm:w-auto",disabled:_,isLoading:_&&P.current===null,loadingText:"Pasting...",children:x.jsxs("span",{className:"flex items-center justify-center gap-1.5",children:[x.jsx("div",{className:"i-mdi:content-paste h-4 w-4"}),"Paste Image"]})}),x.jsx(Kt,{type:"button",onClick:z,variant:"secondary",size:"sm",className:"w-full sm:w-auto",disabled:_,isLoading:_&&P.current===null,loadingText:"Selecting...",children:x.jsxs("span",{className:"flex items-center justify-center gap-1.5",children:[x.jsx("div",{className:"i-mdi:file-image-plus-outline h-4 w-4"}),"Select File"]})})]}),x.jsx("input",{type:"file",ref:I,onChange:B,accept:"image/*,image/webp,image/jpeg,image/png,image/gif",style:{display:"none"},disabled:_}),R&&x.jsx("p",{className:"mt-2 text-xs text-gray-500",children:R}),x.jsxs(bn,{variant:"default",className:"p-3 text-xs text-gray-400 mt-3",children:[x.jsxs("p",{children:[x.jsx("span",{className:"font-medium text-primary-light",children:"Recommended size:"})," ",Q.width,"x",Q.height,"px"]}),x.jsx("p",{className:"mt-1",children:"Images will be converted to WebP format. The final size will be your crop area size."})]})]})}export{la as F,pa as I};
