import{r as n,j as e}from"./index-gtzDq4NN.js";import{a as L,b as M,u as $}from"./useAuth-CdmGF86g.js";import{u as A}from"./ModalContext-mlJE0UaS.js";import{u as W,y as z,i as T}from"./globalDisconnect-BwfQ2Vw-.js";import{I as w}from"./iconify-AJT-F7UA.js";import{B as a}from"./Card-CTDM2G3r.js";import{b as S}from"./index-DG3TDxXu.js";function q(){const[r,j]=n.useState(null),[d,u]=n.useState(!1),{address:b,isConnected:t}=L(),{disconnect:N}=M(),l=W(),y=S(),{openModal:c,closeModal:x}=A(),{user:i,isAuthenticated:o,login:v,logout:C,isLoading:E,error:m,validateToken:h}=$();n.useEffect(()=>{t&&i&&h().catch(s=>{console.error("Token validation failed:",s)})},[h,t,i]),n.useEffect(()=>{m&&console.error("Authentication error:",m)},[m]),n.useEffect(()=>{r&&(z.error(`Connection error: ${r}`),console.error("Connection error:",r))},[r]),n.useEffect(()=>{o&&u(!1)},[o]),n.useEffect(()=>{if(t&&!o&&!d&&!T()){const s=setTimeout(()=>{c("login",{onLogin:g,onClose:f})},500);return()=>clearTimeout(s)}},[t,o,d,y.pathname,c]),n.useEffect(()=>{t&&j(null)},[t]);const p=s=>window.innerWidth<360?`${s.substring(0,3)}...${s.substring(s.length-2)}`:window.innerWidth<640?`${s.substring(0,4)}...${s.substring(s.length-3)}`:`${s.substring(0,6)}...${s.substring(s.length-4)}`,k=()=>{l==null||l.open({namespace:"eip155",view:"Connect"})},f=()=>{u(!0),x()},g=async()=>{try{await v(),x()}catch(s){console.error("Login failed:",s)}},D=()=>{c("login",{onLogin:g,onClose:f})};return e.jsx("div",{className:"relative z-20",children:t?o?e.jsxs("div",{className:"flex items-center bg-background-light/30 rounded-full px-1 py-0.5 md:px-2 md:py-1 border border-primary-light/20",children:[e.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 mr-0.5 md:mr-2",children:[e.jsx("div",{className:"w-1 h-1 md:w-1.5 md:h-1.5 rounded-full bg-teal-light mr-2 md:mr-3"}),e.jsx("span",{className:"text-[10px] sm:text-xs text-primary-light font-medium max-w-[50px] md:max-w-none truncate",children:p(i==null?void 0:i.address)})]}),e.jsx(a,{variant:"ghost",size:"xs",className:"rounded-full p-0.5! md:p-1! flex items-center justify-center min-w-0",onClick:C,title:"Disconnect","aria-label":"Disconnect",children:e.jsx(w,{icon:"heroicons:power",width:10,className:"md:w-3.5"})})]}):e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"flex items-center bg-background-light/30 rounded-full px-1 py-0.5 md:px-2 md:py-1 border border-secondary-light/20",children:[e.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 mr-0.5 md:mr-2",children:[e.jsx("div",{className:"w-1 h-1 md:w-1.5 md:h-1.5 rounded-full bg-teal-light mr-2 md:mr-3"}),e.jsx("span",{className:"hidden md:inline text-xs text-gray-300 font-medium max-w-[80px] md:max-w-none truncate",children:p(b)})]}),e.jsxs("div",{className:"flex gap-0.5 md:gap-1",children:[e.jsx(a,{variant:"primary",size:"xs",withGlow:!0,onClick:D,isLoading:E,loadingText:"Validating",className:"text-xs py-0.5 px-2.5 md:text-sm md:py-1.5 md:px-4",children:"Login"}),e.jsx(a,{variant:"ghost",size:"xs",className:"rounded-full p-0.5! flex items-center justify-center min-w-0",onClick:()=>N(),title:"Disconnect","aria-label":"Disconnect",children:e.jsx(w,{icon:"heroicons:power",width:10,className:"md:w-3.5"})})]})]})}):e.jsxs(a,{variant:"primary",size:"sm",withGlow:!0,className:"whitespace-nowrap",onClick:k,children:[e.jsx("span",{className:"hidden xs:inline",children:"Connect Wallet"}),e.jsx("span",{className:"xs:hidden",children:"Connect"})]})})}export{q as W};
