import{r,j as C}from"./index-gtzDq4NN.js";import{u as v}from"./useAuth-CdmGF86g.js";import{g as w}from"./apiClient-DEwubw2O.js";const x=r.createContext(void 0);function B({children:n}){const{isAuthenticated:l,token:s}=v(),[e,o]=r.useState(null),[p,c]=r.useState(!1),[k,a]=r.useState(null),[b,d]=r.useState(null),u=r.useCallback(async()=>{if(!l||!s){o(null);return}c(!0),a(null);try{const t=await w("api/dex",s);t&&"exists"in t&&t.exists===!1?o(null):t&&"id"in t?o(t):o(null)}catch(t){console.error("Failed to fetch DEX data",t),a(t instanceof Error?t.message:"Failed to fetch DEX data"),o(null)}finally{c(!1)}},[l,s]),m=r.useCallback(t=>{o(f=>f?{...f,...t}:null)},[]),i=r.useCallback(()=>{o(null),a(null)},[]);r.useEffect(()=>{l&&s?u():i()},[l,s,u,i]),r.useEffect(()=>{e&&d(e.brokerId)},[e]);const D=b||(e==null?void 0:e.brokerId)||null,h=!!e,E=(e==null?void 0:e.brokerId)==="demo",I=!!(e&&e.brokerId!=="demo"&&e.isGraduated===!0),g=e!=null&&e.repoUrl?`https://dex.orderly.network/${e.repoUrl.split("/").pop()}/`:null;return C.jsx(x.Provider,{value:{dexData:e,isLoading:p,error:k,brokerId:D,hasDex:h,isGraduationEligible:E,isGraduated:I,deploymentUrl:g,refreshDexData:u,updateDexData:m,clearDexData:i,setBrokerId:d},children:n})}function G(){const n=r.useContext(x);if(n===void 0)throw new Error("useDex must be used within a DexProvider");return n}export{B as D,G as u};
