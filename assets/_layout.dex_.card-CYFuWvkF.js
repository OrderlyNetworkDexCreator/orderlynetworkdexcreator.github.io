import{r as o,j as e}from"./index-gtzDq4NN.js";import{y as m}from"./globalDisconnect-BwfQ2Vw-.js";import{u as Ae}from"./useAuth-CdmGF86g.js";import{u as Be}from"./DexContext-BStH6aHx.js";import{b as Re,d as ve,g as _e,p as Fe,m as we}from"./apiClient-DEwubw2O.js";import{C as _,B as F}from"./Card-CTDM2G3r.js";import{F as Oe,I as Ee}from"./ImagePaste-DdHR4gq_.js";import{F as Pe}from"./FuzzySearchInput-CMoxZWNE.js";import{D as Ve}from"./DexCard-Lmwk3s2l.js";import{B as $e}from"./BackDexDashboard-DrPHIyI3.js";import{a as ze}from"./index-DG3TDxXu.js";import"./clsx-B-dksMZM.js";import"./css-BzFf4VQ5.js";import"./ModalContext-mlJE0UaS.js";import"./dijkstra-C00ieaqj.js";import"./Combination-CTmdEaXQ.js";import"./index-Dvs6MNyz.js";import"./tslib.es6-MJ473bz6.js";import"./dayjs.min-DsMxAas2.js";import"./browser-BqbI9gSd.js";import"./leaderboard-bKzLTWQW.js";import"./components-Cb_t2az9.js";import"./index-_0cUeJFu.js";const Ye=({dexData:d,token:x,onUpdate:X})=>{const[s,k]=o.useState(!1),v=async i=>{if(!d.isGraduated){m.info("You must graduate your DEX before changing board visibility");return}k(!0);try{const c=await Re(`api/dex/${d.id}/board-visibility`,{showOnBoard:i},x);c&&c.dex&&(X(c.dex),m.success(i?"Your DEX will now appear on the public board":"Your DEX is now hidden from the public board"))}catch(c){console.error("Error updating board visibility:",c),m.error("Failed to update board visibility")}finally{k(!1)}},u=d.showOnBoard??!0;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-200",children:["Show my DEX on the public board",!d.isGraduated&&e.jsx("span",{className:"text-xs text-gray-500 font-normal ml-2",children:"(Available after graduation)"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Control whether your DEX appears on the public leaderboard. When disabled, your DEX will be private."})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":u,onClick:()=>v(!u),disabled:s||!d.isGraduated,className:`
            relative inline-flex h-6 w-11 flex-shrink-0 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 focus:ring-offset-background-dark ml-4
            ${u?"bg-primary":"bg-gray-600"}
            ${s||!d.isGraduated?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,children:e.jsx("span",{className:`
              inline-block h-4 w-4 transform rounded-full bg-white transition-transform
              ${u?"translate-x-6":"translate-x-1"}
            `})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("div",{className:"i-svg-spinners:pulse-rings-multiple h-4 w-4"}),"Updating..."]})]})},ps=()=>[{title:"DEX Card - Orderly One"},{name:"description",content:"Customize your DEX card appearance on the leaderboard. Upload banners, logos, and add description."}];function gs(){var Z,ee,se,te,re,ae,oe,ne,ie,le,de,ce,me,xe,ue,pe,ge,be,he,fe,ye;const{isAuthenticated:d,token:x,isLoading:X}=Ae(),{dexData:s,isLoading:k,refreshDexData:v}=Be(),u=ze(),[i,c]=o.useState(""),[h,O]=o.useState(null),[f,P]=o.useState(null),[n,V]=o.useState(""),[l,$]=o.useState(""),[w,z]=o.useState(""),[E,Y]=o.useState(""),[L,G]=o.useState(""),[y,q]=o.useState(""),[p,Le]=o.useState([]),[C,M]=o.useState(!1),[W,Q]=o.useState(!1),[H,T]=o.useState(!1),[j,U]=o.useState(""),A=o.useRef(null),B=o.useMemo(()=>{if(!j.trim())return p;const t=j.toLowerCase();return p.filter(a=>a.name.toLowerCase().includes(t)||a.id.toLowerCase().includes(t))},[p,j]),[J,K]=o.useState(!1),[r,N]=o.useState(null),S=async t=>(await fetch(t)).blob(),R=async(t,a)=>{if(!t.trim()||!a.trim()){N(null);return}K(!0);try{const g=await fetch(`https://api.geckoterminal.com/api/v2/networks/${a}/tokens/${t}`);if(g.ok){const b=await g.json();N({isValid:!0,tokenInfo:b.data})}else N({isValid:!1,error:"Token not found on this network"})}catch{N({isValid:!1,error:"Failed to validate token"})}finally{K(!1)}},Ce=t=>{const a=t.target.value;V(a),r&&N(null)},Se=()=>{n.trim()&&l.trim()&&R(n,l)},De=t=>{U(t),T(!0)},Ie=t=>{$(t.id),U(t.name),T(!1),n.trim()&&R(n,t.id)};o.useEffect(()=>{s&&(c(s.description||""),V(s.tokenAddress||""),$(s.tokenChain||""),z(s.telegramLink||""),Y(s.discordLink||""),G(s.xLink||""),q(s.websiteUrl||""),(async()=>(s.banner&&O(await S(s.banner)),s.logo&&P(await S(s.logo))))())},[s]),o.useEffect(()=>{s!=null&&s.tokenAddress&&(s!=null&&s.tokenChain)&&R(s.tokenAddress,s.tokenChain)},[s==null?void 0:s.tokenAddress,s==null?void 0:s.tokenChain]),o.useEffect(()=>{if(l&&p.length>0){const t=p.find(a=>a.id===l);t&&U(t.name)}},[l,p]),o.useEffect(()=>{const t=a=>{A.current&&!A.current.contains(a.target)&&T(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),o.useEffect(()=>{(async()=>{if(x){M(!0);try{const a=await _e("api/dex/networks",x);if(a&&Array.isArray(a)){const g=a.sort((b,I)=>b.name.localeCompare(I.name));Le(g)}}catch(a){console.error("Error loading networks:",a),m.error("Failed to load available networks")}finally{M(!1)}}})()},[x]);const Xe=ve(we(150,"Description")),Te=ve(we(100,"Token address")),D=t=>a=>{switch(t){case"banner":O(a);break;case"logo":P(a);break}},Ue=async t=>{if(t.preventDefault(),!s||!s.id){m.error("DEX information is not available");return}if(n.trim()&&l.trim()&&r&&!r.isValid){m.error("Please fix token validation errors before saving");return}Q(!0);try{const a=new FormData;i.trim()&&a.append("description",i.trim()),n.trim()&&a.append("tokenAddress",n.trim()),l.trim()&&a.append("tokenChain",l.trim()),w.trim()&&a.append("telegramLink",w.trim()),E.trim()&&a.append("discordLink",E.trim()),L.trim()&&a.append("xLink",L.trim()),y.trim()&&a.append("websiteUrl",y.trim()),h&&a.append("banner",h),f&&a.append("logo",f),await Fe("api/dex/social-card",a,x),m.success("DEX card information updated successfully!"),await v(),u("/dex")}catch(a){console.error("Error updating DEX card:",a),m.error("Failed to update DEX card information")}finally{Q(!1)}};return X||k?e.jsx("div",{className:"w-full h-[calc(100vh-64px)] flex items-center justify-center px-4 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"i-svg-spinners:pulse-rings-multiple h-12 w-12 mx-auto text-primary-light mb-4"}),e.jsx("div",{className:"text-base md:text-lg mb-2",children:"Loading your DEX"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Please wait while we fetch your configuration"})]})}):d?s?e.jsxs("div",{className:"container mx-auto p-4 max-w-3xl mt-26 pb-52",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:e.jsxs("div",{children:[e.jsx($e,{}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold gradient-text",children:"DEX Card Setup"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Configure how your DEX appears on the board page"})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Board Visibility"}),e.jsx(Ye,{dexData:s,token:x||"",onUpdate:v})]}),s.showOnBoard??!0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 pt-6 border-t border-gray-600",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Board Page Display"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"This information will be displayed on the board page to showcase your DEX alongside others."}),e.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-warning/20 p-1.5 rounded-full flex-shrink-0",children:e.jsx("div",{className:"i-mdi:information text-warning w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-warning mb-1",children:"Graduation Required"}),e.jsx("p",{className:"text-xs text-gray-300",children:"Your DEX card will only appear on the board page after you have graduated your DEX. Complete the graduation process to start earning fees and make your DEX visible on the board."})]})]})})]}),e.jsxs(Oe,{onSubmit:Ue,className:"space-y-6",submitText:"Save DEX Card",isLoading:W,loadingText:"Saving...",disabled:W,children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Description ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("textarea",{value:i,onChange:t=>c(t.target.value),placeholder:"Brief description of your DEX for the board page",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-none",rows:3,maxLength:150}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("p",{className:"text-xs text-gray-400",children:Xe(i)||"Brief description for social media"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[i.length,"/150"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Banner Image"," ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),(s==null?void 0:s.primaryLogo)&&e.jsx(F,{type:"button",variant:"secondary",size:"sm",onClick:()=>{s!=null&&s.primaryLogo&&S(s.primaryLogo).then(t=>{D("banner")(t)})},children:"Use Primary Logo"})]}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Large image displayed on the board page. Recommended: 1200x630px"}),e.jsx(Ee,{id:"banner",label:"",value:h||void 0,onChange:D("banner"),imageType:"banner",helpText:"Large banner image for the board page display"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Logo ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),(s==null?void 0:s.secondaryLogo)&&e.jsx(F,{type:"button",variant:"secondary",size:"sm",onClick:()=>{s!=null&&s.secondaryLogo&&S(s.secondaryLogo).then(t=>{D("logo")(t)})},children:"Use Secondary Logo"})]}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Small logo for the board page. Recommended: 400x400px"}),e.jsx(Ee,{id:"logo",label:"",value:f||void 0,onChange:D("logo"),imageType:"logo",helpText:"Small logo for the board page display"})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Token Information"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your token details for enhanced board page display"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Token Address"," ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"text",value:n,onChange:Ce,onBlur:Se,placeholder:"Enter your token contract address",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",maxLength:100}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Te(n)||"Your token's contract address"}),J&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("div",{className:"i-mdi:loading h-4 w-4 animate-spin"}),"Validating token..."]}),r&&!J&&e.jsx("div",{className:"mt-2",children:r.isValid?e.jsx("div",{className:"bg-green-900/20 border border-green-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[((ee=(Z=r.tokenInfo)==null?void 0:Z.attributes)==null?void 0:ee.image_url)&&e.jsx("img",{src:r.tokenInfo.attributes.image_url,alt:r.tokenInfo.attributes.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-green-400",children:(te=(se=r.tokenInfo)==null?void 0:se.attributes)==null?void 0:te.name}),e.jsxs("span",{className:"text-gray-400",children:["(",(ae=(re=r.tokenInfo)==null?void 0:re.attributes)==null?void 0:ae.symbol,")"]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Price: $",new Intl.NumberFormat("en-US",{maximumSignificantDigits:4}).format(Number(((ne=(oe=r.tokenInfo)==null?void 0:oe.attributes)==null?void 0:ne.price_usd)||"0")),((le=(ie=r.tokenInfo)==null?void 0:ie.attributes)==null?void 0:le.market_cap_usd)&&e.jsxs("span",{className:"ml-2",children:["â€¢ Market Cap: $",new Intl.NumberFormat("en-US",{notation:"compact",maximumSignificantDigits:4}).format(Number(((ce=(de=r.tokenInfo)==null?void 0:de.attributes)==null?void 0:ce.market_cap_usd)||"0"))]})]}),((pe=(ue=(xe=(me=r.tokenInfo)==null?void 0:me.relationships)==null?void 0:xe.top_pools)==null?void 0:ue.data)==null?void 0:pe[0])&&(()=>{var b,I,je,Ne,ke;const t=(ke=(Ne=(je=(I=(b=r.tokenInfo)==null?void 0:b.relationships)==null?void 0:I.top_pools)==null?void 0:je.data)==null?void 0:Ne[0])==null?void 0:ke.id;if(!t)return null;const[a,g]=t.split("_");return e.jsxs("a",{href:`https://www.geckoterminal.com/${a}/pools/${g}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:text-primary-light inline-flex items-center gap-1 mt-1",children:["View on GeckoTerminal",e.jsx("div",{className:"i-mdi:open-in-new h-3 w-3"})]})})()]})]})}):e.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx("div",{className:"i-mdi:alert-circle h-4 w-4"}),e.jsx("span",{className:"text-sm",children:r.error})]})})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Token Chain"," ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsxs("div",{className:"relative",ref:A,children:[e.jsx(Pe,{placeholder:"Search blockchain networks...",value:j,onSearch:De,className:"mb-0",disabled:C,debounceTime:100}),C&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Loading networks..."}),!C&&H&&B.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background-dark border border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:B.map(t=>e.jsxs("button",{type:"button",onClick:()=>Ie(t),className:"w-full px-3 py-2 text-left hover:bg-gray-700 focus:bg-gray-700 focus:outline-none flex items-center justify-between",children:[e.jsx("span",{children:t.name}),e.jsx("span",{className:"text-xs text-gray-400",children:t.id})]},t.id))}),!C&&H&&j&&B.length===0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background-dark border border-gray-600 rounded-lg shadow-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-400",children:"No networks found"})})]})]})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Social Media Links"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your social media links for enhanced board page display"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Telegram ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:w,onChange:t=>z(t.target.value),placeholder:"https://t.me/your-group",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Discord ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:E,onChange:t=>Y(t.target.value),placeholder:"https://discord.gg/your-server",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["X (Twitter)"," ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:L,onChange:t=>G(t.target.value),placeholder:"https://twitter.com/your-account",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Website URL"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your DEX website URL for the board page"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Website URL"," ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:y,onChange:t=>q(t.target.value),placeholder:"https://your-dex.com",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"This will be used as the main website link on your DEX card"})]})})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-600",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Board Page Preview"}),e.jsx("div",{className:"max-w-lg",children:e.jsx(Ve,{broker:{id:s.id,brokerId:s.brokerId,brokerName:s.brokerName,dexUrl:y||(s.customDomain?`https://${s.customDomain}`:s.repoUrl?`https://dex.orderly.network/${s.repoUrl.split("/").pop()}/`:null),totalVolume:125e4,totalPnl:85e3,description:i,banner:h?URL.createObjectURL(h):void 0,logo:f?URL.createObjectURL(f):void 0,tokenAddress:n,tokenChain:l,tokenSymbol:r!=null&&r.isValid?(ge=r.tokenInfo)==null?void 0:ge.attributes.symbol:void 0,tokenName:r!=null&&r.isValid?(be=r.tokenInfo)==null?void 0:be.attributes.name:void 0,tokenPrice:r!=null&&r.isValid?Number(((he=r.tokenInfo)==null?void 0:he.attributes.price_usd)||"0"):void 0,tokenMarketCap:r!=null&&r.isValid?Number(((fe=r.tokenInfo)==null?void 0:fe.attributes.market_cap_usd)||"0"):void 0,tokenImageUrl:r!=null&&r.isValid?(ye=r.tokenInfo)==null?void 0:ye.attributes.image_url:void 0,telegramLink:w,discordLink:E,xLink:L,websiteUrl:y},timePeriod:"weekly"})}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"This is how your DEX will appear on the board page."})]})]}):e.jsx("div",{className:"pt-6 border-t border-gray-600",children:e.jsxs("div",{className:"bg-background-light/30 border border-light/20 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"i-heroicons:eye-slash w-12 h-12 mx-auto mb-3 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"DEX Hidden from Board"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Your DEX is currently hidden from the public board. Enable board visibility above to configure how your DEX appears to others."})]})})]})]}):e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Card Setup"}),e.jsxs(_,{children:[e.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"DEX Required"}),e.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"You need to create a DEX first before setting up your DEX card."}),e.jsx(F,{onClick:()=>u("/dex"),children:"Create DEX"})]})]})}):e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Card Setup"}),e.jsxs(_,{children:[e.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"Authentication Required"}),e.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"Please connect your wallet and login to set up your DEX card."})]})]})})}export{gs as default,ps as meta};
