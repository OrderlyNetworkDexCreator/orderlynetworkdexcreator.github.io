import{r as n,j as e}from"./index-gtzDq4NN.js";import{y as b}from"./globalDisconnect-DEHmIGkh.js";import{u as Ue}from"./useAuth-RM4Avg_6.js";import{u as Re}from"./DexContext-BUFcSEJ_.js";import{c as ye,g as Fe,m as je,d as _e}from"./apiClient-Br2nePLb.js";import{C,B as X}from"./Card-DzC9HQ_p.js";import{F as Pe,I as ke}from"./ImagePaste-vd2XcMa8.js";import{F as Be}from"./FuzzySearchInput-Bl89GpN0.js";import{D as Ve}from"./DexCard-Cf2Foe7F.js";import{a as Oe}from"./index-B6zKOWfM.js";import{L as $e}from"./components-CyfABTTb.js";import"./index-BftLqECp.js";import"./tslib.es6-DjQuqsdl.js";import"./switchMap-CAkRPEGC.js";import"./clsx.m-DHulAg21.js";import"./FormInput-CKH1Jbq0.js";import"./ModalContext-3rcxIYCP.js";import"./index--NnR_BUb.js";import"./leaderboard-bKzLTWQW.js";import"./index-Dvs6MNyz.js";function ds(){var Q,H,J,K,Z,ee,se,te,ae,re,ne,oe,ie,le,de,ce,me,xe,ue,pe,ge;const{isAuthenticated:Ne,token:f,isLoading:ve}=Ue(),{dexData:s,isLoading:we,refreshDexData:Le}=Re(),A=Oe(),[l,U]=n.useState(""),[x,R]=n.useState(null),[u,F]=n.useState(null),[o,_]=n.useState(""),[i,P]=n.useState(""),[y,B]=n.useState(""),[j,V]=n.useState(""),[k,O]=n.useState(""),[p,$]=n.useState(""),[d,Ce]=n.useState([]),[N,z]=n.useState(!1),[q,M]=n.useState(!1),[W,S]=n.useState(!1),[g,E]=n.useState(""),I=n.useRef(null),D=n.useMemo(()=>{if(!g.trim())return d;const t=g.toLowerCase();return d.filter(r=>r.name.toLowerCase().includes(t)||r.id.toLowerCase().includes(t))},[d,g]),[Y,G]=n.useState(!1),[a,h]=n.useState(null),v=async t=>(await fetch(t)).blob(),T=async(t,r)=>{if(!t.trim()||!r.trim()){h(null);return}G(!0);try{const c=await fetch(`https://api.geckoterminal.com/api/v2/networks/${r}/tokens/${t}`);if(c.ok){const m=await c.json();h({isValid:!0,tokenInfo:m.data})}else h({isValid:!1,error:"Token not found on this network"})}catch{h({isValid:!1,error:"Failed to validate token"})}finally{G(!1)}},Se=t=>{const r=t.target.value;_(r),a&&h(null)},Ee=()=>{o.trim()&&i.trim()&&T(o,i)},Ie=t=>{E(t),S(!0)},De=t=>{P(t.id),E(t.name),S(!1),o.trim()&&T(o,t.id)};n.useEffect(()=>{s&&(U(s.description||""),_(s.tokenAddress||""),P(s.tokenChain||""),B(s.telegramLink||""),V(s.discordLink||""),O(s.xLink||""),$(s.websiteUrl||""),(async()=>(s.banner&&R(await v(s.banner)),s.logo&&F(await v(s.logo))))())},[s]),n.useEffect(()=>{s!=null&&s.tokenAddress&&(s!=null&&s.tokenChain)&&T(s.tokenAddress,s.tokenChain)},[s==null?void 0:s.tokenAddress,s==null?void 0:s.tokenChain]),n.useEffect(()=>{if(i&&d.length>0){const t=d.find(r=>r.id===i);t&&E(t.name)}},[i,d]),n.useEffect(()=>{const t=r=>{I.current&&!I.current.contains(r.target)&&S(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),n.useEffect(()=>{(async()=>{if(f){z(!0);try{const r=await Fe("api/dex/networks",f);if(r&&Array.isArray(r)){const c=r.sort((m,L)=>m.name.localeCompare(L.name));Ce(c)}}catch(r){console.error("Error loading networks:",r),b.error("Failed to load available networks")}finally{z(!1)}}})()},[f]);const Te=ye(je(150,"Description")),Xe=ye(je(100,"Token address")),w=t=>r=>{switch(t){case"banner":R(r);break;case"logo":F(r);break}},Ae=async t=>{if(t.preventDefault(),!s||!s.id){b.error("DEX information is not available");return}if(o.trim()&&i.trim()&&a&&!a.isValid){b.error("Please fix token validation errors before saving");return}M(!0);try{const r=new FormData;l.trim()&&r.append("description",l.trim()),o.trim()&&r.append("tokenAddress",o.trim()),i.trim()&&r.append("tokenChain",i.trim()),y.trim()&&r.append("telegramLink",y.trim()),j.trim()&&r.append("discordLink",j.trim()),k.trim()&&r.append("xLink",k.trim()),p.trim()&&r.append("websiteUrl",p.trim()),x&&r.append("banner",x),u&&r.append("logo",u),await _e("api/dex/social-card",r,f),b.success("DEX card information updated successfully!"),await Le(),A("/dex")}catch(r){console.error("Error updating DEX card:",r),b.error("Failed to update DEX card information")}finally{M(!1)}};return ve||we?e.jsx("div",{className:"w-full h-[calc(100vh-64px)] flex items-center justify-center px-4 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"i-svg-spinners:pulse-rings-multiple h-12 w-12 mx-auto text-primary-light mb-4"}),e.jsx("div",{className:"text-base md:text-lg mb-2",children:"Loading your DEX"}),e.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Please wait while we fetch your configuration"})]})}):Ne?s?e.jsxs("div",{className:"container mx-auto p-4 max-w-3xl mt-26 pb-52",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:e.jsxs("div",{children:[e.jsxs($e,{to:"/dex",className:"text-sm text-gray-400 hover:text-primary-light mb-2 inline-flex items-center",children:[e.jsx("div",{className:"i-mdi:arrow-left h-4 w-4 mr-1"}),"Back to DEX Dashboard"]}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold gradient-text",children:"DEX Card Setup"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Configure how your DEX appears on the board page"})]})}),e.jsxs(C,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Board Page Display"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"This information will be displayed on the board page to showcase your DEX alongside others."}),e.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"bg-warning/20 p-1.5 rounded-full flex-shrink-0",children:e.jsx("div",{className:"i-mdi:information text-warning w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-warning mb-1",children:"Graduation Required"}),e.jsx("p",{className:"text-xs text-gray-300",children:"Your DEX card will only appear on the board page after you have graduated your DEX. Complete the graduation process to start earning fees and make your DEX visible on the board."})]})]})})]}),e.jsxs(Pe,{onSubmit:Ae,className:"space-y-6",submitText:"Save DEX Card",isLoading:q,loadingText:"Saving...",disabled:q,children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Description ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("textarea",{value:l,onChange:t=>U(t.target.value),placeholder:"Brief description of your DEX for the board page",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-none",rows:3,maxLength:150}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("p",{className:"text-xs text-gray-400",children:Te(l)||"Brief description for social media"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[l.length,"/150"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Banner Image ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),(s==null?void 0:s.primaryLogo)&&e.jsx(X,{type:"button",variant:"secondary",size:"sm",onClick:()=>{s!=null&&s.primaryLogo&&v(s.primaryLogo).then(t=>{w("banner")(t)})},children:"Use Primary Logo"})]}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Large image displayed on the board page. Recommended: 1200x630px"}),e.jsx(ke,{id:"banner",label:"",value:x||void 0,onChange:w("banner"),imageType:"banner",helpText:"Large banner image for the board page display"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Logo ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),(s==null?void 0:s.secondaryLogo)&&e.jsx(X,{type:"button",variant:"secondary",size:"sm",onClick:()=>{s!=null&&s.secondaryLogo&&v(s.secondaryLogo).then(t=>{w("logo")(t)})},children:"Use Secondary Logo"})]}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Small logo for the board page. Recommended: 400x400px"}),e.jsx(ke,{id:"logo",label:"",value:u||void 0,onChange:w("logo"),imageType:"logo",helpText:"Small logo for the board page display"})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Token Information"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your token details for enhanced board page display"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Token Address ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"text",value:o,onChange:Se,onBlur:Ee,placeholder:"Enter your token contract address",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",maxLength:100}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Xe(o)||"Your token's contract address"}),Y&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-400",children:[e.jsx("div",{className:"i-mdi:loading h-4 w-4 animate-spin"}),"Validating token..."]}),a&&!Y&&e.jsx("div",{className:"mt-2",children:a.isValid?e.jsx("div",{className:"bg-green-900/20 border border-green-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[((H=(Q=a.tokenInfo)==null?void 0:Q.attributes)==null?void 0:H.image_url)&&e.jsx("img",{src:a.tokenInfo.attributes.image_url,alt:a.tokenInfo.attributes.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-green-400",children:(K=(J=a.tokenInfo)==null?void 0:J.attributes)==null?void 0:K.name}),e.jsxs("span",{className:"text-gray-400",children:["(",(ee=(Z=a.tokenInfo)==null?void 0:Z.attributes)==null?void 0:ee.symbol,")"]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Price: $",new Intl.NumberFormat("en-US",{maximumSignificantDigits:4}).format(parseFloat(((te=(se=a.tokenInfo)==null?void 0:se.attributes)==null?void 0:te.price_usd)||"0")),((re=(ae=a.tokenInfo)==null?void 0:ae.attributes)==null?void 0:re.market_cap_usd)&&e.jsxs("span",{className:"ml-2",children:["• Market Cap: $",new Intl.NumberFormat("en-US",{notation:"compact",maximumSignificantDigits:4}).format(parseFloat(((oe=(ne=a.tokenInfo)==null?void 0:ne.attributes)==null?void 0:oe.market_cap_usd)||"0"))]})]}),((ce=(de=(le=(ie=a.tokenInfo)==null?void 0:ie.relationships)==null?void 0:le.top_pools)==null?void 0:de.data)==null?void 0:ce[0])&&(()=>{var m,L,he,be,fe;const t=(fe=(be=(he=(L=(m=a.tokenInfo)==null?void 0:m.relationships)==null?void 0:L.top_pools)==null?void 0:he.data)==null?void 0:be[0])==null?void 0:fe.id;if(!t)return null;const[r,c]=t.split("_");return e.jsxs("a",{href:`https://www.geckoterminal.com/${r}/pools/${c}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:text-primary-light inline-flex items-center gap-1 mt-1",children:["View on GeckoTerminal",e.jsx("div",{className:"i-mdi:open-in-new h-3 w-3"})]})})()]})]})}):e.jsx("div",{className:"bg-red-900/20 border border-red-500/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx("div",{className:"i-mdi:alert-circle h-4 w-4"}),e.jsx("span",{className:"text-sm",children:a.error})]})})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Token Chain ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsxs("div",{className:"relative",ref:I,children:[e.jsx(Be,{placeholder:"Search blockchain networks...",value:g,onSearch:Ie,className:"mb-0",disabled:N,debounceTime:100}),N&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Loading networks..."}),!N&&W&&D.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background-dark border border-gray-600 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:D.map(t=>e.jsxs("button",{type:"button",onClick:()=>De(t),className:"w-full px-3 py-2 text-left hover:bg-gray-700 focus:bg-gray-700 focus:outline-none flex items-center justify-between",children:[e.jsx("span",{children:t.name}),e.jsx("span",{className:"text-xs text-gray-400",children:t.id})]},t.id))}),!N&&W&&g&&D.length===0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background-dark border border-gray-600 rounded-lg shadow-lg p-3",children:e.jsx("p",{className:"text-sm text-gray-400",children:"No networks found"})})]})]})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Social Media Links"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your social media links for enhanced board page display"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Telegram ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:y,onChange:t=>B(t.target.value),placeholder:"https://t.me/your-group",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Discord ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:j,onChange:t=>V(t.target.value),placeholder:"https://discord.gg/your-server",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["X (Twitter) ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:k,onChange:t=>O(t.target.value),placeholder:"https://twitter.com/your-account",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Website URL"}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Optional: Add your DEX website URL for the board page"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Website URL ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"url",value:p,onChange:t=>$(t.target.value),placeholder:"https://your-dex.com",className:"w-full px-3 py-2 bg-background-dark border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"This will be used as the main website link on your DEX card"})]})})]})]})]}),e.jsxs(C,{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Board Page Preview"}),e.jsx("div",{className:"max-w-lg",children:e.jsx(Ve,{broker:{id:s.id,brokerId:s.brokerId,brokerName:s.brokerName,dexUrl:p||(s.customDomain?`https://${s.customDomain}`:s.repoUrl?`https://dex.orderly.network/${s.repoUrl.split("/").pop()}/`:null),totalVolume:125e4,totalPnl:85e3,description:l,banner:x?URL.createObjectURL(x):void 0,logo:u?URL.createObjectURL(u):void 0,tokenAddress:o,tokenChain:i,tokenSymbol:a!=null&&a.isValid?(me=a.tokenInfo)==null?void 0:me.attributes.symbol:void 0,tokenName:a!=null&&a.isValid?(xe=a.tokenInfo)==null?void 0:xe.attributes.name:void 0,tokenPrice:a!=null&&a.isValid?parseFloat(((ue=a.tokenInfo)==null?void 0:ue.attributes.price_usd)||"0"):void 0,tokenMarketCap:a!=null&&a.isValid?parseFloat(((pe=a.tokenInfo)==null?void 0:pe.attributes.market_cap_usd)||"0"):void 0,tokenImageUrl:a!=null&&a.isValid?(ge=a.tokenInfo)==null?void 0:ge.attributes.image_url:void 0,telegramLink:y,discordLink:j,xLink:k,websiteUrl:p},timePeriod:"weekly"})}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"This is how your DEX will appear on the board page."})]})]}):e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Card Setup"}),e.jsxs(C,{children:[e.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"DEX Required"}),e.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"You need to create a DEX first before setting up your DEX card."}),e.jsx(X,{onClick:()=>A("/dex"),children:"Create DEX"})]})]})}):e.jsx("div",{className:"w-full max-w-3xl mx-auto px-4 py-6 md:py-10 mt-26 pb-52",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-4 md:mb-6",children:"DEX Card Setup"}),e.jsxs(C,{children:[e.jsx("h2",{className:"text-lg md:text-xl font-medium mb-3 md:mb-4",children:"Authentication Required"}),e.jsx("p",{className:"mb-4 md:mb-6 text-sm md:text-base text-gray-300",children:"Please connect your wallet and login to set up your DEX card."})]})]})})}export{ds as default};
