const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webp_enc_simd-B6XVdu2z.js","assets/index-gtzDq4NN.js","assets/globalDisconnect-BwfQ2Vw-.js","assets/clsx-B-dksMZM.js","assets/webp_enc-8zj4ms51.js"])))=>i.map(i=>d[i]);
import{r as H,W as Br,j as x,p as Q}from"./index-gtzDq4NN.js";import{B as Kr,C as bn}from"./Card-CTDM2G3r.js";import{aV as _n,u as wn}from"./ModalContext-mlJE0UaS.js";import{g as An}from"./apiClient-DEwubw2O.js";import{u as $n}from"./useAuth-CdmGF86g.js";import{b as ot,_ as en,y as Ye}from"./globalDisconnect-BwfQ2Vw-.js";function En(i=!0){const{token:l,isAuthenticated:t}=$n(),[u,v]=H.useState(null),[T,E]=H.useState(!1),[_,R]=H.useState(0),U=H.useRef(null),q=H.useCallback(I=>{const M=Math.floor(I/60),ne=I%60;return`${M.toString().padStart(2,"0")}:${ne.toString().padStart(2,"0")}`},[]),F=H.useCallback(async()=>{if(!(!i||!t||!l)){E(!0);try{const I=await An("api/dex/rate-limit-status",l,{showToastOnError:!1});v(I),R(I.remainingCooldownSeconds)}catch(I){console.debug("Error checking rate limit:",I)}finally{E(!1)}}},[i,t,l]),se=H.useCallback(()=>{U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{F()},500)},[F]);return H.useEffect(()=>{if(!i||!(u!=null&&u.isRateLimited)||_<=0)return;const I=setInterval(()=>{R(M=>{const ne=M-1;return ne<=0?(setTimeout(()=>F(),100),0):ne})},1e3);return()=>clearInterval(I)},[i,u==null?void 0:u.isRateLimited,F]),H.useEffect(()=>{i&&t&&l&&F()},[i,t,l,F]),H.useEffect(()=>{if(!i||!t||!l)return;const I=()=>{document.hidden||se()},M=()=>{se()};return document.addEventListener("visibilitychange",I),window.addEventListener("focus",M),()=>{document.removeEventListener("visibilitychange",I),window.removeEventListener("focus",M)}},[i,t,l,se]),H.useEffect(()=>()=>{U.current&&clearTimeout(U.current)},[]),{isRateLimited:!!(i&&(u!=null&&u.isRateLimited)&&_>0),remainingSeconds:_,formattedTime:q(_),checkRateLimit:F,isChecking:T}}function oa({onSubmit:i,children:l,submitText:t,isLoading:u=!1,loadingText:v="Submitting",disabled:T=!1,className:E="",enableRateLimit:_=!1}){const[R,U]=H.useState({}),q=En(_),F=q.isRateLimited,se=H.useCallback((P,G)=>{U(ie=>({...ie,[P]:G}))},[]),I=H.useCallback(P=>{const ie=P.nativeEvent.submitter;if(ie&&ie.closest("[data-preview-container]")){P.preventDefault(),P.stopPropagation();return}P.preventDefault(),i(P,R)},[i,R]),M=P=>{P.key==="Enter"&&P.target instanceof HTMLInputElement&&P.preventDefault()},ne=H.useMemo(()=>Br.Children.map(l,P=>{if(Br.isValidElement(P)&&P.type===_n){const G=P.props;if(G.id)return Br.cloneElement(P,{onError:ie=>se(G.id,ie)})}return P}),[l,se]);return x.jsxs("form",{onSubmit:I,onKeyDown:M,className:E,children:[ne,t&&x.jsxs(x.Fragment,{children:[F&&x.jsxs("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4 mb-4",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("div",{className:"i-mdi:clock-alert text-warning h-5 w-5"}),x.jsx("span",{className:"text-warning font-medium",children:"Please Wait"})]}),x.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"You can only update your DEX once every 2 minutes."}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-xs text-gray-400",children:"Time remaining:"}),x.jsx("span",{className:"font-mono text-warning font-bold",children:q.formattedTime})]})]}),x.jsx(Kr,{className:"w-full justify-center max-w-md mxa",type:"submit",variant:"primary",size:"md",disabled:T||u||F,isLoading:u,loadingText:v,children:F?`Wait ${q.formattedTime}`:t})]})]})}function Tn(i,l,t={}){return i({noInitialRun:!0,instantiateWasm:void 0,...t})}var Rn=(()=>{var i=import.meta.url;return function(l={}){var t=l,u,v,T=new Promise((e,r)=>{u=e,v=r});const _=globalThis.ServiceWorkerGlobalScope!==void 0&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,R=typeof Q=="object"&&Q.release&&Q.release.name==="node";(_||R)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(r,o,c){this.data=r,this.width=o,this.height=c}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));var U=Object.assign({},t),q="./this.program",F=(e,r)=>{throw r},se=typeof window=="object",I=typeof importScripts=="function";typeof Q=="object"&&typeof Q.versions=="object"&&Q.versions.node;var M="";function ne(e){return t.locateFile?t.locateFile(e,M):M+e}var P;(se||I)&&(I?M=self.location.href:typeof document<"u"&&document.currentScript&&(M=document.currentScript.src),i&&(M=i),M.startsWith("blob:")?M="":M=M.substr(0,M.replace(/[?#].*/,"").lastIndexOf("/")+1),I&&(P=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}));var G=t.print||console.log.bind(console),ie=t.printErr||console.error.bind(console);Object.assign(t,U),U=null,t.arguments&&t.arguments,t.thisProgram&&(q=t.thisProgram),t.quit&&(F=t.quit);var be;t.wasmBinary&&(be=t.wasmBinary);var xe,De=!1,ce,B,K,me,_e,S,z,O;function k(){var e=xe.buffer;t.HEAP8=ce=new Int8Array(e),t.HEAP16=K=new Int16Array(e),t.HEAPU8=B=new Uint8Array(e),t.HEAPU16=me=new Uint16Array(e),t.HEAP32=_e=new Int32Array(e),t.HEAPU32=S=new Uint32Array(e),t.HEAPF32=z=new Float32Array(e),t.HEAPF64=O=new Float64Array(e)}var j=[],D=[],V=[];function ae(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)de(t.preRun.shift());ct(j)}function X(){ct(D)}function we(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ne(t.postRun.shift());ct(V)}function de(e){j.unshift(e)}function Ve(e){D.unshift(e)}function Ne(e){V.unshift(e)}var Ae=0,Ce=null;function Ue(e){var r;Ae++,(r=t.monitorRunDependencies)==null||r.call(t,Ae)}function Be(e){var o;if(Ae--,(o=t.monitorRunDependencies)==null||o.call(t,Ae),Ae==0&&Ce){var r=Ce;Ce=null,r()}}function Wt(e){var o;(o=t.onAbort)==null||o.call(t,e),e="Aborted("+e+")",ie(e),De=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw v(r),r}var Yt="data:application/octet-stream;base64,",ze=e=>e.startsWith(Yt),Fe;t.locateFile?(Fe="mozjpeg_dec.wasm",ze(Fe)||(Fe=ne(Fe))):Fe=new URL("/assets/mozjpeg_dec-muSO2n8T.wasm",import.meta.url).href;function st(e){if(e==Fe&&be)return new Uint8Array(be);if(P)return P(e);throw"both async and sync fetching of the wasm failed"}function ke(e){return!be&&(se||I)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw`failed to load wasm binary file at '${e}'`;return r.arrayBuffer()}).catch(()=>st(e)):Promise.resolve().then(()=>st(e))}function lt(e,r,o){return ke(e).then(c=>WebAssembly.instantiate(c,r)).then(o,c=>{ie(`failed to asynchronously prepare wasm: ${c}`),Wt(c)})}function Jt(e,r,o,c){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!ze(r)&&typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(h=>{var m=WebAssembly.instantiateStreaming(h,o);return m.then(c,function(w){return ie(`wasm streaming compile failed: ${w}`),ie("falling back to ArrayBuffer instantiation"),lt(r,o,c)})}):lt(r,o,c)}function xt(){var e={a:Hr};function r(c,h){return oe=c.exports,xe=oe.A,k(),Mt=oe.F,Ve(oe.B),Be(),oe}Ue();function o(c){r(c.instance)}if(t.instantiateWasm)try{return t.instantiateWasm(e,r)}catch(c){ie(`Module.instantiateWasm callback failed with error: ${c}`),v(c)}return Jt(be,Fe,e,o).catch(v),{}}function Zt(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var ct=e=>{for(;e.length>0;)e.shift()(t)};t.noExitRuntime;class ft{constructor(r){this.excPtr=r,this.ptr=r-24}set_type(r){S[this.ptr+4>>2]=r}get_type(){return S[this.ptr+4>>2]}set_destructor(r){S[this.ptr+8>>2]=r}get_destructor(){return S[this.ptr+8>>2]}set_caught(r){r=r?1:0,ce[this.ptr+12]=r}get_caught(){return ce[this.ptr+12]!=0}set_rethrown(r){r=r?1:0,ce[this.ptr+13]=r}get_rethrown(){return ce[this.ptr+13]!=0}init(r,o){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(o)}set_adjusted_ptr(r){S[this.ptr+16>>2]=r}get_adjusted_ptr(){return S[this.ptr+16>>2]}get_exception_ptr(){var r=Zr(this.get_type());if(r)return S[this.excPtr>>2];var o=this.get_adjusted_ptr();return o!==0?o:this.excPtr}}var Ut=0,Qt=(e,r,o)=>{var c=new ft(e);throw c.init(r,o),Ut=e,Ut},er=(e,r,o,c,h)=>{},ut=()=>{for(var e=new Array(256),r=0;r<256;++r)e[r]=String.fromCharCode(r);Ft=e},Ft,fe=e=>{for(var r="",o=e;B[o];)r+=Ft[B[o++]];return r},te={},ue={},pe={},qe,le=e=>{throw new qe(e)},kt,Pt=e=>{throw new kt(e)},tr=(e,r,o)=>{e.forEach(function(y){pe[y]=r});function c(y){var A=o(y);A.length!==e.length&&Pt("Mismatched type converter count");for(var C=0;C<e.length;++C)ve(e[C],A[C])}var h=new Array(r.length),m=[],w=0;r.forEach((y,A)=>{ue.hasOwnProperty(y)?h[A]=ue[y]:(m.push(y),te.hasOwnProperty(y)||(te[y]=[]),te[y].push(()=>{h[A]=ue[y],++w,w===m.length&&c(h)}))}),m.length===0&&c(h)};function dt(e,r,o={}){var c=r.name;if(e||le(`type "${c}" must have a positive integer typeid pointer`),ue.hasOwnProperty(e)){if(o.ignoreDuplicateRegistrations)return;le(`Cannot register type '${c}' twice`)}if(ue[e]=r,delete pe[e],te.hasOwnProperty(e)){var h=te[e];delete te[e],h.forEach(m=>m())}}function ve(e,r,o={}){if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");return dt(e,r,o)}var Y=8,It=(e,r,o,c)=>{r=fe(r),ve(e,{name:r,fromWireType:function(h){return!!h},toWireType:function(h,m){return m?o:c},argPackAdvance:Y,readValueFromPointer:function(h){return this.fromWireType(B[h])},destructorFunction:null})},Ze=[],$e=[],he=e=>{e>9&&--$e[e+1]===0&&($e[e]=void 0,Ze.push(e))},rr=()=>$e.length/2-5-Ze.length,ht=()=>{$e.push(0,1,void 0,1,null,1,!0,1,!1,1),t.count_emval_handles=rr},re={toValue:e=>(e||le("Cannot use deleted val. handle = "+e),$e[e]),toHandle:e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const r=Ze.pop()||$e.length;return $e[r]=e,$e[r+1]=1,r}}}};function Qe(e){return this.fromWireType(S[e>>2])}var nr={name:"emscripten::val",fromWireType:e=>{var r=re.toValue(e);return he(e),r},toWireType:(e,r)=>re.toHandle(r),argPackAdvance:Y,readValueFromPointer:Qe,destructorFunction:null},ir=e=>ve(e,nr),ar=(e,r)=>{switch(r){case 4:return function(o){return this.fromWireType(z[o>>2])};case 8:return function(o){return this.fromWireType(O[o>>3])};default:throw new TypeError(`invalid float width (${r}): ${e}`)}},Le=(e,r,o)=>{r=fe(r),ve(e,{name:r,fromWireType:c=>c,toWireType:(c,h)=>h,argPackAdvance:Y,readValueFromPointer:ar(r,o),destructorFunction:null})},Ge=(e,r)=>Object.defineProperty(r,"name",{value:e}),jt=e=>{for(;e.length;){var r=e.pop(),o=e.pop();o(r)}};function or(e){for(var r=1;r<e.length;++r)if(e[r]!==null&&e[r].destructorFunction===void 0)return!0;return!1}function sr(e,r,o,c,h,m){var w=r.length;w<2&&le("argTypes array size mismatch! Must at least get return value and 'this' types!"),r[1];var y=or(r),A=r[0].name!=="void",C=w-2,L=new Array(C),Z=[],ge=[],Ie=function(...He){He.length!==C&&le(`function ${e} called with ${He.length} arguments, expected ${C}`),ge.length=0;var gn;Z.length=1,Z[0]=h;for(var it=0;it<C;++it)L[it]=r[it+2].toWireType(ge,He[it]),Z.push(L[it]);var mn=c(...Z);function pn(vn){if(y)jt(ge);else for(var at=2;at<r.length;at++){var yn=at===1?gn:L[at-2];r[at].destructorFunction!==null&&r[at].destructorFunction(yn)}if(A)return r[0].fromWireType(vn)}return pn(mn)};return Ge(e,Ie)}var lr=(e,r,o)=>{if(e[r].overloadTable===void 0){var c=e[r];e[r]=function(...h){return e[r].overloadTable.hasOwnProperty(h.length)||le(`Function '${o}' called with an invalid number of arguments (${h.length}) - expects one of (${e[r].overloadTable})!`),e[r].overloadTable[h.length].apply(this,h)},e[r].overloadTable=[],e[r].overloadTable[c.argCount]=c}},cr=(e,r,o)=>{t.hasOwnProperty(e)?((o===void 0||t[e].overloadTable!==void 0&&t[e].overloadTable[o]!==void 0)&&le(`Cannot register public name '${e}' twice`),lr(t,e,e),t.hasOwnProperty(o)&&le(`Cannot register multiple overloads of a function with the same number of arguments (${o})!`),t[e].overloadTable[o]=r):(t[e]=r,o!==void 0&&(t[e].numArguments=o))},fr=(e,r)=>{for(var o=[],c=0;c<e;c++)o.push(S[r+c*4>>2]);return o},ur=(e,r,o)=>{t.hasOwnProperty(e)||Pt("Replacing nonexistent public symbol"),t[e].overloadTable!==void 0&&o!==void 0?t[e].overloadTable[o]=r:(t[e]=r,t[e].argCount=o)},dr=(e,r,o)=>{e=e.replace(/p/g,"i");var c=t["dynCall_"+e];return c(r,...o)},et=[],Mt,Ke=e=>{var r=et[e];return r||(e>=et.length&&(et.length=e+1),et[e]=r=Mt.get(e)),r},Ot=(e,r,o=[])=>{if(e.includes("j"))return dr(e,r,o);var c=Ke(r)(...o);return c},hr=(e,r)=>(...o)=>Ot(e,r,o),gr=(e,r)=>{e=fe(e);function o(){return e.includes("j")?hr(e,r):Ke(r)}var c=o();return typeof c!="function"&&le(`unknown function pointer with signature ${e}: ${r}`),c},mr=(e,r)=>{var o=Ge(r,function(c){this.name=r,this.message=c;var h=new Error(c).stack;h!==void 0&&(this.stack=this.toString()+`
`+h.replace(/^Error(:[^\n]*)?\n/,""))});return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},o},gt,mt=e=>{var r=zt(e),o=fe(r);return Pe(r),o},pr=(e,r)=>{var o=[],c={};function h(m){if(!c[m]&&!ue[m]){if(pe[m]){pe[m].forEach(h);return}o.push(m),c[m]=!0}}throw r.forEach(h),new gt(`${e}: `+o.map(mt).join([", "]))},vr=e=>{e=e.trim();const r=e.indexOf("(");return r!==-1?e.substr(0,r):e},yr=(e,r,o,c,h,m,w)=>{var y=fr(r,o);e=fe(e),e=vr(e),h=gr(c,h),cr(e,function(){pr(`Cannot call ${e} due to unbound types`,y)},r-1),tr([],y,A=>{var C=[A[0],null].concat(A.slice(1));return ur(e,sr(e,C,null,h,m),r-1),[]})},br=(e,r,o)=>{switch(r){case 1:return o?c=>ce[c]:c=>B[c];case 2:return o?c=>K[c>>1]:c=>me[c>>1];case 4:return o?c=>_e[c>>2]:c=>S[c>>2];default:throw new TypeError(`invalid integer width (${r}): ${e}`)}},_r=(e,r,o,c,h)=>{r=fe(r);var m=L=>L;if(c===0){var w=32-8*o;m=L=>L<<w>>>w}var y=r.includes("unsigned"),A=(L,Z)=>{},C;y?C=function(L,Z){return A(Z,this.name),Z>>>0}:C=function(L,Z){return A(Z,this.name),Z},ve(e,{name:r,fromWireType:m,toWireType:C,argPackAdvance:Y,readValueFromPointer:br(r,o,c!==0),destructorFunction:null})},wr=(e,r,o)=>{var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],h=c[r];function m(w){var y=S[w>>2],A=S[w+4>>2];return new h(ce.buffer,A,y)}o=fe(o),ve(e,{name:o,fromWireType:m,argPackAdvance:Y,readValueFromPointer:m},{ignoreDuplicateRegistrations:!0})},Ar=(e,r,o,c)=>{if(!(c>0))return 0;for(var h=o,m=o+c-1,w=0;w<e.length;++w){var y=e.charCodeAt(w);if(y>=55296&&y<=57343){var A=e.charCodeAt(++w);y=65536+((y&1023)<<10)|A&1023}if(y<=127){if(o>=m)break;r[o++]=y}else if(y<=2047){if(o+1>=m)break;r[o++]=192|y>>6,r[o++]=128|y&63}else if(y<=65535){if(o+2>=m)break;r[o++]=224|y>>12,r[o++]=128|y>>6&63,r[o++]=128|y&63}else{if(o+3>=m)break;r[o++]=240|y>>18,r[o++]=128|y>>12&63,r[o++]=128|y>>6&63,r[o++]=128|y&63}}return r[o]=0,o-h},$r=(e,r,o)=>Ar(e,B,r,o),Er=e=>{for(var r=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c<=127?r++:c<=2047?r+=2:c>=55296&&c<=57343?(r+=4,++o):r+=3}return r},Dt=(e,r,o)=>{for(var c=r+o,h="";!(r>=c);){var m=e[r++];if(!m)return h;if(!(m&128)){h+=String.fromCharCode(m);continue}var w=e[r++]&63;if((m&224)==192){h+=String.fromCharCode((m&31)<<6|w);continue}var y=e[r++]&63;if((m&240)==224?m=(m&15)<<12|w<<6|y:m=(m&7)<<18|w<<12|y<<6|e[r++]&63,m<65536)h+=String.fromCharCode(m);else{var A=m-65536;h+=String.fromCharCode(55296|A>>10,56320|A&1023)}}return h},Tr=(e,r)=>e?Dt(B,e,r):"",Rr=(e,r)=>{r=fe(r);var o=r==="std::string";ve(e,{name:r,fromWireType(c){var h=S[c>>2],m=c+4,w;if(o)for(var y=m,A=0;A<=h;++A){var C=m+A;if(A==h||B[C]==0){var L=C-y,Z=Tr(y,L);w===void 0?w=Z:(w+="\0",w+=Z),y=C+1}}else{for(var ge=new Array(h),A=0;A<h;++A)ge[A]=String.fromCharCode(B[m+A]);w=ge.join("")}return Pe(c),w},toWireType(c,h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));var m,w=typeof h=="string";w||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int8Array||le("Cannot pass non-string to std::string"),o&&w?m=Er(h):m=h.length;var y=Vr(4+m+1),A=y+4;if(S[y>>2]=m,o&&w)$r(h,A,m+1);else if(w)for(var C=0;C<m;++C){var L=h.charCodeAt(C);L>255&&(Pe(A),le("String has UTF-16 code units that do not fit in 8 bits")),B[A+C]=L}else for(var C=0;C<m;++C)B[A+C]=h[C];return c!==null&&c.push(Pe,y),y},argPackAdvance:Y,readValueFromPointer:Qe,destructorFunction(c){Pe(c)}})},Cr=(e,r)=>{for(var o="",c=0;!(c>=r/2);++c){var h=K[e+c*2>>1];if(h==0)break;o+=String.fromCharCode(h)}return o},Sr=(e,r,o)=>{if(o??(o=2147483647),o<2)return 0;o-=2;for(var c=r,h=o<e.length*2?o/2:e.length,m=0;m<h;++m){var w=e.charCodeAt(m);K[r>>1]=w,r+=2}return K[r>>1]=0,r-c},Wr=e=>e.length*2,xr=(e,r)=>{for(var o=0,c="";!(o>=r/4);){var h=_e[e+o*4>>2];if(h==0)break;if(++o,h>=65536){var m=h-65536;c+=String.fromCharCode(55296|m>>10,56320|m&1023)}else c+=String.fromCharCode(h)}return c},Nt=(e,r,o)=>{if(o??(o=2147483647),o<4)return 0;for(var c=r,h=c+o-4,m=0;m<e.length;++m){var w=e.charCodeAt(m);if(w>=55296&&w<=57343){var y=e.charCodeAt(++m);w=65536+((w&1023)<<10)|y&1023}if(_e[r>>2]=w,r+=4,r+4>h)break}return _e[r>>2]=0,r-c},Ur=e=>{for(var r=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c>=55296&&c<=57343&&++o,r+=4}return r},Fr=(e,r,o)=>{o=fe(o);var c,h,m,w;r===2?(c=Cr,h=Sr,w=Wr,m=y=>me[y>>1]):r===4&&(c=xr,h=Nt,w=Ur,m=y=>S[y>>2]),ve(e,{name:o,fromWireType:y=>{for(var A=S[y>>2],C,L=y+4,Z=0;Z<=A;++Z){var ge=y+4+Z*r;if(Z==A||m(ge)==0){var Ie=ge-L,He=c(L,Ie);C===void 0?C=He:(C+="\0",C+=He),L=ge+r}}return Pe(y),C},toWireType:(y,A)=>{typeof A!="string"&&le(`Cannot pass non-string to C++ string type ${o}`);var C=w(A),L=Vr(4+C+r);return S[L>>2]=C/r,h(A,L+4,C+r),y!==null&&y.push(Pe,L),L},argPackAdvance:Y,readValueFromPointer:Qe,destructorFunction(y){Pe(y)}})},kr=(e,r)=>{r=fe(r),ve(e,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:()=>{},toWireType:(o,c)=>{}})},Pr=(e,r,o)=>B.copyWithin(e,r,r+o),tt=[],Ir=(e,r,o,c)=>(e=tt[e],r=re.toValue(r),e(null,r,o,c)),jr={},Mr=e=>{var r=jr[e];return r===void 0?fe(e):r},Lt=()=>{if(typeof globalThis=="object")return globalThis;function e(r){r.$$$embind_global$$$=r;var o=typeof $$$embind_global$$$=="object"&&r.$$$embind_global$$$==r;return o||delete r.$$$embind_global$$$,o}if(typeof $$$embind_global$$$=="object"||(typeof ot=="object"&&e(ot)?$$$embind_global$$$=ot:typeof self=="object"&&e(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Or=e=>e===0?re.toHandle(Lt()):(e=Mr(e),re.toHandle(Lt()[e])),Dr=e=>{var r=tt.length;return tt.push(e),r},Nr=(e,r)=>{var o=ue[e];return o===void 0&&le(`${r} has unknown type ${mt(e)}`),o},pt=(e,r)=>{for(var o=new Array(e),c=0;c<e;++c)o[c]=Nr(S[r+c*4>>2],"parameter "+c);return o},Ee=Reflect.construct,Ht=(e,r,o)=>{var c=[],h=e.toWireType(c,o);return c.length&&(S[r>>2]=re.toHandle(c)),h},Vt=(e,r,o)=>{var c=pt(e,r),h=c.shift();e--;var m=new Array(e),w=(A,C,L,Z)=>{for(var ge=0,Ie=0;Ie<e;++Ie)m[Ie]=c[Ie].readValueFromPointer(Z+ge),ge+=c[Ie].argPackAdvance;var He=o===1?Ee(C,m):C.apply(A,m);return Ht(h,L,He)},y=`methodCaller<(${c.map(A=>A.name).join(", ")}) => ${h.name}>`;return Dr(Ge(y,w))},rt=e=>{e>9&&($e[e+1]+=1)},Bt=e=>{var r=re.toValue(e);jt(r),he(e)},n=()=>{Wt("")},a=()=>2147483648,s=e=>{var r=xe.buffer,o=(e-r.byteLength+65535)/65536;try{return xe.grow(o),k(),1}catch{}},f=e=>{var r=B.length;e>>>=0;var o=a();if(e>o)return!1;for(var c=(A,C)=>A+(C-A%C)%C,h=1;h<=4;h*=2){var m=r*(1+.2/h);m=Math.min(m,e+100663296);var w=Math.min(o,c(Math.max(e,m),65536)),y=s(w);if(y)return!0}return!1},d={},g=()=>q||"./this.program",b=()=>{if(!b.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:g()};for(var o in d)d[o]===void 0?delete r[o]:r[o]=d[o];var c=[];for(var o in r)c.push(`${o}=${r[o]}`);b.strings=c}return b.strings},p=(e,r)=>{for(var o=0;o<e.length;++o)ce[r++]=e.charCodeAt(o);ce[r]=0},$=(e,r)=>{var o=0;return b().forEach((c,h)=>{var m=r+o;S[e+h*4>>2]=m,p(c,m),o+=c.length+1}),0},W=(e,r)=>{var o=b();S[e>>2]=o.length;var c=0;return o.forEach(h=>c+=h.length+1),S[r>>2]=c,0},J=e=>{F(e,new Zt(e))},N=(e,r)=>{J(e)},ee=N,Se=e=>52;function Xe(e,r,o,c,h){return 70}var We=[null,[],[]],nt=(e,r)=>{var o=We[e];r===0||r===10?((e===1?G:ie)(Dt(o,0)),o.length=0):o.push(r)},Lr=(e,r,o,c)=>{for(var h=0,m=0;m<o;m++){var w=S[r>>2],y=S[r+4>>2];r+=8;for(var A=0;A<y;A++)nt(e,B[w+A]);h+=y}return S[c>>2]=h,0};ut(),qe=t.BindingError=class extends Error{constructor(r){super(r),this.name="BindingError"}},kt=t.InternalError=class extends Error{constructor(r){super(r),this.name="InternalError"}},ht(),gt=t.UnboundTypeError=mr(Error,"UnboundTypeError");var Hr={o:Qt,q:er,m:It,l:ir,j:Le,f:yr,b:_r,a:wr,e:Rr,c:Fr,n:kr,v:Pr,i:Ir,d:he,k:Or,h:Vt,y:rt,g:Bt,r:n,s:f,t:$,u:W,z:ee,w:Se,p:Xe,x:Lr},oe=xt(),zt=e=>(zt=oe.C)(e),Vr=e=>(Vr=oe.D)(e),Pe=e=>(Pe=oe.E)(e),Zr=e=>(Zr=oe.G)(e);t.dynCall_jiji=(e,r,o,c,h)=>(t.dynCall_jiji=oe.H)(e,r,o,c,h);var qt;Ce=function e(){qt||Qr(),qt||(Ce=e)};function Qr(){if(Ae>0||(ae(),Ae>0))return;function e(){qt||(qt=!0,t.calledRun=!0,!De&&(X(),u(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),we()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),e()},1)):e()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Qr(),T}})();const Cn={preserveOrientation:!1};let Xr;async function Sn(i,l){Xr=Tn(Rn,i,l)}async function Wn(i,l={}){Xr||Sn();const t={...Cn,...l},v=(await Xr).decode(i,t.preserveOrientation);if(!v)throw new Error("Decoding error");return v}let Oe;const nn=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&nn.decode();let vt=null;function an(){return(vt===null||vt.byteLength===0)&&(vt=new Uint8Array(Oe.memory.buffer)),vt}function xn(i,l){return i=i>>>0,nn.decode(an().subarray(i,i+l))}let yt=null;function Un(){return(yt===null||yt.byteLength===0)&&(yt=new Uint8ClampedArray(Oe.memory.buffer)),yt}function Fn(i,l){return i=i>>>0,Un().subarray(i/1,i/1+l)}const je=new Array(128).fill(void 0);je.push(void 0,null,!0,!1);let Rt=je.length;function kn(i){Rt===je.length&&je.push(je.length+1);const l=Rt;return Rt=je[l],je[l]=i,l}let on=0;function Pn(i,l){const t=l(i.length*1,1)>>>0;return an().set(i,t/1),on=i.length,t}function In(i){return je[i]}function jn(i){i<132||(je[i]=Rt,Rt=i)}function Mn(i){const l=In(i);return jn(i),l}function On(i){const l=Pn(i,Oe.__wbindgen_malloc),t=on,u=Oe.decode(l,t);return Mn(u)}async function Dn(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const t=await i.arrayBuffer();return await WebAssembly.instantiate(t,l)}else{const t=await WebAssembly.instantiate(i,l);return t instanceof WebAssembly.Instance?{instance:t,module:i}:t}}function Nn(){const i={};return i.wbg={},i.wbg.__wbg_newwithownedu8clampedarrayandsh_91db5987993a08fb=function(l,t,u,v){var T=Fn(l,t).slice();Oe.__wbindgen_free(l,t*1,1);const E=new ImageData(T,u>>>0,v>>>0);return kn(E)},i.wbg.__wbindgen_throw=function(l,t){throw new Error(xn(l,t))},i}function Ln(i,l){return Oe=i.exports,sn.__wbindgen_wasm_module=l,vt=null,yt=null,Oe}async function sn(i){if(Oe!==void 0)return Oe;typeof i>"u"&&(i=new URL("/assets/squoosh_png_bg-BsfxGNEB.wasm",import.meta.url));const l=Nn();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:t,module:u}=await Dn(await i,l);return Ln(t,u)}const Hn=globalThis.ServiceWorkerGlobalScope!==void 0,Vn=Hn&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,Bn=typeof Q=="object"&&Q.release&&Q.release.name==="node";(Vn||Bn)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,t,u){this.data=l,this.width=t,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let zr;async function zn(i){return zr||(zr=sn(i)),zr}async function qn(i){await zn();const l=await On(new Uint8Array(i));if(!l)throw new Error("Encoding error.");return l}var Gn=(()=>{var i=import.meta.url;return function(t={}){var t=typeof t<"u"?t:{},u,v;t.ready=new Promise(function(n,a){u=n,v=a});const E=globalThis.ServiceWorkerGlobalScope!==void 0&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,_=typeof Q=="object"&&Q.release&&Q.release.name==="node";(E||_)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(a,s,f){this.data=a,this.width=s,this.height=f}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));var R=Object.assign({},t),U=typeof window=="object",q=typeof importScripts=="function";typeof Q=="object"&&typeof Q.versions=="object"&&Q.versions.node;var F="";function se(n){return t.locateFile?t.locateFile(n,F):F+n}var I;(U||q)&&(q?F=self.location.href:typeof document<"u"&&document.currentScript&&(F=document.currentScript.src),i&&(F=i),F.indexOf("blob:")!==0?F=F.substr(0,F.replace(/[?#].*/,"").lastIndexOf("/")+1):F="",q&&(I=n=>{var a=new XMLHttpRequest;return a.open("GET",n,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)})),t.print||console.log.bind(console);var M=t.printErr||console.warn.bind(console);Object.assign(t,R),R=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&t.quit;var ne;t.wasmBinary&&(ne=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&ze("no native wasm support detected");var P,G=!1;function ie(n,a,s){for(var f=a+s,d="";!(a>=f);){var g=n[a++];if(!g)return d;if(!(g&128)){d+=String.fromCharCode(g);continue}var b=n[a++]&63;if((g&224)==192){d+=String.fromCharCode((g&31)<<6|b);continue}var p=n[a++]&63;if((g&240)==224?g=(g&15)<<12|b<<6|p:g=(g&7)<<18|b<<12|p<<6|n[a++]&63,g<65536)d+=String.fromCharCode(g);else{var $=g-65536;d+=String.fromCharCode(55296|$>>10,56320|$&1023)}}return d}function be(n,a){return n?ie(K,n,a):""}function xe(n,a,s,f){if(!(f>0))return 0;for(var d=s,g=s+f-1,b=0;b<n.length;++b){var p=n.charCodeAt(b);if(p>=55296&&p<=57343){var $=n.charCodeAt(++b);p=65536+((p&1023)<<10)|$&1023}if(p<=127){if(s>=g)break;a[s++]=p}else if(p<=2047){if(s+1>=g)break;a[s++]=192|p>>6,a[s++]=128|p&63}else if(p<=65535){if(s+2>=g)break;a[s++]=224|p>>12,a[s++]=128|p>>6&63,a[s++]=128|p&63}else{if(s+3>=g)break;a[s++]=240|p>>18,a[s++]=128|p>>12&63,a[s++]=128|p>>6&63,a[s++]=128|p&63}}return a[s]=0,s-d}function De(n,a,s){return xe(n,K,a,s)}function ce(n){for(var a=0,s=0;s<n.length;++s){var f=n.charCodeAt(s);f<=127?a++:f<=2047?a+=2:f>=55296&&f<=57343?(a+=4,++s):a+=3}return a}var B,K,me,_e,S,z,O,k;function j(){var n=P.buffer;t.HEAP8=B=new Int8Array(n),t.HEAP16=me=new Int16Array(n),t.HEAP32=S=new Int32Array(n),t.HEAPU8=K=new Uint8Array(n),t.HEAPU16=_e=new Uint16Array(n),t.HEAPU32=z=new Uint32Array(n),t.HEAPF32=O=new Float32Array(n),t.HEAPF64=k=new Float64Array(n)}var D,V=[],ae=[],X=[];function we(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ne(t.preRun.shift());ft(V)}function de(){ft(ae)}function Ve(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ce(t.postRun.shift());ft(X)}function Ne(n){V.unshift(n)}function Ae(n){ae.unshift(n)}function Ce(n){X.unshift(n)}var Ue=0,Be=null;function Wt(n){Ue++,t.monitorRunDependencies&&t.monitorRunDependencies(Ue)}function Yt(n){if(Ue--,t.monitorRunDependencies&&t.monitorRunDependencies(Ue),Ue==0&&Be){var a=Be;Be=null,a()}}function ze(n){t.onAbort&&t.onAbort(n),n="Aborted("+n+")",M(n),G=!0,n+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(n);throw v(a),a}var Fe="data:application/octet-stream;base64,";function st(n){return n.startsWith(Fe)}var ke;t.locateFile?(ke="webp_dec.wasm",st(ke)||(ke=se(ke))):ke=new URL("/assets/webp_dec-C990n7mh.wasm",import.meta.url).href;function lt(n){try{if(n==ke&&ne)return new Uint8Array(ne);if(I)return I(n);throw"both async and sync fetching of the wasm failed"}catch(a){ze(a)}}function Jt(n){return!ne&&(U||q)&&typeof fetch=="function"?fetch(n,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+n+"'";return a.arrayBuffer()}).catch(function(){return lt(n)}):Promise.resolve().then(function(){return lt(n)})}function xt(n,a,s){return Jt(n).then(function(f){return WebAssembly.instantiate(f,a)}).then(function(f){return f}).then(s,function(f){M("failed to asynchronously prepare wasm: "+f),ze(f)})}function Zt(n,a,s,f){return!n&&typeof WebAssembly.instantiateStreaming=="function"&&!st(a)&&typeof fetch=="function"?fetch(a,{credentials:"same-origin"}).then(function(d){var g=WebAssembly.instantiateStreaming(d,s);return g.then(f,function(b){return M("wasm streaming compile failed: "+b),M("falling back to ArrayBuffer instantiation"),xt(a,s,f)})}):xt(a,s,f)}function ct(){var n={a:Nr};function a(f,d){var g=f.exports;return t.asm=g,P=t.asm.s,j(),D=t.asm.y,Ae(t.asm.t),Yt(),g}Wt();function s(f){a(f.instance)}if(t.instantiateWasm)try{return t.instantiateWasm(n,a)}catch(f){M("Module.instantiateWasm callback failed with error: "+f),v(f)}return Zt(ne,ke,n,s).catch(v),{}}function ft(n){for(;n.length>0;)n.shift()(t)}function Ut(n){this.excPtr=n,this.ptr=n-24,this.set_type=function(a){z[this.ptr+4>>2]=a},this.get_type=function(){return z[this.ptr+4>>2]},this.set_destructor=function(a){z[this.ptr+8>>2]=a},this.get_destructor=function(){return z[this.ptr+8>>2]},this.set_refcount=function(a){S[this.ptr>>2]=a},this.set_caught=function(a){a=a?1:0,B[this.ptr+12>>0]=a},this.get_caught=function(){return B[this.ptr+12>>0]!=0},this.set_rethrown=function(a){a=a?1:0,B[this.ptr+13>>0]=a},this.get_rethrown=function(){return B[this.ptr+13>>0]!=0},this.init=function(a,s){this.set_adjusted_ptr(0),this.set_type(a),this.set_destructor(s),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var a=S[this.ptr>>2];S[this.ptr>>2]=a+1},this.release_ref=function(){var a=S[this.ptr>>2];return S[this.ptr>>2]=a-1,a===1},this.set_adjusted_ptr=function(a){z[this.ptr+16>>2]=a},this.get_adjusted_ptr=function(){return z[this.ptr+16>>2]},this.get_exception_ptr=function(){var a=Vt(this.get_type());if(a)return z[this.excPtr>>2];var s=this.get_adjusted_ptr();return s!==0?s:this.excPtr}}function Qt(n,a,s){var f=new Ut(n);throw f.init(a,s),n}function er(n,a,s,f,d){}function ut(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}function Ft(){for(var n=new Array(256),a=0;a<256;++a)n[a]=String.fromCharCode(a);fe=n}var fe=void 0;function te(n){for(var a="",s=n;K[s];)a+=fe[K[s++]];return a}var ue={},pe={},qe={},le=48,kt=57;function Pt(n){if(n===void 0)return"_unknown";n=n.replace(/[^a-zA-Z0-9_]/g,"$");var a=n.charCodeAt(0);return a>=le&&a<=kt?"_"+n:n}function tr(n,a){return n=Pt(n),{[n]:function(){return a.apply(this,arguments)}}[n]}function dt(n,a){var s=tr(a,function(f){this.name=a,this.message=f;var d=new Error(f).stack;d!==void 0&&(this.stack=this.toString()+`
`+d.replace(/^Error(:[^\n]*)?\n/,""))});return s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},s}var ve=void 0;function Y(n){throw new ve(n)}var It=void 0;function Ze(n){throw new It(n)}function $e(n,a,s){n.forEach(function(p){qe[p]=a});function f(p){var $=s(p);$.length!==n.length&&Ze("Mismatched type converter count");for(var W=0;W<n.length;++W)he(n[W],$[W])}var d=new Array(a.length),g=[],b=0;a.forEach((p,$)=>{pe.hasOwnProperty(p)?d[$]=pe[p]:(g.push(p),ue.hasOwnProperty(p)||(ue[p]=[]),ue[p].push(()=>{d[$]=pe[p],++b,b===g.length&&f(d)}))}),g.length===0&&f(d)}function he(n,a,s={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");var f=a.name;if(n||Y('type "'+f+'" must have a positive integer typeid pointer'),pe.hasOwnProperty(n)){if(s.ignoreDuplicateRegistrations)return;Y("Cannot register type '"+f+"' twice")}if(pe[n]=a,delete qe[n],ue.hasOwnProperty(n)){var d=ue[n];delete ue[n],d.forEach(g=>g())}}function rr(n,a,s,f,d){var g=ut(s);a=te(a),he(n,{name:a,fromWireType:function(b){return!!b},toWireType:function(b,p){return p?f:d},argPackAdvance:8,readValueFromPointer:function(b){var p;if(s===1)p=B;else if(s===2)p=me;else if(s===4)p=S;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType(p[b>>g])},destructorFunction:null})}var ht=[],re=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Qe(n){n>4&&--re[n].refcount===0&&(re[n]=void 0,ht.push(n))}function nr(){for(var n=0,a=5;a<re.length;++a)re[a]!==void 0&&++n;return n}function ir(){for(var n=5;n<re.length;++n)if(re[n]!==void 0)return re[n];return null}function ar(){t.count_emval_handles=nr,t.get_first_emval=ir}var Le={toValue:n=>(n||Y("Cannot use deleted val. handle = "+n),re[n].value),toHandle:n=>{switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var a=ht.length?ht.pop():re.length;return re[a]={refcount:1,value:n},a}}}};function Ge(n){return this.fromWireType(S[n>>2])}function jt(n,a){a=te(a),he(n,{name:a,fromWireType:function(s){var f=Le.toValue(s);return Qe(s),f},toWireType:function(s,f){return Le.toHandle(f)},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:null})}function or(n,a){switch(a){case 2:return function(s){return this.fromWireType(O[s>>2])};case 3:return function(s){return this.fromWireType(k[s>>3])};default:throw new TypeError("Unknown float type: "+n)}}function sr(n,a,s){var f=ut(s);a=te(a),he(n,{name:a,fromWireType:function(d){return d},toWireType:function(d,g){return g},argPackAdvance:8,readValueFromPointer:or(a,f),destructorFunction:null})}function lr(n){for(;n.length;){var a=n.pop(),s=n.pop();s(a)}}function cr(n,a,s,f,d,g){var b=a.length;b<2&&Y("argTypes array size mismatch! Must at least get return value and 'this' types!"),a[1];for(var p=!1,$=1;$<a.length;++$)if(a[$]!==null&&a[$].destructorFunction===void 0){p=!0;break}var W=a[0].name!=="void",J=b-2,N=new Array(J),ee=[],Se=[];return function(){arguments.length!==J&&Y("function "+n+" called with "+arguments.length+" arguments, expected "+J+" args!"),Se.length=0;var Xe;ee.length=1,ee[0]=d;for(var We=0;We<J;++We)N[We]=a[We+2].toWireType(Se,arguments[We]),ee.push(N[We]);var nt=f.apply(null,ee);function Lr(Hr){if(p)lr(Se);else for(var oe=2;oe<a.length;oe++){var zt=oe===1?Xe:N[oe-2];a[oe].destructorFunction!==null&&a[oe].destructorFunction(zt)}if(W)return a[0].fromWireType(Hr)}return Lr(nt)}}function fr(n,a,s){if(n[a].overloadTable===void 0){var f=n[a];n[a]=function(){return n[a].overloadTable.hasOwnProperty(arguments.length)||Y("Function '"+s+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+n[a].overloadTable+")!"),n[a].overloadTable[arguments.length].apply(this,arguments)},n[a].overloadTable=[],n[a].overloadTable[f.argCount]=f}}function ur(n,a,s){t.hasOwnProperty(n)?((s===void 0||t[n].overloadTable!==void 0&&t[n].overloadTable[s]!==void 0)&&Y("Cannot register public name '"+n+"' twice"),fr(t,n,n),t.hasOwnProperty(s)&&Y("Cannot register multiple overloads of a function with the same number of arguments ("+s+")!"),t[n].overloadTable[s]=a):(t[n]=a,s!==void 0&&(t[n].numArguments=s))}function dr(n,a){for(var s=[],f=0;f<n;f++)s.push(z[a+f*4>>2]);return s}function et(n,a,s){t.hasOwnProperty(n)||Ze("Replacing nonexistant public symbol"),t[n].overloadTable!==void 0&&s!==void 0?t[n].overloadTable[s]=a:(t[n]=a,t[n].argCount=s)}function Mt(n,a,s){var f=t["dynCall_"+n];return s&&s.length?f.apply(null,[a].concat(s)):f.call(null,a)}var Ke=[];function Ot(n){var a=Ke[n];return a||(n>=Ke.length&&(Ke.length=n+1),Ke[n]=a=D.get(n)),a}function hr(n,a,s){if(n.includes("j"))return Mt(n,a,s);var f=Ot(a).apply(null,s);return f}function gr(n,a){var s=[];return function(){return s.length=0,Object.assign(s,arguments),hr(n,a,s)}}function mr(n,a){n=te(n);function s(){return n.includes("j")?gr(n,a):Ot(a)}var f=s();return typeof f!="function"&&Y("unknown function pointer with signature "+n+": "+a),f}var gt=void 0;function mt(n){var a=Ht(n),s=te(a);return Ee(a),s}function pr(n,a){var s=[],f={};function d(g){if(!f[g]&&!pe[g]){if(qe[g]){qe[g].forEach(d);return}s.push(g),f[g]=!0}}throw a.forEach(d),new gt(n+": "+s.map(mt).join([", "]))}function vr(n,a,s,f,d,g,b){var p=dr(a,s);n=te(n),d=mr(f,d),ur(n,function(){pr("Cannot call "+n+" due to unbound types",p)},a-1),$e([],p,function($){var W=[$[0],null].concat($.slice(1));return et(n,cr(n,W,null,d,g),a-1),[]})}function yr(n,a,s){switch(a){case 0:return s?function(d){return B[d]}:function(d){return K[d]};case 1:return s?function(d){return me[d>>1]}:function(d){return _e[d>>1]};case 2:return s?function(d){return S[d>>2]}:function(d){return z[d>>2]};default:throw new TypeError("Unknown integer type: "+n)}}function br(n,a,s,f,d){a=te(a);var g=ut(s),b=N=>N;if(f===0){var p=32-8*s;b=N=>N<<p>>>p}var $=a.includes("unsigned"),W=(N,ee)=>{},J;$?J=function(N,ee){return W(ee,this.name),ee>>>0}:J=function(N,ee){return W(ee,this.name),ee},he(n,{name:a,fromWireType:b,toWireType:J,argPackAdvance:8,readValueFromPointer:yr(a,g,f!==0),destructorFunction:null})}function _r(n,a,s){var f=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],d=f[a];function g(b){b=b>>2;var p=z,$=p[b],W=p[b+1];return new d(p.buffer,W,$)}s=te(s),he(n,{name:s,fromWireType:g,argPackAdvance:8,readValueFromPointer:g},{ignoreDuplicateRegistrations:!0})}function wr(n,a){a=te(a);var s=a==="std::string";he(n,{name:a,fromWireType:function(f){var d=z[f>>2],g=f+4,b;if(s)for(var p=g,$=0;$<=d;++$){var W=g+$;if($==d||K[W]==0){var J=W-p,N=be(p,J);b===void 0?b=N:(b+="\0",b+=N),p=W+1}}else{for(var ee=new Array(d),$=0;$<d;++$)ee[$]=String.fromCharCode(K[g+$]);b=ee.join("")}return Ee(f),b},toWireType:function(f,d){d instanceof ArrayBuffer&&(d=new Uint8Array(d));var g,b=typeof d=="string";b||d instanceof Uint8Array||d instanceof Uint8ClampedArray||d instanceof Int8Array||Y("Cannot pass non-string to std::string"),s&&b?g=ce(d):g=d.length;var p=pt(4+g+1),$=p+4;if(z[p>>2]=g,s&&b)De(d,$,g+1);else if(b)for(var W=0;W<g;++W){var J=d.charCodeAt(W);J>255&&(Ee($),Y("String has UTF-16 code units that do not fit in 8 bits")),K[$+W]=J}else for(var W=0;W<g;++W)K[$+W]=d[W];return f!==null&&f.push(Ee,p),p},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:function(f){Ee(f)}})}function Ar(n,a){for(var s="",f=0;!(f>=a/2);++f){var d=me[n+f*2>>1];if(d==0)break;s+=String.fromCharCode(d)}return s}function $r(n,a,s){if(s===void 0&&(s=2147483647),s<2)return 0;s-=2;for(var f=a,d=s<n.length*2?s/2:n.length,g=0;g<d;++g){var b=n.charCodeAt(g);me[a>>1]=b,a+=2}return me[a>>1]=0,a-f}function Er(n){return n.length*2}function Dt(n,a){for(var s=0,f="";!(s>=a/4);){var d=S[n+s*4>>2];if(d==0)break;if(++s,d>=65536){var g=d-65536;f+=String.fromCharCode(55296|g>>10,56320|g&1023)}else f+=String.fromCharCode(d)}return f}function Tr(n,a,s){if(s===void 0&&(s=2147483647),s<4)return 0;for(var f=a,d=f+s-4,g=0;g<n.length;++g){var b=n.charCodeAt(g);if(b>=55296&&b<=57343){var p=n.charCodeAt(++g);b=65536+((b&1023)<<10)|p&1023}if(S[a>>2]=b,a+=4,a+4>d)break}return S[a>>2]=0,a-f}function Rr(n){for(var a=0,s=0;s<n.length;++s){var f=n.charCodeAt(s);f>=55296&&f<=57343&&++s,a+=4}return a}function Cr(n,a,s){s=te(s);var f,d,g,b,p;a===2?(f=Ar,d=$r,b=Er,g=()=>_e,p=1):a===4&&(f=Dt,d=Tr,b=Rr,g=()=>z,p=2),he(n,{name:s,fromWireType:function($){for(var W=z[$>>2],J=g(),N,ee=$+4,Se=0;Se<=W;++Se){var Xe=$+4+Se*a;if(Se==W||J[Xe>>p]==0){var We=Xe-ee,nt=f(ee,We);N===void 0?N=nt:(N+="\0",N+=nt),ee=Xe+a}}return Ee($),N},toWireType:function($,W){typeof W!="string"&&Y("Cannot pass non-string to C++ string type "+s);var J=b(W),N=pt(4+J+a);return z[N>>2]=J>>p,d(W,N+4,J+a),$!==null&&$.push(Ee,N),N},argPackAdvance:8,readValueFromPointer:Ge,destructorFunction:function($){Ee($)}})}function Sr(n,a){a=te(a),he(n,{isVoid:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(s,f){}})}var Wr={};function xr(n){var a=Wr[n];return a===void 0?te(n):a}function Nt(){if(typeof globalThis=="object")return globalThis;function n(a){a.$$$embind_global$$$=a;var s=typeof $$$embind_global$$$=="object"&&a.$$$embind_global$$$==a;return s||delete a.$$$embind_global$$$,s}if(typeof $$$embind_global$$$=="object"||(typeof ot=="object"&&n(ot)?$$$embind_global$$$=ot:typeof self=="object"&&n(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")}function Ur(n){return n===0?Le.toHandle(Nt()):(n=xr(n),Le.toHandle(Nt()[n]))}function Fr(n){n>4&&(re[n].refcount+=1)}function kr(n,a){var s=pe[n];return s===void 0&&Y(a+" has unknown type "+mt(n)),s}function Pr(n){var a=new Array(n+1);return function(s,f,d){a[0]=s;for(var g=0;g<n;++g){var b=kr(z[f+g*4>>2],"parameter "+g);a[g+1]=b.readValueFromPointer(d),d+=b.argPackAdvance}var p=new(s.bind.apply(s,a));return Le.toHandle(p)}}var tt={};function Ir(n,a,s,f){n=Le.toValue(n);var d=tt[a];return d||(d=Pr(a),tt[a]=d),d(n,s,f)}function jr(){ze("")}function Mr(n,a,s){K.copyWithin(n,a,a+s)}function Lt(){return 2147483648}function Or(n){var a=P.buffer;try{return P.grow(n-a.byteLength+65535>>>16),j(),1}catch{}}function Dr(n){var a=K.length;n=n>>>0;var s=Lt();if(n>s)return!1;let f=($,W)=>$+(W-$%W)%W;for(var d=1;d<=4;d*=2){var g=a*(1+.2/d);g=Math.min(g,n+100663296);var b=Math.min(s,f(Math.max(n,g),65536)),p=Or(b);if(p)return!0}return!1}Ft(),ve=t.BindingError=dt(Error,"BindingError"),It=t.InternalError=dt(Error,"InternalError"),ar(),gt=t.UnboundTypeError=dt(Error,"UnboundTypeError");var Nr={n:Qt,o:er,l:rr,r:jt,k:sr,c:vr,b:br,a:_r,g:wr,f:Cr,m:Sr,d:Qe,e:Ur,i:Fr,h:Ir,j:jr,q:Mr,p:Dr};ct();var pt=function(){return(pt=t.asm.u).apply(null,arguments)},Ee=function(){return(Ee=t.asm.v).apply(null,arguments)},Ht=t.___getTypeName=function(){return(Ht=t.___getTypeName=t.asm.w).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.x).apply(null,arguments)};var Vt=function(){return(Vt=t.asm.z).apply(null,arguments)},rt;Be=function n(){rt||Bt(),rt||(Be=n)};function Bt(){if(Ue>0||(we(),Ue>0))return;function n(){rt||(rt=!0,t.calledRun=!0,!G&&(de(),u(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),Ve()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Bt(),t.ready}})();function Yr(i,l,t={}){return i({noInitialRun:!0,instantiateWasm:void 0,...t})}let Jr;async function Kn(i,l){Jr=Yr(Gn,i,l)}async function Xn(i){Jr||Kn();const t=(await Jr).decode(i);if(!t)throw new Error("Decoding error");return t}const Yn={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0},Jn=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));let Je;async function Zn(i,l){if(await Jn()){const u=await en(()=>import("./webp_enc_simd-B6XVdu2z.js"),__vite__mapDeps([0,1,2,3]));return Je=Yr(u.default,i,l),Je}const t=await en(()=>import("./webp_enc-8zj4ms51.js"),__vite__mapDeps([4,1,2,3]));return Je=Yr(t.default,i,l),Je}async function Qn(i,l={}){Je||(Je=Zn());const t={...Yn,...l},v=(await Je).encode(i.data,i.width,i.height,t);if(!v)throw new Error("Encoding error.");return v.buffer}function ei(i,l,t,u){const v=i/l,T=t/u;if(T>v){const R=i/T,U=(l-R)/2;return{sw:i,sh:R,sx:0,sy:U}}const E=l*T,_=(i-E)/2;return{sh:l,sw:E,sx:_,sy:0}}let ye,bt=null;function ti(){return(bt===null||bt.byteLength===0)&&(bt=new Uint8Array(ye.memory.buffer)),bt}let ln=0;function ri(i,l){const t=l(i.length*1,1)>>>0;return ti().set(i,t/1),ln=i.length,t}let _t=null;function tn(){return(_t===null||_t.byteLength===0)&&(_t=new Int32Array(ye.memory.buffer)),_t}let wt=null;function ni(){return(wt===null||wt.byteLength===0)&&(wt=new Uint8ClampedArray(ye.memory.buffer)),wt}function ii(i,l){return i=i>>>0,ni().subarray(i/1,i/1+l)}function ai(i,l,t,u,v,T,E,_){try{const F=ye.__wbindgen_add_to_stack_pointer(-16),se=ri(i,ye.__wbindgen_malloc),I=ln;ye.resize(F,se,I,l,t,u,v,T,E,_);var R=tn()[F/4+0],U=tn()[F/4+1],q=ii(R,U).slice();return ye.__wbindgen_free(R,U*1,1),q}finally{ye.__wbindgen_add_to_stack_pointer(16)}}async function oi(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const t=await i.arrayBuffer();return await WebAssembly.instantiate(t,l)}else{const t=await WebAssembly.instantiate(i,l);return t instanceof WebAssembly.Instance?{instance:t,module:i}:t}}function si(){const i={};return i.wbg={},i}function li(i,l){return ye=i.exports,cn.__wbindgen_wasm_module=l,_t=null,bt=null,wt=null,ye}async function cn(i){if(ye!==void 0)return ye;typeof i>"u"&&(i=new URL("/assets/squoosh_resize_bg-YY9xfwUg.wasm",import.meta.url));const l=si();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:t,module:u}=await oi(await i,l);return li(t,u)}const ci=globalThis.ServiceWorkerGlobalScope!==void 0,fi=ci&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,ui=typeof Q=="object"&&Q.release&&Q.release.name==="node";(fi||ui)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,t,u){this.data=l,this.width=t,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let Te,At=null;function fn(){return(At===null||At.byteLength===0)&&(At=new Uint32Array(Te.memory.buffer)),At}let un=0;function di(i,l){const t=l(i.length*4,4)>>>0;return fn().set(i,t/4),un=i.length,t}let $t=null;function rn(){return($t===null||$t.byteLength===0)&&($t=new Int32Array(Te.memory.buffer)),$t}function hi(i,l){return i=i>>>0,fn().subarray(i/4,i/4+l)}function gi(i,l,t,u){try{const _=Te.__wbindgen_add_to_stack_pointer(-16),R=di(i,Te.__wbindgen_malloc),U=un;Te.resize(_,R,U,l,t,u);var v=rn()[_/4+0],T=rn()[_/4+1],E=hi(v,T).slice();return Te.__wbindgen_free(v,T*4,4),E}finally{Te.__wbindgen_add_to_stack_pointer(16)}}async function mi(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const t=await i.arrayBuffer();return await WebAssembly.instantiate(t,l)}else{const t=await WebAssembly.instantiate(i,l);return t instanceof WebAssembly.Instance?{instance:t,module:i}:t}}function pi(){const i={};return i.wbg={},i}function vi(i,l){return Te=i.exports,dn.__wbindgen_wasm_module=l,$t=null,At=null,Te}async function dn(i){if(Te!==void 0)return Te;typeof i>"u"&&(i=new URL("/assets/squooshhqx_bg-jpRtGvMp.wasm",import.meta.url));const l=pi();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:t,module:u}=await mi(await i,l);return vi(t,u)}const yi=globalThis.ServiceWorkerGlobalScope!==void 0,bi=yi&&typeof self<"u"&&globalThis.caches&&globalThis.caches.default!==void 0,_i=typeof Q=="object"&&Q.release&&Q.release.name==="node";(bi||_i)&&(globalThis.ImageData||(globalThis.ImageData=class{constructor(l,t,u){this.data=l,this.width=t,this.height=u}}),import.meta.url===void 0&&(import.meta.url="https://localhost"),typeof self<"u"&&self.location===void 0&&(self.location={href:""}));let Re,Et=null;function wi(){return(Et===null||Et.byteLength===0)&&(Et=new Uint8ClampedArray(Re.memory.buffer)),Et}function Ai(i,l){return i=i>>>0,wi().subarray(i/1,i/1+l)}const Me=new Array(128).fill(void 0);Me.push(void 0,null,!0,!1);let Ct=Me.length;function $i(i){Ct===Me.length&&Me.push(Me.length+1);const l=Ct;return Ct=Me[l],Me[l]=i,l}let Tt=null;function Gt(){return(Tt===null||Tt.byteLength===0)&&(Tt=new Uint8Array(Re.memory.buffer)),Tt}let St=0;function Ei(i,l){const t=l(i.length*1,1)>>>0;return Gt().set(i,t/1),St=i.length,t}const Kt=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Ti=typeof Kt.encodeInto=="function"?function(i,l){return Kt.encodeInto(i,l)}:function(i,l){const t=Kt.encode(i);return l.set(t),{read:i.length,written:t.length}};function Ri(i,l,t){if(t===void 0){const _=Kt.encode(i),R=l(_.length,1)>>>0;return Gt().subarray(R,R+_.length).set(_),St=_.length,R}let u=i.length,v=l(u,1)>>>0;const T=Gt();let E=0;for(;E<u;E++){const _=i.charCodeAt(E);if(_>127)break;T[v+E]=_}if(E!==u){E!==0&&(i=i.slice(E)),v=t(v,u,u=E+i.length*3,1)>>>0;const _=Gt().subarray(v+E,v+u),R=Ti(i,_);E+=R.written,v=t(v,u,E,1)>>>0}return St=E,v}function Ci(i){return Me[i]}function Si(i){i<132||(Me[i]=Ct,Ct=i)}function Wi(i){const l=Ci(i);return Si(i),l}function xi(i,l,t,u,v,T){const E=Ei(i,Re.__wbindgen_malloc),_=St,R=Ri(T,Re.__wbindgen_malloc,Re.__wbindgen_realloc),U=St,q=Re.resize(E,_,l,t,u,v,R,U);return Wi(q)}async function Ui(i,l){if(typeof Response=="function"&&i instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(i,l)}catch(u){if(i.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",u);else throw u}const t=await i.arrayBuffer();return await WebAssembly.instantiate(t,l)}else{const t=await WebAssembly.instantiate(i,l);return t instanceof WebAssembly.Instance?{instance:t,module:i}:t}}function Fi(){const i={};return i.wbg={},i.wbg.__wbg_newwithownedu8clampedarrayandsh_2ac355435db12a85=function(l,t,u,v){var T=Ai(l,t).slice();Re.__wbindgen_free(l,t*1,1);const E=new ImageData(T,u>>>0,v>>>0);return $i(E)},i}function ki(i,l){return Re=i.exports,hn.__wbindgen_wasm_module=l,Tt=null,Et=null,Re}async function hn(i){if(Re!==void 0)return Re;typeof i<"u"&&(Object.getPrototypeOf(i)===Object.prototype?{module_or_path:i}=i:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof i>"u"&&(i=new URL("/assets/jsquash_magic_kernel_bg-CM70fO1F.wasm",import.meta.url));const l=Fi();(typeof i=="string"||typeof Request=="function"&&i instanceof Request||typeof URL=="function"&&i instanceof URL)&&(i=fetch(i));const{instance:t,module:u}=await Ui(await i,l);return ki(t,u)}const Pi={width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0},Ii=["magicKernel","magicKernelSharp2013","magicKernelSharp2021"];let Xt,qr,Gr;function ji(i){return Xt||(Xt=cn(i)),Xt}function Mi(i){return qr||(qr=dn(i)),qr}function Oi(i){return Gr||(Gr=hn(i)),Gr}function Di(i){return i.method==="hqx"}function Ni(i){return Ii.includes(i.method)}function Li(i,l,t,u,v){const T=new Uint32Array(i.data.buffer);for(let E=0;E<v;E+=1){const _=(E+t)*i.width+l;T.copyWithin(E*u,_,_+u)}return new ImageData(new Uint8ClampedArray(T.buffer.slice(0,u*v*4)),u,v)}function Hi(i,{min:l=Number.MIN_VALUE,max:t=Number.MAX_VALUE}){return Math.min(Math.max(i,l),t)}const Vi=["triangle","catrom","mitchell","lanczos3"];async function Bi(i,l){await Mi();const t=l.width/i.width,u=l.height/i.height,v=Math.max(t,u),T=Hi(Math.ceil(v),{min:1,max:4});if(T===1)return i;const E=gi(new Uint32Array(i.data.buffer),i.width,i.height,T);return new ImageData(new Uint8ClampedArray(E.buffer),i.width*T,i.height*T)}async function zi(i,l){return await Oi(),xi(new Uint8Array(i.data.buffer),i.width,i.height,l.width,l.height,l.method)}async function qi(i,l){let t={...Pi,...l},u=i;if(ji(),Di(t)&&(u=await Bi(u,t),t={...t,method:"catrom"}),await Xt,t.fitMethod==="contain"){const{sx:T,sy:E,sw:_,sh:R}=ei(i.width,i.height,t.width,t.height);u=Li(u,Math.round(T),Math.round(E),Math.round(_),Math.round(R))}if(Ni(t))return zi(u,t);const v=ai(new Uint8Array(u.data.buffer),u.width,u.height,t.width,t.height,Vi.indexOf(t.method),t.premultiply,t.linearRGB);return new ImageData(new Uint8ClampedArray(v.buffer),t.width,t.height)}const Gi={primaryLogo:{width:600,height:120},secondaryLogo:{width:120,height:120},favicon:{width:96,height:96},pnlPoster:{width:960,height:540},banner:{width:1200,height:630},logo:{width:400,height:400}};function Ki(i,l){const u=new OffscreenCanvas(l.width,l.height).getContext("2d");if(!u)throw new Error("Could not create canvas context for cropping");const v=new OffscreenCanvas(i.width,i.height),T=v.getContext("2d");if(!T)throw new Error("Could not create source canvas context");return T.putImageData(i,0,0),u.drawImage(v,l.x,l.y,l.width,l.height,0,0,l.width,l.height),u.getImageData(0,0,l.width,l.height)}async function Xi(i,l){let t;switch(i){case"jpeg":t=await Wn(l);break;case"png":t=await qn(l);break;case"webp":t=await Xn(l);break;default:throw new Error(`Unknown source type: ${i}`)}return t}async function Yi(i){return Qn(i,{quality:80})}function Ji(i){return new Promise((l,t)=>{const u=new Image;u.onload=()=>{l({width:u.width,height:u.height})},u.onerror=()=>{t(new Error("Failed to load image for dimension calculation"))},u.src=i})}function Zi(i){return new Promise(l=>{var u;const t=(u=i.clipboardData)==null?void 0:u.items;if(!t){l(null);return}for(let v=0;v<t.length;v++)if(t[v].type.indexOf("image")!==-1){const T=t[v].getAsFile();if(!T){l(null);return}const E=new FileReader;E.onload=_=>{var U;const R=(U=_.target)==null?void 0:U.result;l(typeof R=="string"?R:null)},E.onerror=()=>l(null),E.readAsDataURL(T);return}l(null)})}async function Qi(i,l,t,u="contain",v){try{const T=i.replace(/^data:[^,]+,/,""),E=Uint8Array.from(atob(T),F=>F.charCodeAt(0));let _;if(i.includes("image/png"))_="png";else if(i.includes("image/jpeg"))_="jpeg";else if(i.includes("image/webp"))_="webp";else throw new Error("Unsupported image format. Please use JPEG, PNG, or WebP.");let R=await Xi(_,E);v&&v.width>0&&v.height>0&&(R=Ki(R,v));const U=l&&t?await qi(R,{width:l,height:t,fitMethod:u}):R,q=await Yi(U);return new Blob([q],{type:"image/webp"})}catch(T){throw console.error("Error processing image:",T),new Error(`Failed to process image: ${T instanceof Error?T.message:String(T)}`)}}function ga({id:i,label:l,value:t,onChange:u,imageType:v,helpText:T}){const{openModal:E}=wn(),[_,R]=H.useState(!1),[U,q]=H.useState(null),[F,se]=H.useState(!1),I=H.useRef(null),M=H.useRef(null),ne=H.useRef(null),P=H.useRef(null),G=Gi[v],ie=v==="secondaryLogo"||v==="favicon"||v==="logo",be=v==="pnlPoster";H.useEffect(()=>{if(U&&URL.revokeObjectURL(U),t){const O=URL.createObjectURL(t);q(O)}else q(null);return()=>{U&&URL.revokeObjectURL(U)}},[t]);const xe=H.useCallback(async(O,k,j)=>{R(!0);try{const D=(j==null?void 0:j.width)||G.width,V=(j==null?void 0:j.height)||G.height;let ae=D,X=V;const we=D>G.width,de=V>G.height;if(we||de){const Ne=G.width/D,Ae=G.height/V,Ce=Math.min(Ne,Ae);ae=Math.round(D*Ce),X=Math.round(V*Ce)}const Ve=await Qi(O,ae,X,"contain",k);u(Ve)}catch(D){console.error("Image processing error:",D),Ye.error("Failed to process image. Please try again.")}finally{R(!1)}},[G,u]),De=H.useCallback(async O=>{if(!O){console.error("No image data provided"),Ye.error("No image data provided. Please try again."),R(!1);return}I.current=O;try{const k=await Ji(O);M.current=k;let j;if(v==="primaryLogo")j={x:0,y:0,width:k.width,height:k.height};else if(v==="pnlPoster"){const V=1.7777777777777777;let ae=k.width,X=k.width/V;X>k.height&&(X=k.height,ae=k.height*V);const we=Math.max(0,(k.width-ae)/2),de=Math.max(0,(k.height-X)/2);j={x:Math.round(we),y:Math.round(de),width:Math.round(ae),height:Math.round(X)}}else if(v==="banner")j={x:0,y:0,width:k.width,height:k.height};else{const V=Math.min(k.width,k.height);j={x:0,y:0,width:V,height:V}}E("imageCrop",{imageSource:O,originalDimensions:k,initialCrop:j,targetDimensions:G,enforceSquare:ie,enforce16by9:be,onApply:async(V,ae)=>{const X=I.current;if(!X){console.error("Missing original image source");return}if(V.width<=0||V.height<=0){console.error("Invalid crop dimensions");return}await xe(X,V,ae)}}),R(!1)}catch(k){console.error("Error getting image dimensions or processing image:",k),Ye.error("Could not process image. Please ensure it\\'s a valid image file."),R(!1)}},[E,xe,v,ie,be]),ce=H.useCallback(async O=>{var k;if(!_){R(!0);try{let j=null;if(O){let D;"nativeEvent"in O?(O.preventDefault(),D=O.nativeEvent):(O.preventDefault(),D=O),j=await Zi(D)}else try{const D=await navigator.clipboard.read();for(const V of D){for(const ae of V.types)if(ae.startsWith("image/")){const X=await V.getType(ae);j=await new Promise(we=>{const de=new FileReader;de.onload=Ve=>{var Ne;return we(((Ne=Ve.target)==null?void 0:Ne.result)||null)},de.readAsDataURL(X)});break}if(j)break}}catch(D){console.error("Clipboard API error:",D),Ye.error("Could not access clipboard. Please try using Ctrl+V or +V directly in the paste area."),(k=ne.current)==null||k.focus(),R(!1);return}if(!j){console.error("No image found in clipboard"),Ye.error("No image found in clipboard. Please copy an image first."),R(!1);return}await De(j)}catch(j){console.error("Image paste error:",j),R(!1)}}},[_,De]),B=async O=>{var j;if(_)return;const k=(j=O.target.files)==null?void 0:j[0];if(k){R(!0);try{const D=await new Promise((V,ae)=>{const X=new FileReader;X.onload=we=>{var de;return V((de=we.target)==null?void 0:de.result)},X.onerror=ae,X.readAsDataURL(k)});D?await De(D):(Ye.error("Could not read the selected image file."),R(!1))}catch(D){console.error("File selection error:",D),Ye.error("Failed to load the selected image. Please try again."),R(!1)}P.current&&(P.current.value="")}},K=()=>{I.current=null,M.current=null,u(null)},me=()=>se(!0),_e=()=>se(!1),S=async()=>{await ce()},z=()=>{P.current&&P.current.click()};return x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("label",{htmlFor:i,className:"block text-sm font-bold text-gray-200",children:l}),U&&x.jsx("button",{type:"button",onClick:K,className:"text-xs text-error hover:text-error/70 transition-colors",disabled:_,children:"Clear"})]}),x.jsx("div",{className:"mt-1",children:U?x.jsxs("div",{className:"relative group border border-light/15 rounded-lg p-2 flex justify-center items-center bg-base-8/30 min-h-[150px]",children:[x.jsx("img",{src:U,alt:`${v} preview`,className:"max-h-40 max-w-full object-contain rounded"}),x.jsx("button",{onClick:K,className:"absolute top-1.5 right-1.5 bg-black/50 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 hover:bg-black/70 transition-all focus:opacity-100","aria-label":"Remove image",type:"button",disabled:_,children:x.jsx("div",{className:"i-mdi:close h-3 w-3"})})]}):x.jsxs("div",{ref:ne,tabIndex:0,className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors min-h-[150px] flex flex-col justify-center items-center
              ${F?"border-primary-light bg-primary-light/5":"border-light/20 hover:border-light/30 bg-base-8/20"}
              ${_?"opacity-60 cursor-default pointer-events-none":""}`,onPaste:ce,onFocus:me,onBlur:_e,onKeyDown:O=>{var k;(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),(k=ne.current)==null||k.focus())},role:"button","aria-label":l?String(l):"Paste image area",children:[x.jsx("div",{className:`mx-auto mb-2 ${F?"text-primary-light":"text-gray-400"}`,children:x.jsx("div",{className:"i-mdi:image-outline h-10 w-10 mx-auto"})}),x.jsx("p",{className:`text-sm ${F?"text-gray-200":"text-gray-400"} mb-1`,children:_?"Processing...":"Drag & drop, paste, or"}),!_&&x.jsx("button",{type:"button",onClick:z,className:"text-sm text-primary-light hover:underline focus:outline-none focus:ring-1 focus:ring-primary-light rounded px-1",children:"select a file"})]})}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-3",children:[x.jsx(Kr,{type:"button",onClick:S,variant:"secondary",size:"sm",className:"w-full sm:w-auto",disabled:_,isLoading:_&&I.current===null,loadingText:"Pasting...",children:x.jsxs("span",{className:"flex items-center justify-center gap-1.5",children:[x.jsx("div",{className:"i-mdi:content-paste h-4 w-4"}),"Paste Image"]})}),x.jsx(Kr,{type:"button",onClick:z,variant:"secondary",size:"sm",className:"w-full sm:w-auto",disabled:_,isLoading:_&&I.current===null,loadingText:"Selecting...",children:x.jsxs("span",{className:"flex items-center justify-center gap-1.5",children:[x.jsx("div",{className:"i-mdi:file-image-plus-outline h-4 w-4"}),"Select File"]})})]}),x.jsx("input",{type:"file",ref:P,onChange:B,accept:"image/*,image/webp,image/jpeg,image/png,image/gif",style:{display:"none"},disabled:_}),T&&x.jsx("p",{className:"mt-2 text-xs text-gray-500",children:T}),x.jsxs(bn,{variant:"default",className:"p-3 text-xs text-gray-400 mt-3",children:[x.jsxs("p",{children:[x.jsx("span",{className:"font-medium text-primary-light",children:"Recommended size:"})," ",G.width,"x",G.height,"px"]}),x.jsx("p",{className:"mt-1",children:"Images will be converted to WebP format. The final size will be your crop area size."})]})]})}export{oa as F,ga as I};
